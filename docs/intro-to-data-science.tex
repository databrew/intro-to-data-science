% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{book}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={DataBOOM: the canon for data science},
  pdfauthor={Databrew},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage{booktabs}
\usepackage{amsthm}
\makeatletter
\def\thm@space@setup{%
  \thm@preskip=8pt plus 2pt minus 4pt
  \thm@postskip=\thm@preskip
}
\makeatother
\ifluatex
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage[]{natbib}
\bibliographystyle{apalike}

\title{\texttt{DataBOOM}: the canon for data science}
\author{Databrew}
\date{2021-05-13}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{1}
\tableofcontents
}
\hypertarget{welcome}{%
\chapter{Welcome!}\label{welcome}}

Welcome to \texttt{DataBOOM}, a curriculum designed to guide you from your very first line of code towards becoming a professional data scientist.

\hypertarget{what-this-is-and-what-it-isnt}{%
\section*{What this is, and what it isn't}\label{what-this-is-and-what-it-isnt}}
\addcontentsline{toc}{section}{What this is, and what it isn't}

This is not a textbook or a reference manual. It is not exhaustive or comprehensive. It is a \emph{training manual} designed to \emph{empower researchers to do impactful data science.} As such, its tutorials and exercises aim to get you, the researcher, to start writing your own code as quickly as possible and -- equally of importance -- to \emph{start thinking like a data scientist}, by which we mean tackling ambiguous problems with persistence, independence, and creative problem solving.

Furthermore, this is not a fancy interactive tutorial with bells or whistles. It was purposefully designed to be simple and ``analog''. You will not be typing your code into this website and getting feedback from a robot, or setting up an account to track your progress, or getting pretty merit badges or points when you complete each module.

Instead, you will be doing your work on your own machine, working with real folders and files, downloading data and moving it around, etc. -- all the things you will be doing as a data scientist in the real world.

\hypertarget{who-this-is-for}{%
\section*{Who this is for}\label{who-this-is-for}}
\addcontentsline{toc}{section}{Who this is for}

This curriculum covers everything from the absolute basics of writing code in \texttt{R} to machine learning with \texttt{tensorflow}. As such, it is designed to be useful to everyone in some way. But the target audience for these tutorials is the student who \emph{wants} to work with data but has \emph{zero} formal training in programming, computer science, or statistics.

This curriculum was originally developed for the \textbf{Sewanee Data Institute for Social Good} at Sewanee: The University of the South, TN.

\hypertarget{what-you-will-learn}{%
\section*{What you will learn}\label{what-you-will-learn}}
\addcontentsline{toc}{section}{What you will learn}

\begin{itemize}
\tightlist
\item
  The \textbf{Core theory} unit establishes the conceptual foundations and motivations for this work: what data science is, why it matters, and ethical issues surrounding it: the good, the bad, and the ugly.
\end{itemize}

The next several units comprise a \emph{core} curriculum for tackling data science problems:

\begin{itemize}
\item
  The \textbf{Getting started} unit teaches you how to use \texttt{R} (in \texttt{RStudio}) to explore and plot data. Here you will add the first and most important tools to your toolbox: working with variables, vectors, dataframes, scripts, and file directories.
\item
  The \textbf{Working with data} unit teaches you how to bring in your own data and work with it in \texttt{R}. You will learn how to format data to simplify analysis and add tools for \emph{data wrangling} (i.e., transforming and re-formatting data to prepare it for plotting and analysis).
\item
  The \textbf{Exploring \& analyzing data} unit teaches you how to conduct basic statistics, from exploratory data analyses (e.g., producing and comparing distributions) to significance testing.
\item
  The \textbf{Accessing \& managing data} unit teaches you how to organize data for large projects, how to manage atypical data formats (e.g., Excel files), and how to access data from online data files.
\item
  The \textbf{\texttt{R} toolbag} unit equips you with the tools, tricks, and mindset for tackling the most common tasks in data science. This is where you really begin to cut your teeth on real-world data puzzles: figuring out how to use the \texttt{R} tools in your toolbag to tackle an ambiguous problem and deliver an excellent data product.
\end{itemize}

The next several units provide a suite of skills essential to any data science professional:

\begin{itemize}
\item
  The \textbf{Interactive dashboards} unit teaches you how to make dashboards and websites for projects using \texttt{shiny} in \texttt{RStudio}.
\item
  The \textbf{Databases} unit teaches you how to access, create, and work with relational databases online using \texttt{SQL} and its alternatives.
\item
  The \textbf{Documenting your work} unit teaches you to use \texttt{R\ Markdown} to produce beautiful, reproducible data reports.
\item
  The \textbf{Version control \& teamwork} unit teaches you how to use \texttt{Git} and \texttt{GitHub} to collaborate on shared projects and work on data science teams.
\item
  The \textbf{Writing about data} unit teaches you to write successful grant applications and publishable research articles.
\end{itemize}

The final unit, \textbf{Advanced skills}, introduces you to a variety of advanced data science techniques, from interactive maps to iterative simulations to machine learning, that can help you begin to specialize your skillset.

\hypertarget{making-the-most-of-this-course}{%
\section*{Making the most of this course}\label{making-the-most-of-this-course}}
\addcontentsline{toc}{section}{Making the most of this course}

(Make sure you involve pizza.)

\hypertarget{who-we-are}{%
\section*{Who we are}\label{who-we-are}}
\addcontentsline{toc}{section}{Who we are}

Joe Brew

Ben Brew

Eric Keen

Isabelle Puckette

Instructor tip!Here is some teacher content.

\hypertarget{part-core-theory}{%
\part{Core theory}\label{part-core-theory}}

\hypertarget{principles-of-data-science}{%
\chapter{Principles of data science}\label{principles-of-data-science}}

\hypertarget{what-is-data-science}{%
\section{What is data science?}\label{what-is-data-science}}

\hypertarget{what-is-the-data-life-cycle}{%
\section{What is the data life cycle?}\label{what-is-the-data-life-cycle}}

\hypertarget{what-is-a-pipeline}{%
\section{What is a pipeline?}\label{what-is-a-pipeline}}

\hypertarget{data-science-in-the-wild}{%
\section{Data science `in the wild'}\label{data-science-in-the-wild}}

\hypertarget{the-reproducibility-crisis}{%
\section{The reproducibility crisis}\label{the-reproducibility-crisis}}

\hypertarget{visualizing-data}{%
\chapter{Visualizing data}\label{visualizing-data}}

\hypertarget{bad-examples}{%
\section{Bad examples}\label{bad-examples}}

\hypertarget{good-exaples}{%
\section{Good exaples}\label{good-exaples}}

\hypertarget{edward-tufte}{%
\section{Edward Tufte}\label{edward-tufte}}

\hypertarget{grammar-of-graphics}{%
\section{Grammar of graphics}\label{grammar-of-graphics}}

\hypertarget{design-principles}{%
\section{Design principles}\label{design-principles}}

\hypertarget{plots-power}{%
\section{Plots \& power}\label{plots-power}}

The politics of graphics

(Test text)

\hypertarget{writing-about-data}{%
\chapter{Writing about data}\label{writing-about-data}}

\hypertarget{data-ethics}{%
\chapter{Data ethics}\label{data-ethics}}

\hypertarget{part-getting-started}{%
\part{Getting started}\label{part-getting-started}}

\hypertarget{setting-up-rstudio}{%
\chapter{\texorpdfstring{Setting up \texttt{RStudio}}{Setting up RStudio}}\label{setting-up-rstudio}}

\textbf{First, download and install \texttt{R}: }

Go to the following website, click the \emph{Download} button, and follow the website's instructions from there.
\url{https://mirrors.nics.utk.edu/cran/}

\textbf{Second, download and install \texttt{RStudio}:}

Go to the following website and choose the free Desktop version:
\url{https://rstudio.com/products/rstudio/download/}

\textbf{Third, make sure \texttt{RStudio} opens successfully:}

Open the \texttt{RStudio} app. A window should appear that looks like this:

\includegraphics{img/rstudio_firstopen.png}

\textbf{Fourth, make sure \texttt{R} is running correctly in the background:}

In \texttt{RStudio}, in the pane on the left (the ``Console''), type 2+2 and hit Enter.\\
If \texttt{R} is working properly, the number ``4'' will be printed in the next line down.

\textbf{Boom!}

\hypertarget{running-r-code}{%
\chapter{Running R code}\label{running-r-code}}

\hypertarget{learning-goals}{%
\section*{Learning goals}\label{learning-goals}}
\addcontentsline{toc}{section}{Learning goals}

\begin{itemize}
\tightlist
\item
  Learn how to run code in R
\item
  Learn how to use R as a calculator
\item
  Learn how to use mathematical and logical operators in R
\end{itemize}

\hypertarget{tutorial-video}{%
\section*{Tutorial video}\label{tutorial-video}}
\addcontentsline{toc}{section}{Tutorial video}

\hypertarget{rstudios-console}{%
\section*{\texorpdfstring{RStudio's \emph{Console}}{RStudio's Console}}\label{rstudios-console}}
\addcontentsline{toc}{section}{RStudio's \emph{Console}}

When you open \texttt{RStudio}, you see several different panes within the program's window. You will get a tour of \texttt{RStudio} in the next module. For now, look at the left half of the screen. You should see a large pane entitled the \emph{Console}.

\includegraphics{img/rstudio_firstopen.png}

\texttt{RStudio}'s \emph{Console} is your window into \texttt{R}, the engine under the hood. The \emph{Console} is where you type commands for \texttt{R} to run, and where \texttt{R} prints back the results of what you have told it to do.

\hypertarget{running-code-in-the-console}{%
\section*{\texorpdfstring{Running code in the \emph{Console}}{Running code in the Console}}\label{running-code-in-the-console}}
\addcontentsline{toc}{section}{Running code in the \emph{Console}}

Type your first command into the \emph{Console}, then press \texttt{Enter}:

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{1} \SpecialCharTok{+} \DecValTok{1}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 2
\end{verbatim}

When you press \texttt{Enter}, R processes the command you fed it, then returns its result (\texttt{2}) just below your command.

Note that spaces don't matter. Both of the following two commands are legible to \texttt{R} and return the same thing:

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{4} \SpecialCharTok{+} \DecValTok{4}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 8
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{4}\SpecialCharTok{+}\DecValTok{4}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 8
\end{verbatim}

However, it is better to make your code as easy to read as possible, which usually means using spaces.

\hypertarget{exercise-1}{%
\subsubsection*{Exercise 1}\label{exercise-1}}
\addcontentsline{toc}{subsubsection}{Exercise 1}

Type a command in the \emph{Console} to determine the sum of 596 and 198.

\hypertarget{re-running-code-in-the-console}{%
\subsection*{\texorpdfstring{Re-running code in the \emph{Console}}{Re-running code in the Console}}\label{re-running-code-in-the-console}}
\addcontentsline{toc}{subsection}{Re-running code in the \emph{Console}}

If you want to re-run the code you just ran, or if you want to recall the code so that you can adjust it slightly, click anywhere in the \emph{Console} then press your keyboard's \texttt{Up} arrow.

If you keep pressing your \texttt{Up} arrow, \texttt{R} will present you with sequentially older commands.

If you accidentally recalled an old command without meaning to, you can reset the \emph{Console}'s command line by pressing \texttt{Escape}.

\hypertarget{exercise-2}{%
\subsubsection*{Exercise 2}\label{exercise-2}}
\addcontentsline{toc}{subsubsection}{Exercise 2}

A. Re-run the sum of 596 and 198 without re-typing it.

B. Recall the command again, but this time adjust the code to find the sum of 596 and 298.

C. Practice escaping an accidentally called command: recall your most recent command, then clear the \emph{Console}'s command line.

\hypertarget{incomplete-commands-in-r}{%
\subsection*{\texorpdfstring{Incomplete commands in \texttt{R}}{Incomplete commands in R}}\label{incomplete-commands-in-r}}
\addcontentsline{toc}{subsection}{Incomplete commands in \texttt{R}}

\texttt{R} gets confused when you enter an incomplete command, and will wait for you to write the remainder of your command on the next line in the \emph{Console} before doing anything.

For example, try running this code in your \emph{Console}:

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{45} \SpecialCharTok{+}
\end{Highlighting}
\end{Shaded}

You will find that \texttt{R} gives you a little \texttt{+} sign on the line under your command, which means it is waiting for you to complete your command.

If you want to complete your command, add a number (e.g., \texttt{3)} and hit \texttt{Enter}. You should now be given an answer (e.g., \texttt{48}).

If instead you want \texttt{R} to stop waiting and stop running, hit the \texttt{Escape} key.

\hypertarget{getting-errors-in-r}{%
\subsection*{\texorpdfstring{Getting errors in \texttt{R}}{Getting errors in R}}\label{getting-errors-in-r}}
\addcontentsline{toc}{subsection}{Getting errors in \texttt{R}}

\texttt{R} only understands your commands if they follow the rules of the \texttt{R} language (often referred to as its \emph{syntax}). If \texttt{R} does not understand your code, it will throw an error and give up on trying to execute that line of code.

For example, try running this code in your \emph{Console}:

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{4} \SpecialCharTok{+}\NormalTok{ 6p}
\end{Highlighting}
\end{Shaded}

You probably received a message in red font stating \texttt{Error:\ unexpected\ symbol\ in\ "4\ +\ 6p"}. That is because R did know how to interpret the symbol \texttt{p} in this case.

Get used to errors! They happen all the time, even (especially?) to professionals, and it is essential that you get used to reading your own code to find and fix its errors.

\hypertarget{exercise-3}{%
\subsubsection*{Exercise 3}\label{exercise-3}}
\addcontentsline{toc}{subsubsection}{Exercise 3}

Type a command in R that throws an error, then recall the command and revise so that \texttt{R} can understand it.

\hypertarget{use-r-like-a-calculator}{%
\section*{Use R like a calculator}\label{use-r-like-a-calculator}}
\addcontentsline{toc}{section}{Use R like a calculator}

As you can tell from those commands you just ran, \texttt{R} is, at heart, a fancy calculator.

Some calculations are straightforward, like addition and subtraction:

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{490} \SpecialCharTok{+} \DecValTok{1000}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1490
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{490} \SpecialCharTok{{-}} \DecValTok{1000}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] -510
\end{verbatim}

Division is pretty straightfoward too:

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{24} \SpecialCharTok{/} \DecValTok{2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 12
\end{verbatim}

For multiplication, use an asterisk (\texttt{*}):

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{24} \SpecialCharTok{*} \DecValTok{2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 48
\end{verbatim}

\texttt{R} is usually great about following classic rules for Order of Operations, and you can use parentheses to exert control over that order. For example, these two commands produce different results:

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{2}\SpecialCharTok{*}\DecValTok{7} \SpecialCharTok{{-}} \DecValTok{2}\SpecialCharTok{*}\DecValTok{5} \SpecialCharTok{/} \DecValTok{2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 9
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(}\DecValTok{2}\SpecialCharTok{*}\DecValTok{7} \SpecialCharTok{{-}} \DecValTok{2}\SpecialCharTok{*}\DecValTok{5}\NormalTok{) }\SpecialCharTok{/} \DecValTok{2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 2
\end{verbatim}

You denote exponents like this:

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{2} \SpecialCharTok{\^{}}\DecValTok{2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{2} \SpecialCharTok{\^{}}\DecValTok{3}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 8
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{2} \SpecialCharTok{\^{}}\DecValTok{4}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 16
\end{verbatim}

Finally, note that \texttt{R} is fine with negative numbers:

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{9} \SpecialCharTok{+} \SpecialCharTok{{-}}\DecValTok{100}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] -91
\end{verbatim}

\hypertarget{exercise-4}{%
\subsubsection*{Exercise 4}\label{exercise-4}}
\addcontentsline{toc}{subsubsection}{Exercise 4}

A. Find the sum of the ages of everyone in your immediate family.

B. Now recall that command and adjust it to determine the \emph{average} age of the members of your family.

\hypertarget{using-operators-in-r}{%
\section{Using operators in R}\label{using-operators-in-r}}

You can get \texttt{R} to evaluate logical tests using \emph{operators}.

For example, you can ask whether two values are equal to each other.

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{96} \SpecialCharTok{==} \DecValTok{95}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] FALSE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{95} \SpecialCharTok{+} \DecValTok{2} \SpecialCharTok{==} \DecValTok{95} \SpecialCharTok{+} \DecValTok{2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\texttt{R} is telling you that the first statement is \texttt{FALSE} (\texttt{96} is not, in fact, equal to \texttt{95}) and that the second statement is \texttt{TRUE} (\texttt{95\ +\ 2} is, in fact, equal to itself).

Note the use of \emph{double} equal signs here. You must use two of them in order for \texttt{R} to understand that you are asking for this logical test.

You can also ask if two values are \emph{NOT} equal to each other:

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{96} \SpecialCharTok{!=} \DecValTok{95}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{95} \SpecialCharTok{+} \DecValTok{2} \SpecialCharTok{!=} \DecValTok{95} \SpecialCharTok{+} \DecValTok{2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] FALSE
\end{verbatim}

This test is a bit more difficult to understand: In the first statement, \texttt{R} is telling you that it is \texttt{TRUE} that \texttt{96} is different from \texttt{95}. In the second statement, \texttt{R} is saying that it is \texttt{FALSE} that \texttt{95\ +\ 2} is not the same as itself.

Note that \texttt{R} lets you write these tests another, even more confusing way:

\begin{Shaded}
\begin{Highlighting}[]
\SpecialCharTok{!} \DecValTok{96} \SpecialCharTok{==} \DecValTok{95}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\SpecialCharTok{!} \DecValTok{95} \SpecialCharTok{+} \DecValTok{2} \SpecialCharTok{==} \DecValTok{95} \SpecialCharTok{+} \DecValTok{2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] FALSE
\end{verbatim}

The first line of code is asking \texttt{R} whether it is not true that \texttt{96} and \texttt{95} are equal to each other, which is \texttt{TRUE}. The second line of code is asking \texttt{R} whether it is not true that \texttt{95\ +\ 2} is the same as itself, which is of course \texttt{FALSE}.

Other commonly used operators in \texttt{R} include greater than / less than (\texttt{\textgreater{}} and \texttt{\textless{}}), and greater/less than or equal to (\texttt{\textgreater{}=} and \texttt{\textless{}=}).

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{100} \SpecialCharTok{\textgreater{}} \DecValTok{100}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] FALSE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{100} \SpecialCharTok{\textgreater{}=} \DecValTok{100}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\hypertarget{exercise-5}{%
\subsubsection*{Exercise 5}\label{exercise-5}}
\addcontentsline{toc}{subsubsection}{Exercise 5}

A. Write and run a line of code that asks whether these two calculations return the same result:

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{2}\SpecialCharTok{*}\DecValTok{7} \SpecialCharTok{{-}} \DecValTok{2}\SpecialCharTok{*}\DecValTok{5} \SpecialCharTok{/} \DecValTok{2}
\NormalTok{(}\DecValTok{2}\SpecialCharTok{*}\DecValTok{7} \SpecialCharTok{{-}} \DecValTok{2}\SpecialCharTok{*}\DecValTok{5}\NormalTok{) }\SpecialCharTok{/} \DecValTok{2}
\end{Highlighting}
\end{Shaded}

B. Now write and run a line of code that asks whether the first calculation is larger than the second:

\hypertarget{use-built-in-functions-within-r}{%
\section{Use built-in functions within R}\label{use-built-in-functions-within-r}}

\texttt{R} has some built-in functions for common calculations, such as finding square roots and logarithms.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sqrt}\NormalTok{(}\DecValTok{16}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{log}\NormalTok{(}\DecValTok{4}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1.386294
\end{verbatim}

Note that the function \texttt{log()} is the \emph{natural log} function (i.e., the value that \emph{e} must be raised to in order to equal 4). To calculate a base-10 logarithm, use \texttt{log10(\ )}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{log}\NormalTok{(}\DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 2.302585
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{log10}\NormalTok{(}\DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1
\end{verbatim}

Another handy function is \texttt{round()}, for rounding numbers to a specific number of decimal places.

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{100}\SpecialCharTok{/}\DecValTok{3}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 33.33333
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{round}\NormalTok{(}\DecValTok{100}\SpecialCharTok{/}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 33
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{round}\NormalTok{(}\DecValTok{100}\SpecialCharTok{/}\DecValTok{3}\NormalTok{,}\AttributeTok{digits=}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 33.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{round}\NormalTok{(}\DecValTok{100}\SpecialCharTok{/}\DecValTok{3}\NormalTok{,}\AttributeTok{digits=}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 33.33
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{round}\NormalTok{(}\DecValTok{100}\SpecialCharTok{/}\DecValTok{3}\NormalTok{,}\AttributeTok{digits=}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 33.333
\end{verbatim}

Finally, \texttt{R} also comes with some built-in values, such as \emph{pi}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pi}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 3.141593
\end{verbatim}

\hypertarget{exercise-6}{%
\subsubsection*{Exercise 6}\label{exercise-6}}
\addcontentsline{toc}{subsubsection}{Exercise 6}

Find the square root of \emph{pi} and round the answer to the 2 decimal places.

\hypertarget{review-assignment}{%
\section*{Review assignment:}\label{review-assignment}}
\addcontentsline{toc}{section}{Review assignment:}

\emph{NOTE: Under construction!}

\hypertarget{other-resources}{%
\section{Other Resources}\label{other-resources}}

Hobbes Primer, Table 1 (Math Operators, pg. 18) and Table 2 (Logical operators, pg. 22)

\hypertarget{using-rstudio-and-r-scripts}{%
\chapter{\texorpdfstring{Using \texttt{RStudio} and \texttt{R} scripts}{Using RStudio and R scripts}}\label{using-rstudio-and-r-scripts}}

\hypertarget{learning-goals-1}{%
\section*{Learning goals}\label{learning-goals-1}}
\addcontentsline{toc}{section}{Learning goals}

\begin{itemize}
\tightlist
\item
  Understand the difference between \texttt{R} and \texttt{RStudio}.
\item
  Understand the \texttt{RStudio} working environment and window panes\\
\item
  Understand what \texttt{R} scripts are, and how to create and save them.
\item
  Understand how to add comments to your code, and why doing so is important.
\item
  Understand what a \emph{working directory} is, and how to use it.
\item
  Learn basic project work flow
\end{itemize}

\hypertarget{watch-this-tutorial}{%
\section*{Watch this tutorial}\label{watch-this-tutorial}}
\addcontentsline{toc}{section}{Watch this tutorial}

\hypertarget{r-and-rstudio-whats-the-difference}{%
\section*{\texorpdfstring{\texttt{R} and \texttt{RStudio}: what's the difference?}{R and RStudio: what's the difference?}}\label{r-and-rstudio-whats-the-difference}}
\addcontentsline{toc}{section}{\texttt{R} and \texttt{RStudio}: what's the difference?}

These two entities are similar, but it is important to understand how they are different.

In short, \texttt{R} is a open-source (i.e., free) coding language: a powerful programming engine that can be used to do really cool things with data.

\texttt{R\ Studio}, in contrast, is a free \emph{user interface} that helps you interact with \texttt{R}. If you think of \texttt{R} as an engine, then it helps to think of \texttt{RStudio} as the car that contains it. Like a car,\texttt{RStudio} makes it easier and more comfortable to use the engine to get where you want to go.

\texttt{R\ Studio} needs \texttt{R} in order to function, but \texttt{R} can technically be used on its own outside of \texttt{RStudio} if you want. However, just as a good car mechanic can get an engine to run without being installed within a car, using \texttt{R} on its own is a bit clunky and requires some expertise. For beginners (and everyone else, really), \texttt{R} is just so much more pleasant to use when you are operating it from within \texttt{RStudio}.

Instructor tip!At this point it may be useful to show the students what opening R looks like on its own (not through R Studio). This helps them see why RStudio is valuable, and it will also help them understand what they did wrong when they accidentally open an .R file in R instead of RStudio -- which will happen a lot at first.

\texttt{RStudio} also has increasingly powerful \emph{extensions} that make \texttt{R} even more useful and versatile in data science. These extensions allow you to use \texttt{R} to make interactive data dashboards, beautiful and reproducible data reports, presentations, websites, and even books. And new features like these are regularly being added to \texttt{RStudio} by its all-star team of data scientists.

That is why this book \emph{always} uses \texttt{RStudio} when working with \texttt{R}.

\hypertarget{two-minute-tour-of-rstudio}{%
\section*{\texorpdfstring{Two-minute tour of \texttt{RStudio}}{Two-minute tour of RStudio}}\label{two-minute-tour-of-rstudio}}
\addcontentsline{toc}{section}{Two-minute tour of \texttt{RStudio}}

When you open \texttt{RStudio} for the first time, you will see a window that looks like the screenshot below.

\includegraphics{img/rstudio_windows.png}

\hypertarget{console}{%
\subsection*{Console}\label{console}}
\addcontentsline{toc}{subsection}{Console}

You are already acquainted with \texttt{RStudio}'s \emph{Console}, the window pane on the left that you use to ``talk'' to \texttt{R}. (See the previous module.)

\hypertarget{environment}{%
\subsection*{Environment}\label{environment}}
\addcontentsline{toc}{subsection}{Environment}

In the top right pane, the \emph{Environment}, \texttt{RStudio} will maintain a list of all the datasets, variables, and functions that you are using as you work. The next modules will explain what variables and functions are.

This is the pane that is used the least often, and if you wish it can simplify your workspace to minimize it.

\hypertarget{files-plots-packages-help}{%
\subsection*{Files, Plots, Packages, \& Help}\label{files-plots-packages-help}}
\addcontentsline{toc}{subsection}{Files, Plots, Packages, \& Help}

You will use the bottom right pane very often.

\begin{itemize}
\tightlist
\item
  The \textbf{Files} tab lets you see all the files within your \textbf{working directory}, which will be explained in the section below.\\
\item
  The \textbf{Plots} tab lets you see the plots you are producing with your code.\\
\item
  The \textbf{Packages} tab lets you see the \emph{packages} you currently have installed on your computer. Packages are bundles of \texttt{R} functions downloaded from the internet; they will be explained in detail a few modules down the road.\\
\item
  The \textbf{Help} tab is very important! It lets you see \emph{documentation} (i.e., user's guides) for the functions you use in your code. Functions will also be explained in detail a few modules down the road.
\end{itemize}

These three panes are useful, but the most useful window pane of all is actually \emph{missing} when you first open \texttt{RStudio}. This important pane is where you work with \textbf{scripts}.

\hypertarget{scripts}{%
\section*{Scripts}\label{scripts}}
\addcontentsline{toc}{section}{Scripts}

Before explaining what scripts are and why they are awesome, let's start a new script.

\textbf{To start a new script,} go to the top left icon in the \texttt{RStudio} window, and click on the green plus sign with a blank page behind it:

\includegraphics{img/rstudio_newscript.png}

A dropdown window will appear. Select ``R Script''.

A new window pane will then appear in the top left quadrant of your \texttt{RStudio} window:

\includegraphics{img/rstudio_scripts.png}
You now have a blank script to work in!

Now type some simple commands into your script:

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{2}  \SpecialCharTok{+} \DecValTok{10}
\DecValTok{16} \SpecialCharTok{*} \DecValTok{32}
\end{Highlighting}
\end{Shaded}

Notice that when you press \texttt{Enter} after each line of code, nothing happens in the \emph{Console}. In order to send this code to the Console, press \texttt{Enter\ +\ Command} at the same time (or \texttt{Enter\ +\ Control}, if you are on Windows) for each line of code.

To send both lines of code to the \emph{Console} at once, select both lines of code and hit \texttt{Enter\ +\ Command}.

(To select multiple lines of code, you can (1) click and drag with your mouse or (2) hold down your \texttt{Shift} key while clicking your down arrow key. To select \emph{all} lines of code, press \texttt{Command\ +\ A}.)

Instructor tip!Get all students to practice running code at this point. The act of typing the commands themselves helps them learn and overcome their hesitation about messing up.

\hypertarget{exercise-1-1}{%
\subsection*{Exercise 1}\label{exercise-1-1}}
\addcontentsline{toc}{subsection}{Exercise 1}

Add a few more lines to your script, such that your script now looks like this.

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{2}  \SpecialCharTok{+} \DecValTok{10}
\DecValTok{16} \SpecialCharTok{*} \DecValTok{32}
\DecValTok{1080} \SpecialCharTok{/} \DecValTok{360}
\DecValTok{500} \SpecialCharTok{{-}} \DecValTok{600}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{(\Alph{enumi})}
\tightlist
\item
  Run all of these lines of code at once.\\
\item
  Now add \texttt{10} to the first number in each row, and re-run all of the code.
\end{enumerate}

Think about how much more efficient part (B) was thanks to your script! If you had typed all of that directly into your \emph{Console}, you would have to recall or retype each line individually. That difference builds up when your number of commands grows into the hundreds.

\hypertarget{what-is-an-r-script-and-why-are-scripts-so-awesome}{%
\subsection*{\texorpdfstring{What is an \texttt{R} script, and why are scripts so awesome?}{What is an R script, and why are scripts so awesome?}}\label{what-is-an-r-script-and-why-are-scripts-so-awesome}}
\addcontentsline{toc}{subsection}{What is an \texttt{R} script, and why are scripts so awesome?}

An \texttt{R} script is a file where you can keep a record of your code. Just as a script tells actors exactly what to say and when to say it, an \texttt{R} script tells \texttt{R} exactly what code to run, and in what order to run it.

When working with R, you will almost always type your code into a script first, \emph{then} send it to the \emph{Console}. You can run your code immediately using \texttt{Enter\ +\ Command}, but you also have a script of what you have done so that you can run the exact same code at a later time

To understand why \texttt{R} scripts are so awesome, consider a typical workflow in \emph{Excel} of \emph{GoogleSheets}. You open a big complicated spreadsheet, spend hours making changes, and save your changes frequently throughout your work session.

The main disadvantages of this workflow are that:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  There is no detailed record of the changes you have made. You cannot prove that you have made changes correctly. You cannot pass the original dataset to someone else and ask them to revise it in the same way you have. (Nor would you want to, since making all those changes was so time-consuming!) Nor could you take a different dataset and guarantee that you are able to apply the exact same changes that you applied to the first. In other words, your work is not reproducible.
\item
  Making those changes is labor-intensive! Rather than spend time manually making changes to a single spreadsheet, it would be better to devote that energy to writing \texttt{R} code that makes those changes for you. That code could be run in this one case, but it could also be run at any later time, or easily modified to make similar changes to other spreadsheets.
\item
  You are modifying your original dataset, which is always dangerous and a big No-No in data science. Each time you save your work in \emph{Excel} or \emph{GoogleSheets} (which automatically saves each change you make), the original spreadsheet file gets replaced by the updated version. But if you brought your dataset into \texttt{R} instead, and modified it using an \texttt{R} script, then you leave the raw data alone and keep it safe. (Sure, you can always save different versions of your Excel file, but then you run the risk of mixing up versions and getting confused.)
\end{enumerate}

Instructor tip!Consider telling a story from your own work life before you discovered R scripts. For example: receiving versions of Excel files named DATA-final-final-final.xlsx, because tiny changes are inevitably discovered after you try to finalize a data file. Then you work all weekend on an analysis using that data, only to discover you were using the WRONG version of the data!

Working with \texttt{R} scripts allows you to avoid all of these pitfalls. When you write an \texttt{R} script, you are making your work \ldots.

\begin{itemize}
\item
  \textbf{Efficient.} Once you get comfortable writing \texttt{R} code, you will be able to write scripts in a few minutes. Those scripts can modify datasets within seconds (or less) in ways that would take hours (or years) to carry out manually in \emph{Excel} or \emph{GoogleSheets}.
\item
  \textbf{Reproducible.} Once you have written an\texttt{R} script, you can reproduce your own work whenever you want to. You can send your script to a colleague so that they can reproduct your work as well. Reproducible work is defensible work.
\item
  \textbf{Low-risk.} Since your R script does not make any changes to the original data, you are keeping your data safe. It is \emph{essential} tp preserve the sanctity of raw data!
\end{itemize}

Note that there is nothing fancy or special about an \texttt{R} script. An \texttt{R} script is a simple text file; that is, it only accepts basic text; you can't add images or change font style or font size in an \texttt{R} script; just letters, numbers, and your other keyboard keys. The file's extension, \texttt{.R} tells your computer to interpret that text as \texttt{R} code.

\hypertarget{commenting-your-code}{%
\subsection*{Commenting your code}\label{commenting-your-code}}
\addcontentsline{toc}{subsection}{Commenting your code}

Another advantage of scripts is that you can include \emph{comments} throughout your code to explain what you are doing and why. A \emph{comment} is just a part of your script that is useful to you but that is ignored by \texttt{R}.

To add comments to your code, use the hashtag symbol (\texttt{\#}). Any text following a \texttt{\#} will be ignored by \texttt{R}.

Here is the script above, now with comments added:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Define variable x}
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{2} 
\NormalTok{x}

\CommentTok{\# Make a new variable, y, based on x}
\NormalTok{y }\OtherTok{\textless{}{-}}\NormalTok{ x}\SpecialCharTok{*}\DecValTok{56}

\NormalTok{z }\OtherTok{\textless{}{-}}\NormalTok{ y }\SpecialCharTok{/} \DecValTok{23} \CommentTok{\# Make a third variable, z, based on y}
 
\NormalTok{x }\SpecialCharTok{+}\NormalTok{ y }\SpecialCharTok{+}\NormalTok{ z }\CommentTok{\# Now get the sum of all three variables}
\end{Highlighting}
\end{Shaded}

Adding comments can be more work, but in the end it saves you time and makes your code more effective. Comments might not seem necessary in the moment, but it is amazing how helpful they are when you come back to your code the next day. Frequent and helpful comments make the difference between good and great code. Comment early, comment often!

You can also use lines of hashtags to visually organize your code. For example:

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\CommentTok{\# Setup}
\DocumentationTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}

\CommentTok{\# Define variable x}
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{2} 
\NormalTok{x}

\CommentTok{\# Make a new variable, y, based on x}
\NormalTok{y }\OtherTok{\textless{}{-}}\NormalTok{ x}\SpecialCharTok{*}\DecValTok{56}

\NormalTok{z }\OtherTok{\textless{}{-}}\NormalTok{ y }\SpecialCharTok{/} \DecValTok{23} \CommentTok{\# Make a third variable, z, based on y}
 

\DocumentationTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\CommentTok{\# Get result}
\DocumentationTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}

\NormalTok{x }\SpecialCharTok{+}\NormalTok{ y }\SpecialCharTok{+}\NormalTok{ z }\CommentTok{\# Now get the sum of all three variables}
\end{Highlighting}
\end{Shaded}

This might not seem necessary with a 5-line script, but adding visual breaks to your code becomes immensely helpful when your code grows to be hundreds of lines long.

\hypertarget{saving-your-work}{%
\subsection*{Saving your work}\label{saving-your-work}}
\addcontentsline{toc}{subsection}{Saving your work}

\texttt{R} scripts are only useful if you save them! Unlike working with \emph{GoogleDocs} or \emph{GoogleSheets}, \texttt{R} will not automatically save your changes; you have to do that yourself. (This is inconvenient, but it is also safer; most of coding is trial and error, and sometimes you want to be careful about what is saved.)

Instructor tip!Having grown up in the age of GoogleDocs, many students may not be familiar with what computer files are, and may not even know that their computer operates using directories of folders. It would be useful to open up File Explorer on your demo screen and show them how these directories work.

\textbf{Where to save your work?} The folder in which you save your \texttt{R} script will be referred to as your \emph{working directory} (see the next section). For the sake of these tutorials, it will be most convenient to save all of your scripts in a single folder that is in an easily accessed location. We suggest making a new folder on your Desktop and naming it \texttt{databoom}, but you can name it whatever you want and place it wherever you want.

\textbf{How to save your script?} To save the script you have opened and typed a few lines of code into, press \texttt{Command\ +\ S} (or \texttt{Control\ +\ S}). Alternatively, go to File \textgreater{} Save. Navigate to the folder you just created and type in a file name that is simple but descriptive. We suggest making a new \texttt{R} script for each module, and naming those scripts according to each module's name. In this case, we recommend naming your script \texttt{09\_intro\_to\_rstudio}.

(It is good practice to avoid spaces in your file names; it will be essential later on, so good to begin the correct habit now. Start using an underscore, \texttt{\_}, instead of a space.)

\hypertarget{your-working-directory}{%
\section*{Your working directory}\label{your-working-directory}}
\addcontentsline{toc}{section}{Your working directory}

When you work with data in \texttt{R}, \texttt{R} will need to know where in your computer to look for that data. The folder it looks in is known as your \textbf{working directory}.

To find out which folder \texttt{R} is currently using as your working directory, use the function \texttt{getwd()}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{getwd}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "/home/joebrew/Documents/intro-to-data-science"
\end{verbatim}

Almost always, you want to set your working directory to the folder your \texttt{R} script is in.

\hypertarget{how-to-set-your-working-directory}{%
\subsection*{How to set your working directory}\label{how-to-set-your-working-directory}}
\addcontentsline{toc}{subsection}{How to set your working directory}

Whenever you begin a new \texttt{R} script, setting your working directory will be one of the first things you do.

There are three ways to set your working directory:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \textbf{Manually without code.} On the top banner in \texttt{RStudio}, go to \emph{Session \textgreater{} Set Working Directory \textgreater{} To Source File Location}:
\end{enumerate}

\includegraphics{img/rstudio_setwd.png}
This action sets your working directory to the same folder that your \texttt{R} script is in. When you do this, you will see that a command has been entered into your \emph{Console}:

(Note that the filepath may be different on your machine.) This code is using the function \texttt{setwd()}, which is also used in the next option.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\item
  \textbf{Manually with code, using \texttt{setwd()}}: You can manually provide the filepath you want to set as your working directory. This option allows you to set your \texttt{wd} to whatever folder you want. The character string within the \texttt{setwd()} command is the path to a folder. The formatting of this string must be exact, otherwise \texttt{R} will throw an error. Use option 1 at first to get a sense of how your computer formats its folder paths. Copy, paste, and modify the output from option 1 in order to type your path correctly.
\item
  \textbf{Automatically with code}: There is a command you can run that automatically sets your working directory to the folder that your \texttt{R} script is in. This is the most efficient and useful method, in our experience.
\end{enumerate}

To use this command, you must first install a new package. Run this code:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"rstudioapi"}\NormalTok{)}
\FunctionTok{library}\NormalTok{(rstudioapi)}
\end{Highlighting}
\end{Shaded}

For now, you do not need to understand what this code is doing. We will explain packages and the \texttt{library()} function in a later module.

You can now copy, paste, and run this code to set your working directory automatically:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{setwd}\NormalTok{(}\FunctionTok{dirname}\NormalTok{(rstudioapi}\SpecialCharTok{::}\FunctionTok{getActiveDocumentContext}\NormalTok{()}\SpecialCharTok{$}\NormalTok{path))}
\end{Highlighting}
\end{Shaded}

This is a complicated line of code that you need not understand. As long as it works, it works! Confirm that \texttt{R} is using the correct working directory with the command \texttt{getwd()}.

\hypertarget{typical-workflows}{%
\section*{Typical workflows}\label{typical-workflows}}
\addcontentsline{toc}{section}{Typical workflows}

Now that you know how to create a script and set your working directory, you are prepared to work on data projects in \texttt{RStudio}.

The workflow for beginning a new data project typically goes like this:

\emph{In your file explorer\ldots{}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \textbf{Create a folder for your project} somewhere on your computer. This will become your working directory.
\item
  \textbf{Create subfolders} within your working directory, if you want. We recommend creating a \texttt{data} subfolder, for keeping data, and a \texttt{z} subfolder, for keeping miscellaneous documents. The goal is to keep your working directory visually simple and organized; ideally, the only files not within subfolders are your \texttt{R} scripts.
\item
  \textbf{Add data} to your working directory, if you have any.
\end{enumerate}

\emph{In \texttt{RStudio} \ldots{}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{3}
\item
  \textbf{Create a new \texttt{R} script.}
\item
  \textbf{Save it} inside your intended working directory.
\item
  At the top of your script, use comments to \textbf{add a title, author info, and brief description.}
\item
  Add the code to \textbf{set your working directory.}
\item
  \textbf{Begin coding!}
\end{enumerate}

\hypertarget{template-r-script}{%
\subsection*{\texorpdfstring{Template \texttt{R} script}{Template R script}}\label{template-r-script}}
\addcontentsline{toc}{subsection}{Template \texttt{R} script}

Here is a template you can use to copy and paste into each new script you create:

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\CommentTok{\# \textless{} Add title here \textgreater{}}
\DocumentationTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\CommentTok{\#}
\CommentTok{\# \textless{} Add brief description here \textgreater{}}
\CommentTok{\#}
\CommentTok{\# \textless{} Author \textgreater{}}
\CommentTok{\# Created on \textless{}add date here \textgreater{}}
\CommentTok{\#}
\DocumentationTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\CommentTok{\# Set working directory}
\FunctionTok{setwd}\NormalTok{(}\FunctionTok{dirname}\NormalTok{(rstudioapi}\SpecialCharTok{::}\FunctionTok{getActiveDocumentContext}\NormalTok{()}\SpecialCharTok{$}\NormalTok{path))}

\DocumentationTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\DocumentationTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\CommentTok{\# Code goes here}





\DocumentationTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}
\CommentTok{\# (end of file)}
\end{Highlighting}
\end{Shaded}

\hypertarget{review-assignment-1}{%
\section*{Review assignment:}\label{review-assignment-1}}
\addcontentsline{toc}{section}{Review assignment:}

\textbf{Part 1} \emph{(if not already complete)}. Create a working directory for this course. Call it whatever you like, but \texttt{databoom} could work great. Place it somewhere convenient on your computer, such as your Desktop.

\textbf{Part 2.} Within this working directory, create three new folders: (1) a \texttt{data} folder, which is where you will store the data files we will be using in subsequent modules; (2) a \texttt{modules} folder, which is where you will keep the code you use to work on the material in these modules, and (3) a \texttt{project} folder, which is where you will keep all your work associated with your summer project.

\textbf{Part 3.} Now follow the \emph{Typical Workflow} instructions above to create a script. Save it within your \texttt{modules} folder. Name it \texttt{template.R}. Copy and paste the template \texttt{R} code provided above into this file, and save it. This is now a template that you can use to easily create new scripts for this course.

\textbf{Part 4.} Now make a copy of \texttt{template.R} to stage a script that you can use in the next module. To do so, in \texttt{RStudio} go to the top banner and click \texttt{File\ \textgreater{}\ Save\ As}. Save this new script as \texttt{10\_variables.R} (because the next module is called \emph{Module 10: Variables in \texttt{R}}).

\textbf{Part 5.} Modify the code in \texttt{10-variables.R} so that you are prepared to begin the next module. Change the title, and look ahead to \emph{Module 10} to fill in a brief description. Don't forget to add your name as the author and specify today's date.

Boom!

\hypertarget{other-resources-1}{%
\section*{Other Resources}\label{other-resources-1}}
\addcontentsline{toc}{section}{Other Resources}

\href{https://www.rstudio.com/resources/webinars/a-gentle-introduction-to-tidy-statistics-in-r/}{A Gentle Introduction to \texttt{R} from the \texttt{RStudio} team}

\hypertarget{variables-in-r}{%
\chapter{\texorpdfstring{Variables in \texttt{R}}{Variables in R}}\label{variables-in-r}}

\hypertarget{learning-goals-2}{%
\section*{Learning goals}\label{learning-goals-2}}
\addcontentsline{toc}{section}{Learning goals}

\begin{itemize}
\tightlist
\item
  How to define variables and work with them in \texttt{R}\\
\item
  Learn the various possible classes of data in \texttt{R}
\end{itemize}

Instructor tip!Here is some teacher content.

\hypertarget{introducing-variables}{%
\section*{Introducing variables}\label{introducing-variables}}
\addcontentsline{toc}{section}{Introducing variables}

So far we have strictly been using \texttt{R} as a calculator, with commands such as:

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{3} \SpecialCharTok{+} \DecValTok{5}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 8
\end{verbatim}

Of course, \texttt{R} can do much, much more than these basic computations. Your first step in uncovering the potential of \texttt{R} is learning how to use \textbf{variables}.

In \texttt{R}, a variable is a convenient way of referring to an underlying value. That value can be as simple as a single number (e.g., \texttt{6}), or as complex as a spreadsheet that is many Gigabytes in size. It may be useful to think of a variable as a cup; just as cups make it easy to hold your coffee and carry it from the kitchen to the couch, variables make it easy to contain and work with data.

\hypertarget{declaring-variables}{%
\subsection*{Declaring variables}\label{declaring-variables}}
\addcontentsline{toc}{subsection}{Declaring variables}

To assign numbers or other types of data to a variable, you use the \texttt{\textless{}} and \texttt{-} characters to make the arrow symbol \texttt{\textless{}-}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{3}\SpecialCharTok{+}\DecValTok{5}
\end{Highlighting}
\end{Shaded}

As the direction of the \texttt{\textless{}-} arrow suggests, this command stores the result of \texttt{3\ +\ 5} into the variable \texttt{x}.

Unlike before, you did not see \texttt{8} printed to the \emph{Console}. That is because the result was stored into \texttt{x}.

\hypertarget{calling-variables}{%
\subsection*{Calling variables}\label{calling-variables}}
\addcontentsline{toc}{subsection}{Calling variables}

If you wanted R to tell you what \texttt{x} is, just type the variable name into the \emph{Console} and run that command:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 8
\end{verbatim}

Want to create a variable but also see its value at the same time? Here's a handy trick:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{3}\SpecialCharTok{*}\DecValTok{12}\NormalTok{ ; x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 36
\end{verbatim}

The semicolon simulates hitting \texttt{Enter}. It says: first run \texttt{x\ \textless{}-\ 3*12}, then run \texttt{x}.

You can also update variables.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}}\NormalTok{ x }\SpecialCharTok{*} \DecValTok{3}\NormalTok{ ; x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 108
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}}\NormalTok{ x }\SpecialCharTok{*} \DecValTok{3}\NormalTok{ ; x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 324
\end{verbatim}

You can also add variables together.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{8}
\NormalTok{y }\OtherTok{\textless{}{-}} \FloatTok{4.5}
\NormalTok{x }\SpecialCharTok{+}\NormalTok{ y}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 12.5
\end{verbatim}

\hypertarget{naming-variables}{%
\subsection*{Naming variables}\label{naming-variables}}
\addcontentsline{toc}{subsection}{Naming variables}

Variables are case-sensitive! If you misspell a variable name, you will confuse \texttt{R} and get an error.

For example, ask \texttt{R} to tell you the value of capital \texttt{X}. The error message will be \texttt{Error:\ object\ \textquotesingle{}X\textquotesingle{}\ not\ found}, which means \texttt{R} looked in its memory for an object (i.e., a variable) named \texttt{X} and could not find one.

You can make variable names as complicated or simple as you want.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{supercalifragilistic.expialidocious }\OtherTok{\textless{}{-}} \DecValTok{5}
\NormalTok{supercalifragilistic.expialidocious  }\CommentTok{\# still works}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 5
\end{verbatim}

Note that periods and underscores can be used in variable names:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{my.variable }\OtherTok{\textless{}{-}} \DecValTok{5} \CommentTok{\# periods can be used}
\NormalTok{my\_variable }\OtherTok{\textless{}{-}} \DecValTok{5} \CommentTok{\# underscores can be used}
\end{Highlighting}
\end{Shaded}

However, hyphens cannot be used since that symbol is used for subtraction.

Also note that variables are case-sensitive! If you name a variable \texttt{My\_variable}, \texttt{R} will not recognize it if you refer to it as \texttt{My\_Variable}.

\hypertarget{naming-theory}{%
\subsubsection*{Naming theory}\label{naming-theory}}
\addcontentsline{toc}{subsubsection}{Naming theory}

Naming variables is a bit of an art. The trick is using names that are clear but are not so complicated that typing them is tedious or prone to errors.

Some names need to be avoided, since \texttt{R} uses them for special purposes. For example, \texttt{data} should be avoided, as should \texttt{mean}, since both are functions built-in to \texttt{R} and \texttt{R} is liable to interpret them as such instead of as a variable containing your data.

Note that \texttt{R} uses a feature called `Tab complete' to help you type variable names. Begin typing a variable name, such as \texttt{supercalifragilistic.expialidocious} from the example above, but after the first few letters press the \texttt{Tab} key. \texttt{R} will then give you options for auto-completing your word. Press \texttt{Tab} again, or \texttt{Enter}, to accept the auto-complete. This is a handy way to avoid typos.

\hypertarget{exercise-1-2}{%
\subsubsection*{Exercise 1}\label{exercise-1-2}}
\addcontentsline{toc}{subsubsection}{Exercise 1}

A. Estimate how many bananas you've eaten in your lifetime and store that value in a variable (choose whatever name you wish).

B. Now estimate how many ice cream sandwiches you've eaten in your lifetime and store that in a different variable.

C. Now use these variables to calculate your Banana-to-ICS ratio. Store your result in a third variable, then call that variable in the Console to see your ratio.

D. Who in the class has the highest ratio? Who has the lowest?

\hypertarget{types-of-data-in-r}{%
\section*{\texorpdfstring{Types of data in \texttt{R}}{Types of data in R}}\label{types-of-data-in-r}}
\addcontentsline{toc}{section}{Types of data in \texttt{R}}

So far we have been working exclusively with numeric data. But there are many different data types in R. We call these ``types'' of data \textbf{classes}:

\begin{itemize}
\tightlist
\item
  Decimal values like 4.5 are called \textbf{numeric} data.
\item
  Natural numbers like 4 are called \textbf{integers}. Integers are also numerics.
\item
  Boolean values (TRUE or FALSE) are called \textbf{logical} data.
\item
  Text (or string) values are called \textbf{character} data.
\end{itemize}

In order to be combined, data have to be the same class.

R is able to compute the following commands \ldots{}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{6}
\NormalTok{y }\OtherTok{\textless{}{-}} \DecValTok{4}
\NormalTok{x }\SpecialCharTok{+}\NormalTok{ y}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 10
\end{verbatim}

\ldots{} but not these:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{6}
\NormalTok{y }\OtherTok{\textless{}{-}} \StringTok{"4"}
\NormalTok{x }\SpecialCharTok{+}\NormalTok{ y}
\end{Highlighting}
\end{Shaded}

That's because the quotation marks used in naming \texttt{y} causes \texttt{R} to interpret \texttt{y} as a \texttt{character} class.

To see how \texttt{R} is interpreting variables, you can use the \texttt{class()} function:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{100}
\FunctionTok{class}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "numeric"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \StringTok{"100"}
\FunctionTok{class}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "character"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{100} \SpecialCharTok{==} \DecValTok{101}
\FunctionTok{class}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "logical"
\end{verbatim}

Another data type to be aware of is \textbf{factors}, but we will deal with them later.

\hypertarget{exercise-3-1}{%
\subsection*{Exercise 3}\label{exercise-3-1}}
\addcontentsline{toc}{subsection}{Exercise 3}

\emph{NOTE: UNDER CONSTRUCTION!}

\hypertarget{review-assignment-2}{%
\section*{Review assignment}\label{review-assignment-2}}
\addcontentsline{toc}{section}{Review assignment}

\emph{NOTE: UNDER CONSTRUCTION!}

\hypertarget{other-resources-2}{%
\section*{Other Resources}\label{other-resources-2}}
\addcontentsline{toc}{section}{Other Resources}

\hypertarget{structures-for-data-in-r}{%
\chapter{\texorpdfstring{Structures for data in \texttt{R}}{Structures for data in R}}\label{structures-for-data-in-r}}

\hypertarget{learning-goals-3}{%
\section*{Learning goals}\label{learning-goals-3}}
\addcontentsline{toc}{section}{Learning goals}

\begin{itemize}
\tightlist
\item
  Learn the various structures of data in \texttt{R}\\
\item
  How to work with vectors in \texttt{R}.
\end{itemize}

Instructor tip!Here is some teacher content.

\hypertarget{introducing-data-structures}{%
\section*{Introducing data structures}\label{introducing-data-structures}}
\addcontentsline{toc}{section}{Introducing data structures}

Data belong to different \emph{classes}, as explained in the previous module, and they can be arranged into various \textbf{structures}.

So far we have been dealing only with variables that contain a single value, but the real value of \texttt{R} comes from assigning \emph{entire sets} of data to a variable.

\hypertarget{vectors}{%
\section*{Vectors}\label{vectors}}
\addcontentsline{toc}{section}{Vectors}

The simplest data structure in \texttt{R} is a \textbf{vector}. A vector is simply a set of values. A vector can contain only a single value, as we have been working with thus far, or it can contain many millions of values.

\hypertarget{declaring-and-using-vectors}{%
\subsection*{Declaring and using vectors}\label{declaring-and-using-vectors}}
\addcontentsline{toc}{subsection}{Declaring and using vectors}

To build up a vector in \texttt{R}, use the function \texttt{c()}, which is short for ``concatenate''.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{8}\NormalTok{)}
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 5 6 7 8
\end{verbatim}

You can use the \texttt{c()} function to concatenate two vectors together:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{8}\NormalTok{)}
\NormalTok{y }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{9}\NormalTok{,}\DecValTok{10}\NormalTok{,}\DecValTok{11}\NormalTok{,}\DecValTok{12}\NormalTok{)}
\NormalTok{z }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(x,y)}
\NormalTok{z}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1]  5  6  7  8  9 10 11 12
\end{verbatim}

You can also use \texttt{c()} to add values to a vector:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{8}\NormalTok{)}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(x,}\DecValTok{9}\NormalTok{)}
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 5 6 7 8 9
\end{verbatim}

When two vectors are of the same length, you can do arithmetic with them:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{8}\NormalTok{)}
\NormalTok{y }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{9}\NormalTok{,}\DecValTok{10}\NormalTok{,}\DecValTok{11}\NormalTok{,}\DecValTok{12}\NormalTok{)}

\NormalTok{x }\SpecialCharTok{+}\NormalTok{ y}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 14 16 18 20
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\SpecialCharTok{{-}}\NormalTok{ y}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] -4 -4 -4 -4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\SpecialCharTok{*}\NormalTok{ y}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 45 60 77 96
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\SpecialCharTok{/}\NormalTok{ y}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.5555556 0.6000000 0.6363636 0.6666667
\end{verbatim}

You can also put vectors through logical tests:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{5}
\DecValTok{4} \SpecialCharTok{==}\NormalTok{ x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] FALSE FALSE FALSE  TRUE FALSE
\end{verbatim}

This command is asking \texttt{R} to tell you whether each element in \texttt{x} is equal to \texttt{4}.

You can create vectors of any data class (i.e., data type).

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Ben"}\NormalTok{,}\StringTok{"Joe"}\NormalTok{,}\StringTok{"Eric"}\NormalTok{) }
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "Ben"  "Joe"  "Eric"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\ConstantTok{TRUE}\NormalTok{,}\ConstantTok{TRUE}\NormalTok{,}\ConstantTok{FALSE}\NormalTok{)}
\NormalTok{y}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1]  TRUE  TRUE FALSE
\end{verbatim}

Note that all values within a vector \emph{must} be of the same class. You can't combine numerics and characters into the same vector. If you did, \texttt{R} would try to convert the numbers to characters. For example:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{4}
\NormalTok{y }\OtherTok{\textless{}{-}} \StringTok{"6"}
\NormalTok{z }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(x,y)}
\NormalTok{z}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "4" "6"
\end{verbatim}

\hypertarget{useful-functions-for-handling-vectors}{%
\subsection*{Useful functions for handling vectors}\label{useful-functions-for-handling-vectors}}
\addcontentsline{toc}{subsection}{Useful functions for handling vectors}

\textbf{\texttt{length()}} tells you the number of elements in a vector:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{)}
\NormalTok{y }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{9}\NormalTok{,}\DecValTok{10}\NormalTok{,}\DecValTok{11}\NormalTok{,}\DecValTok{12}\NormalTok{)}

\FunctionTok{length}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{length}\NormalTok{(y)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 4
\end{verbatim}

The \textbf{colon symbol \texttt{:}} creates a vector with every integer occurring between a min and max:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1]  1  2  3  4  5  6  7  8  9 10
\end{verbatim}

\textbf{\texttt{seq()}} allows you to build a vector using evenly spaced \emph{sequence} of values between a min and max:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{100}\NormalTok{,}\AttributeTok{length=}\DecValTok{11}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1]   0  10  20  30  40  50  60  70  80  90 100
\end{verbatim}

In this command, you are telling \texttt{R} to give you a sequence of values from \texttt{0} to \texttt{100}, and you want the length of that vector to be \texttt{11}. \texttt{R} then figures out the spacing required between each value in order to make that happen.

Alternatively, you can prescribe the interval between values instead of the length:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{100}\NormalTok{,}\AttributeTok{by=}\DecValTok{7}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1]  0  7 14 21 28 35 42 49 56 63 70 77 84 91 98
\end{verbatim}

\textbf{\texttt{rep()}} allows you to repeat a single value a specified number of times:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{rep}\NormalTok{(}\StringTok{"Hey!"}\NormalTok{,}\AttributeTok{times=}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "Hey!" "Hey!" "Hey!" "Hey!" "Hey!"
\end{verbatim}

\textbf{\texttt{head()}} and \textbf{\texttt{tail()}} can be used to retrieve the first 6 or last 6 elements in a vector, respectively.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{1000}
\FunctionTok{head}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1 2 3 4 5 6
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{tail}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1]  995  996  997  998  999 1000
\end{verbatim}

You can also adjust how many elements to return:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(x,}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1 2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{tail}\NormalTok{(x,}\DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1]  991  992  993  994  995  996  997  998  999 1000
\end{verbatim}

\textbf{\texttt{sort()}} allows you to order a vector from its smallest value to its largest:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{,}\DecValTok{8}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{9}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{3}\NormalTok{)}
\FunctionTok{sort}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1 2 3 4 5 6 7 8 9
\end{verbatim}

\textbf{\texttt{rev()}} lets you reverse the order of elements within a vector:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{,}\DecValTok{8}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{9}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{3}\NormalTok{)}
\FunctionTok{rev}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 3 5 7 2 9 6 1 8 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{rev}\NormalTok{(}\FunctionTok{sort}\NormalTok{(x))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 9 8 7 6 5 4 3 2 1
\end{verbatim}

\textbf{\texttt{which()}} allows you to ask, ``For which elements of a vector is the following statement true?''

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}
\FunctionTok{which}\NormalTok{(x}\SpecialCharTok{==}\DecValTok{4}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 4
\end{verbatim}

If no values within the vector meet the condition, a vector of length zero will be returned:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}
\FunctionTok{which}\NormalTok{(x }\SpecialCharTok{==} \DecValTok{11}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
integer(0)
\end{verbatim}

\textbf{\texttt{\%in\%}} is a handy operator that allows you to ask whether a value occurs \emph{within} a vector:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}
\DecValTok{4} \SpecialCharTok{\%in\%}\NormalTok{ x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{11} \SpecialCharTok{\%in\%}\NormalTok{ x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] FALSE
\end{verbatim}

\hypertarget{exercise-2-1}{%
\subsubsection*{Exercise 2}\label{exercise-2-1}}
\addcontentsline{toc}{subsubsection}{Exercise 2}

\emph{NOTE: UNDER CONSTRUCTION!}

\hypertarget{subsetting-vectors}{%
\subsection*{Subsetting vectors}\label{subsetting-vectors}}
\addcontentsline{toc}{subsection}{Subsetting vectors}

Since you will eventually be working with vectors that contain thousands of data points, it will be useful to have some tools for \emph{subsetting} them -- that is, looking at only a few select elements at a time.

You can subset a vector using square brackets \texttt{{[}\ {]}}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{50}\SpecialCharTok{:}\DecValTok{100}
\NormalTok{x[}\DecValTok{10}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 59
\end{verbatim}

This command is asking \texttt{R} to return the 10th element in the vector \texttt{x}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x[}\DecValTok{10}\SpecialCharTok{:}\DecValTok{20}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1] 59 60 61 62 63 64 65 66 67 68 69
\end{verbatim}

This command is asking \texttt{R} to return elements \texttt{10:20} in the vector \texttt{x}.

\hypertarget{exercise-3-2}{%
\subsubsection*{Exercise 3}\label{exercise-3-2}}
\addcontentsline{toc}{subsubsection}{Exercise 3}

A. Figure out how to replicate the \texttt{head()} function using your new vector subsetting skills.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{6}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 50 51 52 53 54 55
\end{verbatim}

B. Now replicate the \texttt{tail()} function, using those same skills as well as the \texttt{length()} function you just learned.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x[(}\FunctionTok{length}\NormalTok{(x) }\SpecialCharTok{{-}} \DecValTok{5}\NormalTok{) }\SpecialCharTok{:} \FunctionTok{length}\NormalTok{(x)]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1]  95  96  97  98  99 100
\end{verbatim}

\hypertarget{dataframes-other-data-structures}{%
\subsection*{Dataframes \& other data structures}\label{dataframes-other-data-structures}}
\addcontentsline{toc}{subsection}{Dataframes \& other data structures}

A \textbf{vector} is the most basic data structure in \texttt{R}, and the other structures are built out of vectors.

As a data scientist, the most common data structure you will be working with is a \textbf{dataframe}, which is essentially a spreadsheet: a dataset with rows and columns, in which each column represents is a vector of the same class of data.

We will explore dataframes in detail later, but here is a sneak peak at what they look like:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{x=}\DecValTok{300}\SpecialCharTok{:}\DecValTok{310}\NormalTok{,}
           \AttributeTok{y=}\DecValTok{600}\SpecialCharTok{:}\DecValTok{610}\NormalTok{)}
\NormalTok{df}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
     x   y
1  300 600
2  301 601
3  302 602
4  303 603
5  304 604
6  305 605
7  306 606
8  307 607
9  308 608
10 309 609
11 310 610
\end{verbatim}

In this command, we used the \texttt{data.frame()} function to combine two vectors into a dataframe with two columns named \texttt{x} and \texttt{y}. \texttt{R} then saved this result in a new variable named \texttt{df}. When we call \texttt{df}, \texttt{R} shows us the dataframe.

The great thing about dataframes is that they allow you to relate different data types to each other.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{name=}\FunctionTok{c}\NormalTok{(}\StringTok{"Ben"}\NormalTok{,}\StringTok{"Joe"}\NormalTok{,}\StringTok{"Eric"}\NormalTok{),}
                 \AttributeTok{height.inches=}\FunctionTok{c}\NormalTok{(}\DecValTok{75}\NormalTok{,}\DecValTok{73}\NormalTok{,}\DecValTok{80}\NormalTok{))}
\NormalTok{df}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  name height.inches
1  Ben            75
2  Joe            73
3 Eric            80
\end{verbatim}

This dataframe has one column of class \texttt{character} and another of class \texttt{numeric}.

The two other most common data structures are \textbf{matrices} and \textbf{lists}, but we will wait on learning about thos. For now, focus on becoming comfortable using vectors and dataframes.

\hypertarget{exercise-3-3}{%
\subsection*{Exercise 3}\label{exercise-3-3}}
\addcontentsline{toc}{subsection}{Exercise 3}

\emph{NOTE: UNDER CONSTRUCTION!}

\hypertarget{review-assignment-3}{%
\section*{Review assignment}\label{review-assignment-3}}
\addcontentsline{toc}{section}{Review assignment}

\emph{NOTE: UNDER CONSTRUCTION!}

\hypertarget{other-resources-3}{%
\section*{Other Resources}\label{other-resources-3}}
\addcontentsline{toc}{section}{Other Resources}

\hypertarget{calling-functions}{%
\chapter{Calling functions}\label{calling-functions}}

\hypertarget{learning-goals-4}{%
\section*{Learning goals}\label{learning-goals-4}}
\addcontentsline{toc}{section}{Learning goals}

\begin{itemize}
\tightlist
\item
  Understand what functions are, and why they are awesome.
\item
  Understand how functions work.
\item
  Understand how to read function documentation.
\end{itemize}

Instructor tip!Here is some teacher content.

\hypertarget{introducing-r-functions}{%
\section*{\texorpdfstring{Introducing \texttt{R} functions}{Introducing R functions}}\label{introducing-r-functions}}
\addcontentsline{toc}{section}{Introducing \texttt{R} functions}

You have already worked with many \texttt{R} functions; commands like \texttt{getwd()}, \texttt{length()}, and \texttt{unique()} are all functions. You know a command is a function because it has parentheses, \texttt{()}, attached at its end.

Just as \textbf{variables} are convenient names used for calling \emph{objects} such as vectors or dataframes, \textbf{functions} are convenient names for calling \emph{processes} or \emph{actions}. An \texttt{R} function is just a batch of code that performs a certain action.

Variables represent data, while functions represent code.

Most functions have three key components: (1) one or more inputs, (2) a process that is applied to those inputs, and (3) an output of the result. When you call a function in \texttt{R}, you are saying, ``Hey \texttt{R}, take this information, do something to it, and return the result to me.'' You supply the function with the inputs, and the function takes care of the rest.

Take the function \texttt{mean()}, for example. \texttt{mean()} finds the arithmetic mean (i.e., the average) of a set of values.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{8}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{3}\NormalTok{) }\CommentTok{\# create a vector of numbers}
\FunctionTok{mean}\NormalTok{(x) }\CommentTok{\# find their mean}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 4.625
\end{verbatim}

In this command, you are feeding the function \texttt{mean()} with the input \texttt{x}.

\hypertarget{base-functions-in-r}{%
\subsection*{\texorpdfstring{Base functions in \texttt{R}}{Base functions in R}}\label{base-functions-in-r}}
\addcontentsline{toc}{subsection}{Base functions in \texttt{R}}

There are hundreds of functions already built-in to \texttt{R}. These functions are called \emph{``base functions''}. Throughout these modules, we have been -- and will continue -- introducing you to the most commonly used base functions.

You can access other functions through bundles of external code known as \emph{packages}, which we explain in an upcoming module.

You can also write your \emph{own} functions (and you will!). We provide an entire module on how to do this.

Note that not all functions require an input. The function \texttt{getwd()}, for example, does not need anything in its parentheses to find and return current your working directory.

\hypertarget{saving-function-output}{%
\subsection*{Saving function output}\label{saving-function-output}}
\addcontentsline{toc}{subsection}{Saving function output}

You will almost always want to save the result of a function in a new variable. Otherwise the function just prints its result to the \emph{Console} and \texttt{R} forgets about it.

You can store a function result the same way you store any value:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{8}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{3}\NormalTok{) }
\NormalTok{x\_mean }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(x) }
\NormalTok{x\_mean}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 4.625
\end{verbatim}

\hypertarget{functions-with-multiple-inputs}{%
\subsection*{Functions with multiple inputs}\label{functions-with-multiple-inputs}}
\addcontentsline{toc}{subsection}{Functions with multiple inputs}

Note that \texttt{mean()} accepts a second input that is called \texttt{na.rm}. This is short for \texttt{NA.remove}. When this is set to \texttt{TRUE}, \texttt{R} will remove broken or missing values from the vector before calculating the mean.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{2}\NormalTok{,}\ConstantTok{NA}\NormalTok{,}\DecValTok{8}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{3}\NormalTok{)  }\CommentTok{\# note the NA}
\FunctionTok{mean}\NormalTok{(x,}\AttributeTok{na.rm=}\ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 4.428571
\end{verbatim}

If you tried to run these commands with \texttt{na.rm} set to \texttt{FALSE}, \texttt{R} would throw an error and give up.

Note that you provided the function \texttt{mean()} with two inputs, \texttt{x} and \texttt{na.rm}, and that you separated each input with a comma. This is how you pass multiple inputs to a function.

\hypertarget{function-defaults}{%
\subsection*{Function defaults}\label{function-defaults}}
\addcontentsline{toc}{subsection}{Function defaults}

Note that many functions have default values for their inputs. If you do not specify the input's value yourself, \texttt{R} will assume you just want to use the default. In the case of \texttt{mean()}, the default value for \texttt{na.rm} is \texttt{FALSE}. This means that the following code would throw an error \ldots{}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{2}\NormalTok{,}\ConstantTok{NA}\NormalTok{,}\DecValTok{8}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{3}\NormalTok{)  }\CommentTok{\# note the NA}
\FunctionTok{mean}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] NA
\end{verbatim}

Because \texttt{R} will assume you are using the default value for \texttt{na.rm}, which is \texttt{FALSE}, which means you do not want to remove missing values before trying to calculate the mean.

\hypertarget{function-documentation-i.e.-getting-help}{%
\subsection*{Function documentation (i.e., getting help)}\label{function-documentation-i.e.-getting-help}}
\addcontentsline{toc}{subsection}{Function documentation (i.e., getting help)}

Functions are designed to accept only a certain number of inputs with only certain names. To figure out what a function expects in terms of inputs, and what you can expect in terms of output, you can call up the function's help page:

When you enter this command, the help documentation for \texttt{mean()} will appear in the bottom right pane of your \texttt{RStudio} window:

\includegraphics{img/functions_help.png}

Learning how to read this documentation is essential to becoming competent in using \texttt{R}.

\textbf{Be warned:} not all documentation is easy to understand! You will come to really resent poorly written documentation and really appreciate well-written documentation; the few extra minutes taken by the function's author to write good documentation saves users around the world hours of frustration and confusion.

\begin{itemize}
\item
  The \texttt{Title} and \texttt{Description} help you understand what this function does.
\item
  The \texttt{Usage} section shows you how type out the function.
\item
  The \texttt{Arguments} section lists out each possible argument (which in \texttt{R} lingo is another word for \emph{input} or \emph{parameter}), explains what that input is asking for, and details any formatting requirements.
\item
  The \texttt{Value} section describes what the function returns as output.
\item
  At the bottom of the help page, example code is provided to show you how the function works. You can copy and paste this code into your own script of \emph{Console} and check out the results.
\end{itemize}

Note that more complex functions may also include a \texttt{Details} section in their documentation, which gives more explanation about what the function does, what kinds of inputs it requires, and what it returns.

\hypertarget{function-examples}{%
\subsection*{Function examples}\label{function-examples}}
\addcontentsline{toc}{subsection}{Function examples}

\texttt{R} comes with a set of base functions for descriptive statistics, which provide good examples of how functions work and why they are valuable.

We can use the same vector as the input for all of these functions:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{2}\NormalTok{,}\ConstantTok{NA}\NormalTok{,}\DecValTok{8}\NormalTok{,}\DecValTok{9}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{9}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{3}\NormalTok{)  }\CommentTok{\# note the NA}
\end{Highlighting}
\end{Shaded}

\textbf{\texttt{mean()}} has been explained above.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{result }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(x,}\AttributeTok{na.rm=}\ConstantTok{TRUE}\NormalTok{)}
\NormalTok{result}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 4.210526
\end{verbatim}

\textbf{\texttt{median()}} returns the median value in the supplied vector:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{result }\OtherTok{\textless{}{-}} \FunctionTok{median}\NormalTok{(x,}\AttributeTok{na.rm=}\ConstantTok{TRUE}\NormalTok{)}
\NormalTok{result}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 3
\end{verbatim}

\textbf{\texttt{sd()}} returns the standard deviation of the supplied vector:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{result }\OtherTok{\textless{}{-}} \FunctionTok{sd}\NormalTok{(x,}\AttributeTok{na.rm=}\ConstantTok{TRUE}\NormalTok{)}
\NormalTok{result}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 2.594416
\end{verbatim}

\textbf{\texttt{summary()}} returns a vector that describes several aspects of the vector's distribution:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{result }\OtherTok{\textless{}{-}} \FunctionTok{summary}\NormalTok{(x,}\AttributeTok{na.rm=}\ConstantTok{TRUE}\NormalTok{)}
\NormalTok{result}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
  0.000   2.500   3.000   4.211   6.000   9.000       1 
\end{verbatim}

\hypertarget{review-assignment-4}{%
\section*{Review assignment}\label{review-assignment-4}}
\addcontentsline{toc}{section}{Review assignment}

\emph{NOTE: Under construction!}

\hypertarget{other-resources-4}{%
\section*{Other Resources}\label{other-resources-4}}
\addcontentsline{toc}{section}{Other Resources}

\emph{NOTE: Under construction!}

\hypertarget{base-plots}{%
\chapter{Base plots}\label{base-plots}}

\hypertarget{learning-goals-5}{%
\section*{Learning goals}\label{learning-goals-5}}
\addcontentsline{toc}{section}{Learning goals}

\begin{itemize}
\tightlist
\item
  Make basic plots in \texttt{R}
\item
  Basic adjustments to plot formatting
\end{itemize}

Instructor tip!Here is some teacher content.

\hypertarget{introduction}{%
\section*{Introduction}\label{introduction}}
\addcontentsline{toc}{section}{Introduction}

To learn how to plot, let's first create a dataset to work with:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{country }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"USA"}\NormalTok{,}\StringTok{"Tanzania"}\NormalTok{,}\StringTok{"Japan"}\NormalTok{,}\StringTok{"Ctr. Africa Rep."}\NormalTok{,}\StringTok{"China"}\NormalTok{,}\StringTok{"Norway"}\NormalTok{,}\StringTok{"India"}\NormalTok{)}
\NormalTok{lifespan }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{79}\NormalTok{,}\DecValTok{65}\NormalTok{,}\DecValTok{84}\NormalTok{,}\DecValTok{53}\NormalTok{,}\DecValTok{77}\NormalTok{,}\DecValTok{82}\NormalTok{,}\DecValTok{69}\NormalTok{)}
\NormalTok{gdp }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{55335}\NormalTok{,}\DecValTok{2875}\NormalTok{,}\DecValTok{38674}\NormalTok{,}\DecValTok{623}\NormalTok{,}\DecValTok{13102}\NormalTok{,}\DecValTok{84500}\NormalTok{,}\DecValTok{6807}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

These data come from this \href{https://datasets.iisg.amsterdam/dataset.xhtml?persistentId=hdl:10622/LKYT53}{publicly available database} that compares health and economic indices across countries in 2011.

The \texttt{lifespan} column presents the average life expectancy for each country.

The \texttt{gdp} column presents the average GDP per capita within that country, which is a common index for the income and wealth of average citizens.

Let's see if there is a relationship between life expectancy and income.

\hypertarget{create-a-basic-plot}{%
\section*{Create a basic plot}\label{create-a-basic-plot}}
\addcontentsline{toc}{section}{Create a basic plot}

The simplest way to make a basic plot in \texttt{R} is to use its built-in \texttt{plot()} function:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(lifespan }\SpecialCharTok{\textasciitilde{}}\NormalTok{ gdp)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-98-1.pdf}

This syntax is saying this: plot column \texttt{lifespan} as a function of \texttt{gdp}. The symbol \texttt{\textasciitilde{}} denotes \emph{``as a function of''}. This frames \texttt{lifespan} as a dependent variable (y axis) that is affected by the independent variable (x axis), which in this case is \texttt{gdp}.

Note that \texttt{R} uses the variable names you provided as the x- and y-axes. You can adjust these labels however you wish (see formatting section below).

You can also produce this exact same plot using the following syntax:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(}\AttributeTok{y=}\NormalTok{lifespan, }\AttributeTok{x=}\NormalTok{gdp)}
\end{Highlighting}
\end{Shaded}

Choose whichever one is most intuitive to you.

\hypertarget{most-common-types-of-plots}{%
\section*{Most common types of plots}\label{most-common-types-of-plots}}
\addcontentsline{toc}{section}{Most common types of plots}

The plot above is a \textbf{scatter plot}, and is one of the most common types of plots in data science.

You can turn this into a \textbf{line plot} by adding a parameter to the \texttt{plot()} function:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(lifespan }\SpecialCharTok{\textasciitilde{}}\NormalTok{ gdp, }\AttributeTok{type=}\StringTok{"l"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-100-1.pdf}

\emph{What a mess!} Rather than connecting these values in the order you might expect, \texttt{R} connects them in the order that they are listed in their source vectors. This is why line plots tend to be more useful in scenarios such as time series, which are inherently ordered.

Another common plot is the \textbf{bar plot}, which uses a different \texttt{R} function:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(}\AttributeTok{height=}\NormalTok{lifespan,}\AttributeTok{names.arg=}\NormalTok{country)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-101-1.pdf}

In this command, the parameter \texttt{height} determines the height of the bars, and \texttt{names.arg} provides the labels to place beneath each bar.

There are many more plot types out there, but let's stop here now.

\hypertarget{exercise-1-3}{%
\subsection*{Exercise 1}\label{exercise-1-3}}
\addcontentsline{toc}{subsection}{Exercise 1}

Produce a bar plot that shows the GDP for each country.

\hypertarget{basic-plot-formatting}{%
\section*{Basic plot formatting}\label{basic-plot-formatting}}
\addcontentsline{toc}{section}{Basic plot formatting}

You can adjust the default formatting of plots by adding other inputs to your \texttt{plot()} command. To understand all the parameters you can adjust, bring up the help page for this function:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{?plot}
\end{Highlighting}
\end{Shaded}

If multiple help page options are returned, select the \emph{Generiz X-Y Plotting} page from the \texttt{base} package. This is the plot function that comes built-in to \texttt{R}.

Here we demonstrate just a few of the most common formatting adjustments you are likely to use:

\textbf{Set plot range} using \texttt{xlim} (for the x axis) and \texttt{ylim} (for the y axis):

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(lifespan }\SpecialCharTok{\textasciitilde{}}\NormalTok{ gdp,}\AttributeTok{xlim=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{60000}\NormalTok{),}\AttributeTok{ylim=}\FunctionTok{c}\NormalTok{(}\DecValTok{40}\NormalTok{,}\DecValTok{100}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-104-1.pdf}

In this command, you are defining axis limits using a 2-element vector (i.e., \texttt{c(min,max)}).

Note that it can be easier to read your code if you put each input on a new line, like this:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(lifespan }\SpecialCharTok{\textasciitilde{}}\NormalTok{ gdp,}
     \AttributeTok{xlim=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{60000}\NormalTok{),}
     \AttributeTok{ylim=}\FunctionTok{c}\NormalTok{(}\DecValTok{40}\NormalTok{,}\DecValTok{100}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

Make sure each input line within the function ends with a comma, otherwise you \texttt{R} will get confused and throw an error.

\textbf{Set dot type} using the input \texttt{pch}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(lifespan }\SpecialCharTok{\textasciitilde{}}\NormalTok{ gdp,}\AttributeTok{pch=}\DecValTok{16}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-106-1.pdf}

\textbf{Set dot color} using the input \texttt{col} (the default is \texttt{col="black"})

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(lifespan }\SpecialCharTok{\textasciitilde{}}\NormalTok{ gdp,}\AttributeTok{col=}\StringTok{"red"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-107-1.pdf}

\href{http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf?utm_source=twitterfeed\&utm_medium=twitter}{Here is a great resource} for color names in \texttt{R}.

\textbf{Set dot size} using the input \texttt{cex} (the default is \texttt{cex=1}):

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(lifespan }\SpecialCharTok{\textasciitilde{}}\NormalTok{ gdp,}\AttributeTok{cex=}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-108-1.pdf}

\textbf{Set axis labels} using the inputs \texttt{xlab} and \texttt{ylab}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(lifespan }\SpecialCharTok{\textasciitilde{}}\NormalTok{ gdp, }\AttributeTok{xlab=}\StringTok{"Gross Domestic Product (GDP)"}\NormalTok{,}\AttributeTok{ylab=}\StringTok{"Life Expectancy"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-109-1.pdf}

\textbf{Set axis number size} using the input \texttt{cex.axis} (the default is \texttt{cex.axis=1}):

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(lifespan }\SpecialCharTok{\textasciitilde{}}\NormalTok{ gdp,}\AttributeTok{cex.axis=}\NormalTok{.}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-110-1.pdf}

\textbf{Set axis label size} using the input \texttt{cex.label} (the default is \texttt{cex.lab=1}):

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(lifespan }\SpecialCharTok{\textasciitilde{}}\NormalTok{ gdp,}\AttributeTok{cex.lab=}\NormalTok{.}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-111-1.pdf}

\textbf{Set plot margins} using the function \texttt{par(mar=c())} before you call \texttt{plot()}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{par}\NormalTok{(}\AttributeTok{mar=}\FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{,}\DecValTok{5}\NormalTok{,}\FloatTok{0.5}\NormalTok{,}\FloatTok{0.5}\NormalTok{))}
\FunctionTok{plot}\NormalTok{(lifespan }\SpecialCharTok{\textasciitilde{}}\NormalTok{ gdp)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-112-1.pdf}

In this command, the four numbers in the vector used to define \texttt{mar} correspond to the margin for the bottom, left, top, and right sides of the plot, respectively.

\textbf{Create a multi-pane plot} using the function \texttt{par(mfrow=c())} before you call \texttt{plot()}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\FunctionTok{plot}\NormalTok{(lifespan }\SpecialCharTok{\textasciitilde{}}\NormalTok{ gdp,}\AttributeTok{col=}\StringTok{"red"}\NormalTok{,}\AttributeTok{pch=}\DecValTok{16}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(lifespan }\SpecialCharTok{\textasciitilde{}}\NormalTok{ gdp,}\AttributeTok{col=}\StringTok{"blue"}\NormalTok{,}\AttributeTok{pch=}\DecValTok{16}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-113-1.pdf}

In this command, the two numbers in the vector used to define \texttt{mfrow} correspond to the number of rows and columns, respectively, on the entire plot. In this case, you have 1 row of plots with two columns.

Note that you will need to reset the number of panes when you are done with your multi-pane plot!

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\textbf{Plot dots and lines at once} using the input \texttt{type}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\FunctionTok{plot}\NormalTok{(lifespan }\SpecialCharTok{\textasciitilde{}}\NormalTok{ gdp,}\AttributeTok{type=}\StringTok{"b"}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(lifespan }\SpecialCharTok{\textasciitilde{}}\NormalTok{ gdp,}\AttributeTok{type=}\StringTok{"o"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-115-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

Note the two slightly different formats here.

\textbf{Use a logarithmic scale} for one or of your axes using the input \texttt{log}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(lifespan }\SpecialCharTok{\textasciitilde{}}\NormalTok{ gdp,}\AttributeTok{log=}\StringTok{"x"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-116-1.pdf}

\hypertarget{exercise-2-2}{%
\subsection*{Exercise 2}\label{exercise-2-2}}
\addcontentsline{toc}{subsection}{Exercise 2}

Produce a \emph{beautifully} formatted plot that incorporates \textbf{all} of these customization inputs explained above into a multi-paned plot.

\hypertarget{plotting-with-data-frames}{%
\section*{Plotting with data frames}\label{plotting-with-data-frames}}
\addcontentsline{toc}{section}{Plotting with data frames}

So far in this tutorial we have been using vectors to produce plots. This is nice for learning, but does not represent the real world very well. You will almost always be producing plots using dataframes.

Let's turn these vectors into a dataframe:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(country,lifespan,gdp)}
\NormalTok{df}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
           country lifespan   gdp
1              USA       79 55335
2         Tanzania       65  2875
3            Japan       84 38674
4 Ctr. Africa Rep.       53   623
5            China       77 13102
6           Norway       82 84500
7            India       69  6807
\end{verbatim}

To plot data within a dataframe, your \texttt{plot()} syntax changes slightly:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(lifespan }\SpecialCharTok{\textasciitilde{}}\NormalTok{ gdp, }\AttributeTok{data=}\NormalTok{df)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-118-1.pdf}

This syntax is saying this: using the dataframe named \texttt{df} as a source, plot column \texttt{lifespan} as a function of column \texttt{gdp}. The symbol \texttt{\textasciitilde{}} denotes \emph{``as a function of''}. This frames \texttt{lifespan} as a dependent variable (y axis) that is affected by the independent variable (x axis), which in this case is \texttt{gdp}.

Another way to write this command is as follows:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{lifespan }\SpecialCharTok{\textasciitilde{}}\NormalTok{ df}\SpecialCharTok{$}\NormalTok{gdp)}
\end{Highlighting}
\end{Shaded}

In this command, the \texttt{\$} symbol is saying, ``give me the column in \texttt{df} named \texttt{lifespan}''. It is a handy way of referring to a column within a dataframe by name. You will learn more about working with dataframes in an upcoming module.

\hypertarget{exercise-2-3}{%
\subsection*{Exercise 2}\label{exercise-2-3}}
\addcontentsline{toc}{subsection}{Exercise 2}

A. Use the \texttt{df} dataframe to produce a bar plot that shows life expectancy for each country.

B. Use the \texttt{df} dataframe to produce a jumbled line plot of life expectancy as a function of GDP. Reference the \texttt{plot()} documentation to figure out how to change the thickness of the line.

\hypertarget{next-level-plotting}{%
\section*{Next-level plotting}\label{next-level-plotting}}
\addcontentsline{toc}{section}{Next-level plotting}

The possibilities for data visualization in \texttt{R} are prety much limitless, and over time you will become fluent in making gorgeous plots. Here are a few common tools that can take your plots to the next level.

\hypertarget{adding-lines}{%
\subsection*{Adding lines}\label{adding-lines}}
\addcontentsline{toc}{subsection}{Adding lines}

In some cases it is useful to add reference lines to your plot. For example, what if we wanted to be able to quickly see which countries had life expectancies below 75 years?

You can add a line at \texttt{lifespan\ =\ 75} using the function \texttt{abline()}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{lifespan }\SpecialCharTok{\textasciitilde{}}\NormalTok{ df}\SpecialCharTok{$}\NormalTok{gdp)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{h=}\DecValTok{75}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-120-1.pdf}

In this command, the \texttt{h} input means ``place a horizontal line at this y value.''.

Similarly, you can use \texttt{v} to specify vertical lines at certain x values.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{lifespan }\SpecialCharTok{\textasciitilde{}}\NormalTok{ df}\SpecialCharTok{$}\NormalTok{gdp)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v=}\FunctionTok{c}\NormalTok{(}\DecValTok{25000}\NormalTok{,}\DecValTok{35000}\NormalTok{),}\AttributeTok{lty=}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-121-1.pdf}

Note here that another input, \texttt{lty}, was used to change the type of line printed. (Refer to \texttt{?abline()} for more details).

\hypertarget{exercise-4-1}{%
\subsubsection*{Exercise 4}\label{exercise-4-1}}
\addcontentsline{toc}{subsubsection}{Exercise 4}

Produce a plot of life expectancy as a function of GDP per capita. Then add a line to your plot that indicates which countries have per-capita GDPs that fall below (or above) the average per-capita GDP for the whole dataset. Make your line dashed and color it red.

\hypertarget{adding-text}{%
\subsection*{Adding text}\label{adding-text}}
\addcontentsline{toc}{subsection}{Adding text}

Use the \texttt{text()} function to add labels to your plot:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{lifespan }\SpecialCharTok{\textasciitilde{}}\NormalTok{ df}\SpecialCharTok{$}\NormalTok{gdp)}
\FunctionTok{text}\NormalTok{(}\AttributeTok{x=}\DecValTok{30000}\NormalTok{,}\AttributeTok{y=}\DecValTok{75}\NormalTok{,}\AttributeTok{labels=}\StringTok{"My text went here"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-122-1.pdf}

\hypertarget{exercise-5-1}{%
\subsubsection*{Exercise 5}\label{exercise-5-1}}
\addcontentsline{toc}{subsubsection}{Exercise 5}

Produce a plot of life expectancy as a function of GDP per capita, then label each point by country. Make the labels small and place them \emph{to the right} of their associated dot (Hint: use \texttt{?text} for help).

\hypertarget{highlighting-certain-data-points}{%
\subsection*{Highlighting certain data points}\label{highlighting-certain-data-points}}
\addcontentsline{toc}{subsection}{Highlighting certain data points}

It can be helpful to highlight a certain data point (or group of data points) using a different dot size, format, or color.

\textbf{To highlight a single data point}, here is one approach you can take: first, plot all points, \emph{then} re-plot the point of interest using the \texttt{points()} function:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{lifespan }\SpecialCharTok{\textasciitilde{}}\NormalTok{ df}\SpecialCharTok{$}\NormalTok{gdp)}
\FunctionTok{points}\NormalTok{(}\AttributeTok{x=}\NormalTok{df}\SpecialCharTok{$}\NormalTok{gdp[}\DecValTok{5}\NormalTok{],}\AttributeTok{y=}\NormalTok{df}\SpecialCharTok{$}\NormalTok{lifespan[}\DecValTok{5}\NormalTok{],}\AttributeTok{col=}\StringTok{"red"}\NormalTok{,}\AttributeTok{pch=}\DecValTok{16}\NormalTok{,}\AttributeTok{cex=}\FloatTok{1.5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-123-1.pdf}

In this example, we re-plotted the data for the fifth row in the dataframe (in this case, China).

\textbf{To highlight a group of data points}, try this approach:

\begin{itemize}
\item
  First, create a vector that will contain the color for each data point.
\item
  Second, determine the color for each data point using a logical test.
\item
  Third, use your vector of colors within your \texttt{plot()} command.
\end{itemize}

For example, let's highlight all countries whose life expectancy is greater than 75.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# First}
\NormalTok{cols }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\StringTok{"grey"}\NormalTok{,}\AttributeTok{times=}\FunctionTok{length}\NormalTok{(lifespan)) }\CommentTok{\# create a vector of colors the length of vector \textasciigrave{}lifespan\textasciigrave{}}
\NormalTok{cols}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "grey" "grey" "grey" "grey" "grey" "grey" "grey"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Second}
\NormalTok{change\_these }\OtherTok{\textless{}{-}} \FunctionTok{which}\NormalTok{(lifespan }\SpecialCharTok{\textgreater{}} \DecValTok{75}\NormalTok{) }
\NormalTok{change\_these }\CommentTok{\# these are the elements that we want to highlight}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1 3 5 6
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cols[change\_these] }\OtherTok{\textless{}{-}} \StringTok{"red"}  \CommentTok{\# change the color for these elements to a highlight color}

\CommentTok{\# Third}
\FunctionTok{plot}\NormalTok{(lifespan }\SpecialCharTok{\textasciitilde{}}\NormalTok{ gdp,}\AttributeTok{pch=}\DecValTok{16}\NormalTok{,}\AttributeTok{col=}\NormalTok{cols,}\AttributeTok{log=}\StringTok{"x"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-124-1.pdf}

\hypertarget{exercise-6-1}{%
\subsubsection*{Exercise 6}\label{exercise-6-1}}
\addcontentsline{toc}{subsubsection}{Exercise 6}

Produce a plot of life expectancy as a function of GDP per capita, in which all countries with GDPs below \$10,000 have larger dots of a different color.

\hypertarget{building-a-plot-from-the-ground-up}{%
\subsection*{Building a plot from the ground up}\label{building-a-plot-from-the-ground-up}}
\addcontentsline{toc}{subsection}{Building a plot from the ground up}

In many applications it can be helpful to have complete control over the way your plot is built. To do so, you can build your plot from the very bottom up in multiple steps.

The steps for building up your own plot are as follows:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \textbf{Stage a blank canvas}: A plot begins with a blank canvas that covers a certain range of values for \texttt{x} and \texttt{y}. To stage a blank canvas, add this parameters to your \texttt{plot()} function: \texttt{type="n",\ axes=FALSE,\ ann=FALSE,\ xlim=c(\_\_,\ \_\_),\ ylim=c(\_\_,\ \_\_)"}. These commands tell \texttt{R} to plot a blank space, not to print axes, not to print annotations like x- or y-axis labels, and to limit your canvas to a certain coordinate range. Be sure to add numbers to the \texttt{xlim()} and \texttt{ylim()}commands.
\item
  \textbf{Add your axes}, if you want, using the function \texttt{axis()}. The command \texttt{axis(1)} prints the x-axis, and \texttt{axis(2)} prints the y-axis. This function allows you to define where tick marks occur and other details (see \texttt{?axis}).
\item
  \textbf{Add axis titles} using the function \texttt{title()}.
\item
  \textbf{Add reference lines}, if you want, using \texttt{abline()}. Do this before adding data, since it is usually nice for data points to be superimposed \emph{on top of} your reference lines.
\item
  \textbf{Add your data} using either \texttt{points()} or \texttt{lines()}.
\item
  \textbf{Add text labels}, if you want, using \texttt{text()}.
\end{enumerate}

Here is an example of this process:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 1. Stage a blank canvas}
\FunctionTok{par}\NormalTok{(}\AttributeTok{mar=}\FunctionTok{c}\NormalTok{(}\FloatTok{4.5}\NormalTok{,}\FloatTok{4.5}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{))}
\FunctionTok{plot}\NormalTok{(}\DecValTok{1}\NormalTok{,}\AttributeTok{type=}\StringTok{"n"}\NormalTok{,}\AttributeTok{axes=}\ConstantTok{FALSE}\NormalTok{,}\AttributeTok{ann=}\ConstantTok{FALSE}\NormalTok{,}\AttributeTok{xlim=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{100000}\NormalTok{),}\AttributeTok{ylim=}\FunctionTok{c}\NormalTok{(}\DecValTok{40}\NormalTok{,}\DecValTok{100}\NormalTok{))}

\CommentTok{\# 2. Add axes}
\FunctionTok{axis}\NormalTok{(}\DecValTok{1}\NormalTok{,}\AttributeTok{at=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{20000}\NormalTok{,}\DecValTok{40000}\NormalTok{,}\DecValTok{60000}\NormalTok{,}\DecValTok{80000}\NormalTok{,}\DecValTok{100000}\NormalTok{),}\AttributeTok{labels=}\FunctionTok{c}\NormalTok{(}\StringTok{"$0"}\NormalTok{, }\StringTok{"$20"}\NormalTok{,}\StringTok{"$40"}\NormalTok{,}\StringTok{"$60"}\NormalTok{,}\StringTok{"$80"}\NormalTok{,}\StringTok{"$100"}\NormalTok{))}
\FunctionTok{axis}\NormalTok{(}\DecValTok{2}\NormalTok{,}\AttributeTok{at=}\FunctionTok{seq}\NormalTok{(}\DecValTok{40}\NormalTok{,}\DecValTok{100}\NormalTok{,}\AttributeTok{by=}\DecValTok{10}\NormalTok{),}\AttributeTok{las=}\DecValTok{2}\NormalTok{)}

\CommentTok{\# 3. Add axis titles}
\FunctionTok{title}\NormalTok{(}\AttributeTok{xlab=}\StringTok{"Gross Domestic Product (GDP, in thousands) per Capita "}\NormalTok{,}\AttributeTok{cex.lab=}\NormalTok{.}\DecValTok{9}\NormalTok{)}
\FunctionTok{title}\NormalTok{(}\AttributeTok{ylab=}\StringTok{"Average Life Expectancy"}\NormalTok{,}\AttributeTok{cex.lab=}\NormalTok{.}\DecValTok{9}\NormalTok{)}

\CommentTok{\# 4. Add reference lines}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{h=}\DecValTok{70}\NormalTok{,}\AttributeTok{v=}\DecValTok{50000}\NormalTok{,}\AttributeTok{lty=}\DecValTok{3}\NormalTok{,}\AttributeTok{col=}\StringTok{"grey"}\NormalTok{)}

\CommentTok{\# 5. Add data}
\FunctionTok{points}\NormalTok{(}\AttributeTok{x=}\NormalTok{gdp,}\AttributeTok{y=}\NormalTok{lifespan,}\AttributeTok{pch=}\DecValTok{16}\NormalTok{,}\AttributeTok{col=}\StringTok{"firebrick"}\NormalTok{)}

\CommentTok{\# 6. Add text}
\FunctionTok{text}\NormalTok{(}\AttributeTok{x=}\NormalTok{gdp[}\DecValTok{6}\NormalTok{],}\AttributeTok{y=}\NormalTok{lifespan[}\DecValTok{6}\NormalTok{],}\AttributeTok{labels=}\StringTok{"Norway"}\NormalTok{,}\AttributeTok{pos=}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-125-1.pdf}

\hypertarget{review-assignment-5}{%
\section*{Review assignment}\label{review-assignment-5}}
\addcontentsline{toc}{section}{Review assignment}

\emph{NOTE: Under construction!}

\hypertarget{other-resources-5}{%
\section*{Other Resources}\label{other-resources-5}}
\addcontentsline{toc}{section}{Other Resources}

\hypertarget{packages}{%
\chapter{Packages}\label{packages}}

\hypertarget{learning-goals-6}{%
\section*{Learning goals}\label{learning-goals-6}}
\addcontentsline{toc}{section}{Learning goals}

\begin{itemize}
\tightlist
\item
  Learn what \texttt{R} packages are and why they are awesome.
\item
  Learn how to find and read about the packages installed on your machine.
\item
  Learn how to install \texttt{R} packages from \texttt{CRAN}.
\item
  Learn how to install \texttt{R} packages from \texttt{GitHub}.
\end{itemize}

Instructor tip!Here is some teacher content.

\hypertarget{introducing-r-packages}{%
\section*{\texorpdfstring{Introducing \texttt{R} packages}{Introducing R packages}}\label{introducing-r-packages}}
\addcontentsline{toc}{section}{Introducing \texttt{R} packages}

As established in the \textbf{Calling functions} module, \texttt{R} comes with hundreds of built-in base functions and datasets ready for use. You can also write your \emph{own} functions, which we will cover in an upcoming module.

You can also access thousands of other functions and datasets through bundles of external code known as \textbf{packages}. Packages are developed and shared by \texttt{R} users around the world -- a global community working together to increase \texttt{R}'s versatility and impact.

Some packages are designed to be broadly useful for almost any application, such as the packages you will be learning in this course (\texttt{ggplot}, \texttt{dplyr}, \texttt{stringr}, etc.). Such packages make it easier and more efficient to do your work with \texttt{R}.

Others are designed for niche problems that can be made much more doable with specialized functions or datasets. For example, the package \texttt{PBSmapping} contains shoreline, seafloor, and oceanographic datasets and custom mapping functions that make it easier for marine scientists at the Pacific Biological Station (PBS) in British Columbia, Canada, to carry out their work.

\hypertarget{finding-the-packages-already-on-your-computer}{%
\section*{Finding the packages already on your computer}\label{finding-the-packages-already-on-your-computer}}
\addcontentsline{toc}{section}{Finding the packages already on your computer}

In \texttt{RStudio}, look to the pane in the bottom right and click on the \emph{Packages} tab. You should see something like this:

\includegraphics{img/rstudio_packages.png}
This is displaying all the packages already installed in your system.

If you click on one of these packages (try the \texttt{base} package, for example), you will be taken to a list of all the functions and datasets contained within it.

\includegraphics{img/rstudio_base-package.png}

When you click on one of these functions, you will be taken to the help page for that function. This is the equivalent of typing \texttt{?\ \textless{}function\_name\textgreater{}} into the \emph{Console}.

\hypertarget{installing-a-new-package}{%
\section*{Installing a new package}\label{installing-a-new-package}}
\addcontentsline{toc}{section}{Installing a new package}

There are a couple ways to download and install a new \texttt{R} packae on your computer. Most packages are available from an open-source repository known as \texttt{CRAN} (which stands for Comprehensive \texttt{R} Archive Network). However, an increasingly common practice is to release packages on a public repository such as \texttt{GitHub}.

\hypertarget{installing-from-cran}{%
\subsection*{\texorpdfstring{Installing from \texttt{CRAN}}{Installing from CRAN}}\label{installing-from-cran}}
\addcontentsline{toc}{subsection}{Installing from \texttt{CRAN}}

You can install \texttt{CRAN} packages one of two ways:

\hypertarget{through-clicks}{%
\subsubsection*{Through clicks:}\label{through-clicks}}
\addcontentsline{toc}{subsubsection}{Through clicks:}

In \texttt{RStudio}, in the bottom-right pane, return to the \emph{Packages} tab. Click on the ``Install'' button.

\includegraphics{img/rstudio_install-package.png}

You can then search for the package you wish to install then click \textbf{Install}.

\hypertarget{through-code}{%
\subsubsection*{Through code:}\label{through-code}}
\addcontentsline{toc}{subsubsection}{Through code:}

You can download packages from the \emph{Console} using the \texttt{install.packages()} function.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{\textquotesingle{}fun\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Note that the package name must be in quotation marks.

\hypertarget{installing-from-github}{%
\subsection*{\texorpdfstring{Installing from \texttt{GitHub}}{Installing from GitHub}}\label{installing-from-github}}
\addcontentsline{toc}{subsection}{Installing from \texttt{GitHub}}

To install packages from \texttt{GitHub}, you must first download a \texttt{CRAN} package that makes it easy to do so:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"devtools"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Most packages on \texttt{GitHub} include instructions for downloading it on its \texttt{GitHub} page.

For example, visit \href{https://github.com/karthik/wesanderson}{this \texttt{GitHub} page} to see the documentation for the package \textbf{wesanderson}, which provides color palette themes based upon Wes Anderson's films. On this site, scroll down and you will find instructions for downloading the package. These instructions show you how to install this package from your \texttt{R} \emph{Console}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{devtools}\SpecialCharTok{::}\FunctionTok{install\_github}\NormalTok{(}\StringTok{"karthik/wesanderson"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Now go to your \emph{Packages} tab in the bottom-right pane of \texttt{RStudio}, scroll down to find the \textbf{wesanderson} package, and click on it to check out its functions.

\hypertarget{loading-an-installed-package}{%
\section*{Loading an installed package}\label{loading-an-installed-package}}
\addcontentsline{toc}{section}{Loading an installed package}

There is a difference between \emph{installed} and \emph{loaded} packages. Go back to your \emph{Packages} tab. Notice that some of the packages have a checked box next to their names, while others don't.

These checked boxes indicate which packages are currently \emph{loaded}. All packages in the list are \emph{installed} on your computer, but only the checked packages are \emph{loaded}, i.e., ready for use.

To load a package, use the \texttt{library()} function.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(fun)}
\FunctionTok{library}\NormalTok{(wesanderson)}
\end{Highlighting}
\end{Shaded}

Now that your new packages are loaded, you can actually use their functions.

\hypertarget{calling-functions-from-a-package}{%
\section*{Calling functions from a package}\label{calling-functions-from-a-package}}
\addcontentsline{toc}{section}{Calling functions from a package}

Most functions from external packages can be used by simply typing the name of the function. For example, the package \texttt{fun} contains a function for generating a random password:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{random\_password}\NormalTok{(}\AttributeTok{length=}\DecValTok{24}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "QVt61$H?N3hc5D#.W9~q)|GY"
\end{verbatim}

Sometimes, however, \texttt{R} can get confused if a new package contains a function that has the same name of some function from a different package. If \texttt{R} seems confused about a function you are calling, it can help to specify which package the function can be found in. This is done using the syntax \texttt{\textless{}package\_name\textgreater{}::\textless{}function\_name\textgreater{}}. For example, the following command is a fine alternative to the command above:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fun}\SpecialCharTok{::}\FunctionTok{random\_password}\NormalTok{(}\AttributeTok{length=}\DecValTok{24}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "vX~>u1$c@IZ9Bweb;EaO}`?,"
\end{verbatim}

Note that this was done in the example above using the \texttt{devtools} package.

\hypertarget{review-the-workflow-for-using-a-package}{%
\section*{Review: the workflow for using a package}\label{review-the-workflow-for-using-a-package}}
\addcontentsline{toc}{section}{Review: the workflow for using a package}

To review how to use functions from a non-base package in \texttt{R}, follow these steps (examples provided:)

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Install the package
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Example from CRAN}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"wesanderson"}\NormalTok{)}

\CommentTok{\# Example from GitHub}
\NormalTok{devtools}\SpecialCharTok{::}\FunctionTok{install\_github}\NormalTok{(}\StringTok{"karthik/wesanderson"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Load the package
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Example}
\FunctionTok{library}\NormalTok{(wesanderson)}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  Call the function.
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{wes\_palette}\NormalTok{(}\StringTok{"Royal1"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-136-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{wesanderson}\SpecialCharTok{::}\FunctionTok{wes\_palette}\NormalTok{(}\StringTok{"Zissou1"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-136-2.pdf}

\emph{(This function creates a plot displaying the different colors contained within the specified palette.)}

\hypertarget{a-note-on-package-dependencies}{%
\section*{A note on package dependencies}\label{a-note-on-package-dependencies}}
\addcontentsline{toc}{section}{A note on package dependencies}

Most packages contain functions that are built using functions built from other packages. Those new functions depend on the functions from those other packages, and that's why those other packages are known as \emph{dependencies}. When you install one function, you will notice that \texttt{R} typically has to install several other packages at the same time; these are the dependencies that allow the package of interest to function.

\hypertarget{a-note-on-package-versions}{%
\section*{A note on package versions}\label{a-note-on-package-versions}}
\addcontentsline{toc}{section}{A note on package versions}

Packages are updated regularly, and sometimes new versions can break the functions that use it as a dependency. Sometimes you may have to install a new version (\emph{or sometimes an older version!}) of a dependency in order to get your package of interest to work as desired.

\hypertarget{review-assignment-6}{%
\section*{Review assignment}\label{review-assignment-6}}
\addcontentsline{toc}{section}{Review assignment}

\emph{NOTE: Under construction!}

\hypertarget{other-resources-6}{%
\section*{Other Resources}\label{other-resources-6}}
\addcontentsline{toc}{section}{Other Resources}

\emph{NOTE: Under construction!}

\hypertarget{basics-of-ggplot}{%
\chapter{Basics of ggplot}\label{basics-of-ggplot}}

(Refer heavily to \url{https://ggplot2-book.org/introduction.html})

\hypertarget{learning-goals-7}{%
\section{Learning goals}\label{learning-goals-7}}

\begin{itemize}
\tightlist
\item
  Understand what \texttt{ggplot2} is and why it's used
\item
  Be able to think conceptually in the framework of the ``grammar of graphics''
\item
  Learn the syntax for creating different plots using using \texttt{ggplot2}
\end{itemize}

\hypertarget{what-is-ggplot}{%
\section{What is ggplot}\label{what-is-ggplot}}

\texttt{ggplot2} is an R package. It's one of the most downloaded packages in the R universe, and has become the gold standard for data visualization. It's extremely powerful and flexible, and allows for creating lots of visualizations of different types, ranging from maps to bare-bones academic publications, to complex, paneled charts with labeling, etc. Because the syntax is so different from ``base'' R, it can give the impression of having a somewhat steep learning curve. But in reality, because the principles are so conceptually simple, learning is fairly fast. Generally those who choose to learn it stick with it; that is, once you go gg, you don't go back.

\hypertarget{the-name-and-concept}{%
\section{The name and concept}\label{the-name-and-concept}}

``GG'' stands for ``grammar of graphics'', with ``grammar'' meaning ``the fundamental principles or rules of an art or science'' \citep{layered-grammar}. The most well-known ``grammar of graphics'' was written in 2005 and laid out some abstract principles for describing statistical graphics \citep{10.5555/1088896}. The basic idea is that all graphs can be described using a \emph{layered} grammar, and that all graphs have the same general elements\ldots{}

\begin{itemize}
\tightlist
\item
  data
\item
  geometric objects
\item
  aesthetics (mapping) of variables to objects
\end{itemize}

\ldots{} whereas some graphs have additional elements\ldots{}

\begin{itemize}
\tightlist
\item
  statistical transformations
\item
  scales
\item
  facets
\end{itemize}

\hypertarget{a-practical-example}{%
\section{A practical example}\label{a-practical-example}}

Let's get practical (we'll get back to the theory later).

First, let's read in some data on health from the World Bank:

Canvas
Canvas + variables (mapping)
Canvas + variables (mapping) + geometric objects

\hypertarget{learning-examples}{%
\section{Learning examples}\label{learning-examples}}

\hypertarget{perfecting-the-canvas}{%
\subsection{Perfecting the canvas}\label{perfecting-the-canvas}}

Adjust y / x limits

Add a different background

Change x / y labels

\hypertarget{aesthetic-attributes-of-the-geoms}{%
\subsection{Aesthetic attributes of the geoms}\label{aesthetic-attributes-of-the-geoms}}

A scatterplot

Add a line of best fit

Add title / subtitle / caption

\hypertarget{review-assignment-7}{%
\section{Review assignment:}\label{review-assignment-7}}

\emph{Note: Under construction!}

\hypertarget{other-resources-7}{%
\section{Other resources:}\label{other-resources-7}}

\emph{Note: Under construction!}

\hypertarget{part-working-with-data-in-r}{%
\part{Working with data in R}\label{part-working-with-data-in-r}}

\hypertarget{importing-data}{%
\chapter{Importing data}\label{importing-data}}

\hypertarget{learning-goals-8}{%
\section*{Learning goals}\label{learning-goals-8}}
\addcontentsline{toc}{section}{Learning goals}

\begin{itemize}
\tightlist
\item
  Understand what a \texttt{.csv} file is, and why they are important in data science.
\item
  How to format your data for easily importing data in \texttt{R}.\\
\item
  How to load, or ``read'', your data into \texttt{R}.\\
\item
  How to set up your project directory and read data from other folders.
\end{itemize}

~

To work with your own data in \texttt{R}, you need to load your data in \texttt{R}'s memory. This is called \textbf{reading in} your data.

Reading in data is simple and easy if your data are saved as a \textbf{\texttt{.csv}}, a comma-separated file. You can find functions for reading all sorts of file types into \texttt{R}, but the quickest way to begin working with your own data in \texttt{R} is to maintain that data in \texttt{.csv}'s.

\hypertarget{csv-files}{%
\section*{\texorpdfstring{\texttt{.csv} files}{.csv files}}\label{csv-files}}
\addcontentsline{toc}{section}{\texttt{.csv} files}

When you preview a \texttt{.csv}, it looks something like this:

\includegraphics{img/csv.png}
A neat spreadsheet of rows and columns.

When you open up this same dataset in a simple text editor, it looks like this:

\includegraphics{img/csv_text_editor.png}
This looks scary, but it is actually really simple. A \texttt{.csv} is a simple text file in which each row is on a new line and columns of data are separated by commas. As a simple text file, there is no fancy formatting. There are no ``Sheets'' or ``Tabs'', as you would find in GoogleSheets or Excel; it is a simple `flat' file.

One of the major advantages of working with \texttt{.csv}'s is that the format is cross-platform and non-proprietary. That is, they work on Windows, Mac, Linux, and any other common type of computer, and they do not require special software to open.

\hypertarget{data-format-requirements}{%
\section*{Data format requirements}\label{data-format-requirements}}
\addcontentsline{toc}{section}{Data format requirements}

For those of us used to working in \emph{Excel} or \emph{Numbers}, it will take some adjustment to get into the habit of formatting your data for \texttt{R}. We are used to seeing spreadsheets that look something like this:

\includegraphics{img/csv_dont.png}

To read a \texttt{.csv} into \texttt{R} without issues or fancy code, this spreadsheet will need to be simplified to look like this:

\includegraphics{img/csv_do.png}

\hypertarget{workflow-for-formatting-your-data}{%
\subsection*{Workflow for formatting your data}\label{workflow-for-formatting-your-data}}
\addcontentsline{toc}{subsection}{Workflow for formatting your data}

Below is the general worfklow for preparing your data for \texttt{R} is the following:

\textbf{1. Get your data into \texttt{.csv} format.} In \emph{Excel} and \emph{Numbers}, you can use `Save As' to change the file format. In \emph{GoogleSheets}, you can `Download As' a \texttt{.csv}. This will remove any colors, thick lines, special fonts, bold or italicized font styles, and any other special formatting. All that will be left is your data, and that's the way \texttt{R} likes it.

\textbf{2. Remove blank columns} before and in the middle of your data.

\textbf{3. Remove elements such as graphs.}

\textbf{4. Simplify your `header'.} The space above your data is your spreadsheet's header. It includes column names and metadata like title, author, measurement units, etc. It is possible to read data with complex headers into \texttt{R}, but again we are going for simplicity here, so we suggest (1) simplifying your header to contain column names only, and (2) moving metadata to a \texttt{README.txt} file that lives in the same folder as your data.

\textbf{5. Simplify column names.} Remove spaces, or replace them with \texttt{.}, \texttt{-} or \texttt{\_}. Make your column names as simple and brief as possible while still being informative. Include units in the column names, as in the screenshot above. Be sure that each column has a name.

\textbf{6. Remove all commas and hashtags from your dataset.} You can do this with the `Find \& Replace' feature built-into in most spreadsheet editors.

\hypertarget{reading-in-data}{%
\section*{Reading in data}\label{reading-in-data}}
\addcontentsline{toc}{section}{Reading in data}

The general workflow for reading in data is as follows:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  In \texttt{RStudio}, set your working directory.
\item
  Place your data file in your working directory. (See the section below if you want to keep your data somewhere else.)
\item
  In your \texttt{R} script, read in your data file with one of the core functions below.
\end{enumerate}

You can use this simple data file, \href{https://github.com/databrew/intro-to-data-science/blob/main/super_data.csv?raw=true}{\texttt{super\_data.csv}}, to practice.

\hypertarget{core-functions-for-reading-data}{%
\subsection*{Core functions for reading data}\label{core-functions-for-reading-data}}
\addcontentsline{toc}{subsection}{Core functions for reading data}

To become agile in reading various types of data into \texttt{R}, there are three key functions you should know:

\hypertarget{read.csv}{%
\subsubsection*{\texorpdfstring{\texttt{read.csv()}}{read.csv()}}\label{read.csv}}
\addcontentsline{toc}{subsubsection}{\texttt{read.csv()}}

This is the base function for reading in a \texttt{.csv}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"super\_data.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

This function reads in your data file as a dataframe. Save your dataset into \texttt{R}'s memory using a variable (in this case, \texttt{df}).

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  patient_id height_in weight_lb                   comment
1          1        74       135             not very nice
2          2        56       112                kinda cute
3          3        59       156 kinda cute but had a ring
4          4        43       102                 so small!
\end{verbatim}

The \texttt{read.csv()} function has plenty of other inputs in the event that your data file is unable to follow the formatting rules outlined above (see \texttt{?read.csv()}). The three most common inputs you may want to use are \texttt{header}, \texttt{skip}, and \texttt{stringsAsFactors}.

\begin{itemize}
\item
  Use the \textbf{\texttt{header}} input when your data does not contain column names. \emph{For example}, \texttt{header=FALSE} indicates that your datafile does not have any column names.
\item
  Use the \textbf{\texttt{skip}} input when you want to skip some lines of metadata at the top of your file. This is handy if you really don't want to get rid of your metadata in your header. \emph{For example,} \texttt{skip=2} skips the first two rows of the datafile before \texttt{R} begins reading data.
\item
  Use the \textbf{\texttt{stringsAsFactors}} input when you want to make absolutely sure that \texttt{R} interprets any non-numeric fields as characters rather than factors. We have not focused on factors yet, but it can be frustrating when \texttt{R} mistakes a column of character strings as a column factors. To avoid any possible confusion, use \texttt{stringsAsFactors=TRUE} as an input.
\end{itemize}

For example, here is how to read in this data without column names:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"super\_data.csv"}\NormalTok{,}\AttributeTok{skip=}\DecValTok{1}\NormalTok{,}\AttributeTok{header=}\ConstantTok{FALSE}\NormalTok{)}
\NormalTok{df}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  V1 V2  V3                        V4
1  1 74 135             not very nice
2  2 56 112                kinda cute
3  3 59 156 kinda cute but had a ring
4  4 43 102                 so small!
\end{verbatim}

If you do this without setting header to FALSE, your first row of data gets used as column names and it becomes a big ole mess:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"super\_data.csv"}\NormalTok{,}\AttributeTok{skip=}\DecValTok{1}\NormalTok{)}
\NormalTok{df}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  X1 X74 X135             not.very.nice
1  2  56  112                kinda cute
2  3  59  156 kinda cute but had a ring
3  4  43  102                 so small!
\end{verbatim}

\hypertarget{readrread_csv}{%
\subsubsection*{\texorpdfstring{\texttt{readr::read\_csv()}}{readr::read\_csv()}}\label{readrread_csv}}
\addcontentsline{toc}{subsubsection}{\texttt{readr::read\_csv()}}

This function, from a package named \texttt{readr}, becomes useful when you begin working with (1) data within the \texttt{tidyverse}, which you will be introduced to in the next module, and/or (2) very large datasete, since it reads data much more quickly and provides progress updates along the way.

When you use \texttt{read\_csv()} instead of \texttt{read.csv()}, your data are read in as a \texttt{tibble} instead of a dataframe. You will be introduced to \texttt{tibbles} in the next module on dataframes; for the time being, think of a \texttt{tibble} as a fancy version of a dataframe that can be treated exactly as a regular dataframe.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ readr}\SpecialCharTok{::}\FunctionTok{read\_csv}\NormalTok{(}\StringTok{"super\_data.csv"}\NormalTok{)}
\NormalTok{df}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 4 x 4
  patient_id height_in weight_lb comment                  
       <dbl>     <dbl>     <dbl> <chr>                    
1          1        74       135 not very nice            
2          2        56       112 kinda cute               
3          3        59       156 kinda cute but had a ring
4          4        43       102 so small!                
\end{verbatim}

\hypertarget{readrds}{%
\subsubsection*{\texorpdfstring{\texttt{readRDS()}}{readRDS()}}\label{readrds}}
\addcontentsline{toc}{subsubsection}{\texttt{readRDS()}}

Another niche function for reading data is \texttt{readRDS()}. This function allows you to read in \emph{R data objects}, which have the file extension \emph{.rds}. These data objects need not be in the same format as a \texttt{.csv} or even a dataframe, and that is what makes them so handy. A colleague could send you an \texttt{.rds} object of a vector, a list, a plotting function, or any other kind of \texttt{R} object, and you can read it in with \texttt{readRDS()}.

For example, \href{https://github.com/databrew/intro-to-data-science/blob/main/super_data.rds?raw=true}{\texttt{super\_data.rds}} contains a \texttt{tibble} version of the dataframe above. When you read in that \texttt{.rds} file, it is already formatted as a \texttt{tibble}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{readRDS}\NormalTok{(}\StringTok{"super\_data.rds"}\NormalTok{)}
\NormalTok{df}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 4 x 4
  patient_id height_in weight_lb comment                  
       <dbl>     <dbl>     <dbl> <chr>                    
1          1        74       135 not very nice            
2          2        56       112 kinda cute               
3          3        59       156 kinda cute but had a ring
4          4        43       102 so small!                
\end{verbatim}

\hypertarget{reading-data-from-other-folders}{%
\subsection*{Reading data from other folders}\label{reading-data-from-other-folders}}
\addcontentsline{toc}{subsection}{Reading data from other folders}

The data-reading functions above require only a single input: the \emph{path} to your data file. This \emph{path} is relative to the location of your working directory. When your data file is \emph{inside} your working directory, the path simplifies to be the same as the filename of your data:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"super\_data.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Sometimes, though, you will want to keep your data somewhere nearby but not necessarily \emph{within} your working directory. Consider the following scenario, in which three versions of the ``super\_data.csv'' dataset occur near a working directory being used for this module:

\includegraphics{img/csv_wd.png}

We have a version within the same directory as our \texttt{R} file (i.e., our working directory), another version within a \emph{child} folder within the directory (i.e., a subfolder), and another version in the \emph{parent} folder of the working directory.

\textbf{To read a file from a \emph{child} folder,} add the prefix, \texttt{./\textless{}child\ name\textgreater{}/}, to your command:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"./data/super\_data.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\textbf{To read a file from a \emph{parent} folder,} add the prefix, \texttt{../}, to your command:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"./data/super\_data.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{managing-files}{%
\subsection*{Managing files}\label{managing-files}}
\addcontentsline{toc}{subsection}{Managing files}

Now consider the following scenario, in which your project folder structure looks like this:

\includegraphics{img/project_template.png}

This structure can be a effective and simple way of organizing your files for a project, and we recommend using it.

Here's what these child folders should contain.

\begin{itemize}
\tightlist
\item
  \texttt{./data/} contains data, of course.
\item
  \texttt{./doc/} contains documents, such as manuscript drafts.
\item
  \texttt{./figures/} contains files for graphs and figures.
\item
  \texttt{./R/} contains \texttt{R} scripts, of course.
\item
  \texttt{./references/} contains journal articles and other resources you are using in your research.
\end{itemize}

Since your \texttt{R} code is going into the \texttt{R} child folder, that is what you should set your working directory for those \texttt{R} scripts to. In that case, \emph{how to read data from the \texttt{data} folder}, which is a separate child folder of your parent folder?

Here's how:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"../data/super\_data.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{review-exercise}{%
\section*{Review exercise}\label{review-exercise}}
\addcontentsline{toc}{section}{Review exercise}

\emph{NOTE: Under construction!}

\hypertarget{dataframes}{%
\chapter{Dataframes}\label{dataframes}}

\hypertarget{learning-goals-9}{%
\section*{Learning goals}\label{learning-goals-9}}
\addcontentsline{toc}{section}{Learning goals}

\begin{itemize}
\tightlist
\item
  Practice exploring, summarizing, and filtering dataframes
\item
  Understand the importance of \emph{tidy} datasets
\item
  Understand what the \texttt{tidyverse} is and why it is awesome.
\end{itemize}

~

In data science, the most common data structure you will be using -- by far -- is the \textbf{dataframe}. You were introduced to this data structure in Module 10, but a more familiar and detailed orientation is worthwhile.

\hypertarget{subsetting-exploring-dataframes}{%
\section*{Subsetting \& exploring dataframes}\label{subsetting-exploring-dataframes}}
\addcontentsline{toc}{section}{Subsetting \& exploring dataframes}

To explore dataframes, let's use a dataset on fuel mileage for all cars sold from 1985 to 2014.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(fueleconomy)}
\FunctionTok{data}\NormalTok{(vehicles)}
\FunctionTok{head}\NormalTok{(vehicles)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 6 x 12
     id make  model    year class   trans  drive     cyl displ fuel    hwy   cty
  <dbl> <chr> <chr>   <dbl> <chr>   <chr>  <chr>   <dbl> <dbl> <chr> <dbl> <dbl>
1 13309 Acura 2.2CL/~  1997 Subcom~ Autom~ Front-~     4   2.2 Regu~    26    20
2 13310 Acura 2.2CL/~  1997 Subcom~ Manua~ Front-~     4   2.2 Regu~    28    22
3 13311 Acura 2.2CL/~  1997 Subcom~ Autom~ Front-~     6   3   Regu~    26    18
4 14038 Acura 2.3CL/~  1998 Subcom~ Autom~ Front-~     4   2.3 Regu~    27    19
5 14039 Acura 2.3CL/~  1998 Subcom~ Manua~ Front-~     4   2.3 Regu~    29    21
6 14040 Acura 2.3CL/~  1998 Subcom~ Autom~ Front-~     6   3   Regu~    26    17
\end{verbatim}

A dataframe has rows of data organized into columns. In this dataframe, each row pertains to a single vehicle make/model -- i.e., a single \emph{observation}. Each column pertains to a single \emph{type} of data. Columns are named in the \emph{header} of the dataframe.

All the same useful exploration and subsetting functions that applied to vectors now apply to dataframes (see module 10 for a refreshers). In addition to those functions you already know, we've added some new functions to your inventory of useful functions.

\hypertarget{exploration}{%
\subsection*{Exploration}\label{exploration}}
\addcontentsline{toc}{subsection}{Exploration}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{tail}\NormalTok{(vehicles) }\CommentTok{\# head() and tail() summarize the beginning and end of the object}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 6 x 12
     id make  model    year class   trans   drive    cyl displ fuel    hwy   cty
  <dbl> <chr> <chr>   <dbl> <chr>   <chr>   <chr>  <dbl> <dbl> <chr> <dbl> <dbl>
1 28868 Yugo  GV Plu~  1990 Minico~ Manual~ Front~     4   1.3 Regu~    27    21
2  6635 Yugo  GV Plu~  1990 Subcom~ Manual~ Front~     4   1.3 Regu~    28    23
3  3157 Yugo  GV/GVX   1987 Subcom~ Manual~ Front~     4   1.1 Regu~    29    24
4  5497 Yugo  GV/GVX   1989 Subcom~ Manual~ Front~     4   1.1 Regu~    29    24
5  5498 Yugo  GV/GVX   1989 Subcom~ Manual~ Front~     4   1.3 Regu~    28    23
6  1745 Yugo  Gy/yug~  1986 Minico~ Manual~ Front~     4   1.1 Regu~    29    22
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{names}\NormalTok{(vehicles) }\CommentTok{\# get names of columns}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1] "id"    "make"  "model" "year"  "class" "trans" "drive" "cyl"   "displ"
[10] "fuel"  "hwy"   "cty"  
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{nrow}\NormalTok{(vehicles) }\CommentTok{\# get number of rows}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 33442
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ncol}\NormalTok{(vehicles) }\CommentTok{\# get number of columns}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 12
\end{verbatim}

Note that \texttt{length()} does not work the same on dataframes as it does with vectors. In dataframes, \texttt{length()} is the equivalent of \texttt{ncol()}; it will \emph{not} give you the number of rows in a dataset.

\hypertarget{subsetting}{%
\subsection*{Subsetting}\label{subsetting}}
\addcontentsline{toc}{subsection}{Subsetting}

Recall that dataframes are filtered by row and/or column using this format: \textbf{\texttt{dataframe{[}rows,columns{]}}}. To get the third element of the second column, for example, you type \texttt{dataframe{[}3,2{]}}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vehicles[}\DecValTok{3}\NormalTok{,}\DecValTok{2}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 1 x 1
  make 
  <chr>
1 Acura
\end{verbatim}

Note that the comma is necessary even if you do not want to specify columns. If you try to type this \ldots{}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vehicles[}\DecValTok{3}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\ldots{}\texttt{R} will assume you are asking for the third column, not the third row.

To filter a dataframe to multiple values, you can specify vectors for the \texttt{row} and \texttt{column}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vehicles[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{,}\DecValTok{11}\SpecialCharTok{:}\DecValTok{12}\NormalTok{] }\CommentTok{\# can use colons}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 3 x 2
    hwy   cty
  <dbl> <dbl>
1    26    20
2    28    22
3    26    18
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vehicles[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{,}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{11}\SpecialCharTok{:}\DecValTok{12}\NormalTok{)]  }\CommentTok{\# can use c()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 3 x 3
     id   hwy   cty
  <dbl> <dbl> <dbl>
1 13309    26    20
2 13310    28    22
3 13311    26    18
\end{verbatim}

Columns can also be called according to their names. Use the \textbf{\texttt{\$}} sign to specify a column.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vehicles}\SpecialCharTok{$}\NormalTok{hwy[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 26 28 26 27 29
\end{verbatim}

Note that when you use a \texttt{\$}, you will not need to use a comma within your brackets. If you try to run this \ldots{}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vehicles}\SpecialCharTok{$}\NormalTok{hwy[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{,]}
\end{Highlighting}
\end{Shaded}

\ldots{}\texttt{R} will throw a fit.

You can use logical tests to filter dataframes to rows that meet certain conditions. For example, to filter to only the rows for cars with better than 100 mpg, you can use this syntax:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{keeps }\OtherTok{\textless{}{-}} \FunctionTok{which}\NormalTok{(vehicles}\SpecialCharTok{$}\NormalTok{hwy }\SpecialCharTok{\textgreater{}} \DecValTok{100}\NormalTok{)}
\NormalTok{keeps}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1]  6533 10613 10614 16429 16430 24487 24488 24489 28628
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vehicles[keeps,]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 9 x 12
     id make   model   year class   trans   drive    cyl displ fuel    hwy   cty
  <dbl> <chr>  <chr>  <dbl> <chr>   <chr>   <chr>  <dbl> <dbl> <chr> <dbl> <dbl>
1 33640 Chevr~ Spark~  2014 Subcom~ Automa~ Front~    NA    NA Elec~   109   128
2 33396 Fiat   500e    2013 Minico~ Automa~ Front~    NA    NA Elec~   108   122
3 34392 Fiat   500e    2014 Minico~ Automa~ Front~    NA    NA Elec~   108   122
4 33265 Honda  Fit EV  2013 Small ~ Automa~ Front~    NA    NA Elec~   105   132
5 33905 Honda  Fit EV  2014 Small ~ Automa~ Front~    NA    NA Elec~   105   132
6 33558 Nissan Leaf    2013 Midsiz~ Automa~ Front~    NA    NA Elec~   102   129
7 34699 Nissan Leaf    2014 Midsiz~ Automa~ Front~    NA    NA Elec~   101   126
8 34918 Nissan Leaf    2015 Midsiz~ Automa~ Front~    NA    NA Elec~   101   126
9 33307 Scion  iQ EV   2013 Minico~ Automa~ Front~    NA    NA Elec~   105   138
\end{verbatim}

But the above is a long-winded way of doing this. You can also achieve this result as follows:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vehicles[}\FunctionTok{which}\NormalTok{(vehicles}\SpecialCharTok{$}\NormalTok{hwy }\SpecialCharTok{\textgreater{}} \DecValTok{100}\NormalTok{),]}
\end{Highlighting}
\end{Shaded}

You can also get the same result without the \texttt{which()} function:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vehicles[vehicles}\SpecialCharTok{$}\NormalTok{hwy }\SpecialCharTok{\textgreater{}} \DecValTok{100}\NormalTok{,]}
\end{Highlighting}
\end{Shaded}

The logical test is returning a bunch of \texttt{TRUE}s and \texttt{FALSE}s, one for each row of \texttt{vehicles}. Only the \texttt{TRUE} rows will be returned.

\hypertarget{exercise-1-reading-for-errors}{%
\subsubsection*{Exercise 1: Reading for errors}\label{exercise-1-reading-for-errors}}
\addcontentsline{toc}{subsubsection}{Exercise 1: Reading for errors}

What is wrong with these commands? Why will each of them throw an error if you run them, and how can you fix them?

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 1}
\NormalTok{vehicles[}\DecValTok{1}\NormalTok{,}\DecValTok{15}\NormalTok{,]}

\CommentTok{\# 2}
\NormalTok{vecihles[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{,]}

\CommentTok{\# 3}
\NormalTok{vehicles}\SpecialCharTok{$}\NormalTok{hwy[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{,]}

\CommentTok{\# 4}
\NormalTok{vehicles[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{,}\DecValTok{1}\SpecialCharTok{:}\DecValTok{13}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\hypertarget{summarizing}{%
\subsection*{Summarizing}\label{summarizing}}
\addcontentsline{toc}{subsection}{Summarizing}

The same summary functions that you have used for vectors work for dataframes, such as:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{min}\NormalTok{(vehicles}\SpecialCharTok{$}\NormalTok{hwy)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 9
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{max}\NormalTok{(vehicles}\SpecialCharTok{$}\NormalTok{hwy)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 109
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(vehicles}\SpecialCharTok{$}\NormalTok{cty)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 17.491
\end{verbatim}

You can also use the \textbf{\texttt{summary()}} function, which provides summary statistics for each column in your dataframe:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(vehicles)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
       id            make              model                year     
 Min.   :    1   Length:33442       Length:33442       Min.   :1984  
 1st Qu.: 8361   Class :character   Class :character   1st Qu.:1991  
 Median :16724   Mode  :character   Mode  :character   Median :1999  
 Mean   :17038                                         Mean   :1999  
 3rd Qu.:25265                                         3rd Qu.:2008  
 Max.   :34932                                         Max.   :2015  
                                                                     
    class              trans              drive                cyl        
 Length:33442       Length:33442       Length:33442       Min.   : 2.000  
 Class :character   Class :character   Class :character   1st Qu.: 4.000  
 Mode  :character   Mode  :character   Mode  :character   Median : 6.000  
                                                          Mean   : 5.772  
                                                          3rd Qu.: 6.000  
                                                          Max.   :16.000  
                                                          NA's   :58      
     displ           fuel                hwy              cty        
 Min.   :0.000   Length:33442       Min.   :  9.00   Min.   :  6.00  
 1st Qu.:2.300   Class :character   1st Qu.: 19.00   1st Qu.: 15.00  
 Median :3.000   Mode  :character   Median : 23.00   Median : 17.00  
 Mean   :3.353                      Mean   : 23.55   Mean   : 17.49  
 3rd Qu.:4.300                      3rd Qu.: 27.00   3rd Qu.: 20.00  
 Max.   :8.400                      Max.   :109.00   Max.   :138.00  
 NA's   :57                                                          
\end{verbatim}

The function \textbf{\texttt{unique()}} returns unique values within a column:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{unique}\NormalTok{(vehicles}\SpecialCharTok{$}\NormalTok{fuel)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1] "Regular"                     "Premium"                    
 [3] "Diesel"                      "Premium or E85"             
 [5] "Electricity"                 "Gasoline or E85"            
 [7] "Premium Gas or Electricity"  "Gasoline or natural gas"    
 [9] "CNG"                         "Midgrade"                   
[11] "Regular Gas and Electricity" "Gasoline or propane"        
[13] "Premium and Electricity"    
\end{verbatim}

Finally, the \textbf{\texttt{order()}} function helps you sort a dataframe according to the values in one of its columns.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vehicles\_sorted }\OtherTok{\textless{}{-}}\NormalTok{ vehicles[}\FunctionTok{order}\NormalTok{(vehicles}\SpecialCharTok{$}\NormalTok{hwy),  }\CommentTok{\#sort dataframe by highway mileage}
                            \FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{10}\SpecialCharTok{:}\DecValTok{12}\NormalTok{)] }\CommentTok{\# only keep certain columns}
\FunctionTok{head}\NormalTok{(vehicles\_sorted)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 6 x 6
  make         model                   year fuel      hwy   cty
  <chr>        <chr>                  <dbl> <chr>   <dbl> <dbl>
1 Aston Martin Lagonda                 1985 Regular     9     7
2 Aston Martin Lagonda                 1985 Regular     9     7
3 Aston Martin Saloon/Vantage/Volante  1985 Regular     9     7
4 Aston Martin Saloon/Vantage/Volante  1985 Regular     9     7
5 Rolls-Royce  Camargue                1987 Regular     9     7
6 Rolls-Royce  Continental             1987 Regular     9     7
\end{verbatim}

Reverse the order by wrapping \textbf{\texttt{rev()}} around the \texttt{order()} call:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vehicles\_sorted }\OtherTok{\textless{}{-}}\NormalTok{ vehicles[}\FunctionTok{rev}\NormalTok{(}\FunctionTok{order}\NormalTok{(vehicles}\SpecialCharTok{$}\NormalTok{hwy)),}
                            \FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{10}\SpecialCharTok{:}\DecValTok{12}\NormalTok{)]}
\FunctionTok{head}\NormalTok{(vehicles\_sorted)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 6 x 6
  make      model     year fuel          hwy   cty
  <chr>     <chr>    <dbl> <chr>       <dbl> <dbl>
1 Chevrolet Spark EV  2014 Electricity   109   128
2 Fiat      500e      2014 Electricity   108   122
3 Fiat      500e      2013 Electricity   108   122
4 Scion     iQ EV     2013 Electricity   105   138
5 Honda     Fit EV    2014 Electricity   105   132
6 Honda     Fit EV    2013 Electricity   105   132
\end{verbatim}

\hypertarget{building-dataframes}{%
\subsection*{Building dataframes}\label{building-dataframes}}
\addcontentsline{toc}{subsection}{Building dataframes}

To create a new dataframe, use the \texttt{data.frame()} function.

\begin{verbatim}
             car mgp_hwy mpg_city
100 Acura Legend      23       15
101 Acura Legend      22       17
102 Acura Legend      23       16
103 Acura Legend      21       16
104 Acura Legend      22       17
105 Acura Legend      23       16
106 Acura Legend      24       16
\end{verbatim}

Note how the columns were named in the \texttt{data.frame()} call, and that each column is separated by a comma.

You can also stage an empty dataframe, which sounds useless but will become very useful as you start working with \texttt{for} loops and other higher-order \texttt{R} tools.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{()}
\NormalTok{df}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
data frame with 0 columns and 0 rows
\end{verbatim}

To coerce an object into a format that \texttt{R} interprets as a dataframe, use \textbf{\texttt{as.dataframe()}}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(vehicles)}
\NormalTok{df[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{4}\NormalTok{,}\DecValTok{1}\SpecialCharTok{:}\DecValTok{4}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
     id  make       model year
1 13309 Acura 2.2CL/3.0CL 1997
2 13310 Acura 2.2CL/3.0CL 1997
3 13311 Acura 2.2CL/3.0CL 1997
4 14038 Acura 2.3CL/3.0CL 1998
\end{verbatim}

You can bind multiple dataframes together using \textbf{\texttt{rbind()}}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df1 }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{name=}\FunctionTok{c}\NormalTok{(}\StringTok{"Ben"}\NormalTok{,}\StringTok{"Joe"}\NormalTok{,}\StringTok{"Eric"}\NormalTok{,}\StringTok{"Isabelle"}\NormalTok{),}\AttributeTok{instrument=}\FunctionTok{c}\NormalTok{(}\StringTok{"Nose harp"}\NormalTok{,}\StringTok{"Concertina"}\NormalTok{,}\StringTok{"Ukelele"}\NormalTok{,}\StringTok{"Drums"}\NormalTok{))}
\NormalTok{df1}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
      name instrument
1      Ben  Nose harp
2      Joe Concertina
3     Eric    Ukelele
4 Isabelle      Drums
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df2 }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{name=}\FunctionTok{c}\NormalTok{(}\StringTok{"Matthew"}\NormalTok{),}\AttributeTok{instrument=}\FunctionTok{c}\NormalTok{(}\StringTok{"Washboard"}\NormalTok{))}
\FunctionTok{rbind}\NormalTok{(df1,df2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
      name instrument
1      Ben  Nose harp
2      Joe Concertina
3     Eric    Ukelele
4 Isabelle      Drums
5  Matthew  Washboard
\end{verbatim}

Note that to be combined, two dataframes have to have the exact same number of columns and the exact same column names.

The only exception to this is adding a dataframe with content an empty dataframe. That can work, and that will be helpful in the \emph{\texttt{R} Toolbag} modules ahead.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{() }\CommentTok{\# stage empty dataframe}
\NormalTok{df1 }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{name=}\FunctionTok{c}\NormalTok{(}\StringTok{"Ben"}\NormalTok{,}\StringTok{"Joe"}\NormalTok{,}\StringTok{"Eric"}\NormalTok{,}\StringTok{"Isabelle"}\NormalTok{),}\AttributeTok{instrument=}\FunctionTok{c}\NormalTok{(}\StringTok{"Nose harp"}\NormalTok{,}\StringTok{"Concertina"}\NormalTok{,}\StringTok{"Ukelele"}\NormalTok{,}\StringTok{"Drums"}\NormalTok{))}
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{rbind}\NormalTok{(df,df1)}
\NormalTok{df}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
      name instrument
1      Ben  Nose harp
2      Joe Concertina
3     Eric    Ukelele
4 Isabelle      Drums
\end{verbatim}

\hypertarget{exercise-2-subsetting-and-filtering}{%
\subsection*{Exercise 2: Subsetting and filtering}\label{exercise-2-subsetting-and-filtering}}
\addcontentsline{toc}{subsection}{Exercise 2: Subsetting and filtering}

\textbf{A. Subset one field according to a logical test}\\
With no more than two lines of code, get the number of Honda cars in the \texttt{vehicles} dataset.

\textbf{B. Subset one field according to a logical test for a different field.}\\
In a single line of code, show the mileages of all the Toyotas in the dataset.

\textbf{C. Subset a dataframe to a single subgroup}\\
In a single line of code, determine how many differet car makes/models were produced in 1995.

\textbf{D. Get the mean value for a subgroup of data}\\
What is the average city mileage for Subaru cars in the dataset?

\textbf{E. Subset a dataframe to only data from between two values}\\
According to this dataset, how many different car makes/models have been produced with highway mileages between 30 and 40 mpg?

\hypertarget{tidy-data}{%
\section*{Tidy data}\label{tidy-data}}
\addcontentsline{toc}{section}{Tidy data}

\emph{(Joe writes the remainder of this chapter)}

\url{https://r4ds.had.co.nz/tidy-data.html}

\hypertarget{tibbles}{%
\subsection*{Tibbles}\label{tibbles}}
\addcontentsline{toc}{subsection}{Tibbles}

\emph{NOTE: Under construction!}

\hypertarget{tidyverse}{%
\subsection*{Tidyverse}\label{tidyverse}}
\addcontentsline{toc}{subsection}{Tidyverse}

\emph{NOTE: Under construction!}

\hypertarget{review-exercise-1}{%
\section*{Review exercise}\label{review-exercise-1}}
\addcontentsline{toc}{section}{Review exercise}

\emph{NOTE: Under construction!}

\hypertarget{data-wrangling}{%
\chapter{Data wrangling}\label{data-wrangling}}

\hypertarget{data-transformation}{%
\section{Data transformation}\label{data-transformation}}

\hypertarget{more-filtering}{%
\subsection{More filtering}\label{more-filtering}}

\hypertarget{grouping}{%
\subsection{Grouping}\label{grouping}}

\hypertarget{joining}{%
\subsection{Joining}\label{joining}}

\hypertarget{mutating}{%
\subsection{Mutating}\label{mutating}}

\hypertarget{exporting-data-plots}{%
\chapter{Exporting data \& plots}\label{exporting-data-plots}}

\hypertarget{learning-goals-10}{%
\section*{Learning goals}\label{learning-goals-10}}
\addcontentsline{toc}{section}{Learning goals}

\begin{itemize}
\tightlist
\item
  How to save dataframes as \texttt{.csv}'s
\item
  How to save \texttt{R} data objects as \texttt{.rds}'s
\item
  How to save plots as \texttt{.pdf}'s and \texttt{.png}'s.
\end{itemize}

~

To practice exporting data, let's use the built-in dataset from package \texttt{babynames}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"babynames"}\NormalTok{)}
\FunctionTok{library}\NormalTok{(babynames)}
\FunctionTok{data}\NormalTok{(babynames)}
\end{Highlighting}
\end{Shaded}

\hypertarget{write.csv}{%
\section*{\texorpdfstring{\texttt{write.csv()}}{write.csv()}}\label{write.csv}}
\addcontentsline{toc}{section}{\texttt{write.csv()}}

To write a dataframe to a \texttt{.csv}, use the function \texttt{write.csv()}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{write.csv}\NormalTok{(babynames,}\AttributeTok{file=}\StringTok{"my\_babynames.csv"}\NormalTok{,}\AttributeTok{quote=}\ConstantTok{FALSE}\NormalTok{,}\AttributeTok{row.names=}\ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

This dataset will be saved as the file, \texttt{my\_babynames.csv} within your parent directory. You can set other destinations using the same rules for child paths, parent paths, and absolute paths from the module on \textbf{Importing Data}.

The code above sets a couple parameters that preserves the neat formatting of your dataframe. We recommend using these inputs each time you use \texttt{write.csv()} to save a dataframe.

\hypertarget{saverds}{%
\section*{\texorpdfstring{\texttt{saveRDS()}}{saveRDS()}}\label{saverds}}
\addcontentsline{toc}{section}{\texttt{saveRDS()}}

The \texttt{saveRDS()} function saves \texttt{R} objects in the \texttt{.rds} format, which makes them easier and faster to read into \texttt{R} later on.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{saveRDS}\NormalTok{(babynames,}\AttributeTok{file=}\StringTok{"my\_babynames.rds"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{pdf-and-png}{%
\section*{\texorpdfstring{\texttt{pdf()} and \texttt{png()}}{pdf() and png()}}\label{pdf-and-png}}
\addcontentsline{toc}{section}{\texttt{pdf()} and \texttt{png()}}

Let's say you want to plot the prevalence of the name ``Barack'' in recent U.S history:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(babynames)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 6 x 5
   year sex   name          n   prop
  <dbl> <chr> <chr>     <int>  <dbl>
1  1880 F     Mary       7065 0.0724
2  1880 F     Anna       2604 0.0267
3  1880 F     Emma       2003 0.0205
4  1880 F     Elizabeth  1939 0.0199
5  1880 F     Minnie     1746 0.0179
6  1880 F     Margaret   1578 0.0162
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{baracks }\OtherTok{\textless{}{-}}\NormalTok{ babynames[babynames}\SpecialCharTok{$}\NormalTok{name}\SpecialCharTok{==}\StringTok{"Barack"}\NormalTok{,]}
\FunctionTok{plot}\NormalTok{(prop}\SpecialCharTok{\textasciitilde{}}\NormalTok{year,}\AttributeTok{data=}\NormalTok{baracks,}
     \AttributeTok{type=}\StringTok{"b"}\NormalTok{,}\AttributeTok{pch=}\DecValTok{16}\NormalTok{,}
     \AttributeTok{xlim=}\FunctionTok{c}\NormalTok{(}\DecValTok{2000}\NormalTok{,}\DecValTok{2018}\NormalTok{),}
     \AttributeTok{xlab=}\StringTok{"Year"}\NormalTok{,}\AttributeTok{ylab=}\StringTok{"Proportion of names"}\NormalTok{,}\AttributeTok{main=}\StringTok{"Barack"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-173-1.pdf}

To save this as a figure as a \texttt{pdf}, preface these lines of code with a \texttt{pdf()} command and add \texttt{dev.off()} below those lines. This opens up a \texttt{pdf} `device' (i.e., an engine for creating a PDF file), prints the plot to that new file, then closes the device and saves the file.

Saving a pdf:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{pdf}\NormalTok{(}\StringTok{"barack{-}years.pdf"}\NormalTok{,width}\DecValTok{{-}6}\NormalTok{,}\AttributeTok{height=}\DecValTok{4}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(prop}\SpecialCharTok{\textasciitilde{}}\NormalTok{year,}\AttributeTok{data=}\NormalTok{baracks,}
     \AttributeTok{type=}\StringTok{"b"}\NormalTok{,}\AttributeTok{pch=}\DecValTok{16}\NormalTok{,}
     \AttributeTok{xlim=}\FunctionTok{c}\NormalTok{(}\DecValTok{2000}\NormalTok{,}\DecValTok{2018}\NormalTok{),}
     \AttributeTok{xlab=}\StringTok{"Year"}\NormalTok{,}\AttributeTok{ylab=}\StringTok{"Proportion of names"}\NormalTok{,}\AttributeTok{main=}\StringTok{"Barack"}\NormalTok{)}
\FunctionTok{dev.off}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

Make sure you add `.pdf' to the end of your filename, and try not to run the \texttt{dev.off()} command when you have not first run the \texttt{pdf} command. If you do, \texttt{R} will think you are turning off the plotting feature in \texttt{RStudio} and you will have to restart your \texttt{R} session in order to see any more plots.

\hypertarget{review-exercise-2}{%
\section*{Review exercise}\label{review-exercise-2}}
\addcontentsline{toc}{section}{Review exercise}

\emph{NOTE: Under construction!}

\hypertarget{part-exploring-analyzing-data}{%
\part{Exploring \& analyzing data}\label{part-exploring-analyzing-data}}

\hypertarget{exploratory-data-analysis}{%
\chapter{Exploratory Data Analysis}\label{exploratory-data-analysis}}

\hypertarget{exploring-distributions}{%
\section{Exploring distributions}\label{exploring-distributions}}

\hypertarget{variable-types-statistics}{%
\section{Variable types \& statistics}\label{variable-types-statistics}}

\hypertarget{descriptive-statistics}{%
\section{Descriptive statistics}\label{descriptive-statistics}}

\hypertarget{significance-statistics}{%
\chapter{Significance statistics}\label{significance-statistics}}

\hypertarget{thinking-about-significance}{%
\section{Thinking about significance}\label{thinking-about-significance}}

\hypertarget{comparison-tests}{%
\section{Comparison tests}\label{comparison-tests}}

\hypertarget{correlation-tests}{%
\section{Correlation tests}\label{correlation-tests}}

\hypertarget{summarizing-datasets}{%
\chapter{Summarizing datasets}\label{summarizing-datasets}}

\hypertarget{summary-statements}{%
\section*{Summary statements}\label{summary-statements}}
\addcontentsline{toc}{section}{Summary statements}

\hypertarget{histograms}{%
\section*{Histograms}\label{histograms}}
\addcontentsline{toc}{section}{Histograms}

\hypertarget{violin-plots}{%
\section*{Violin Plots}\label{violin-plots}}
\addcontentsline{toc}{section}{Violin Plots}

\hypertarget{tables}{%
\section*{Tables}\label{tables}}
\addcontentsline{toc}{section}{Tables}

\hypertarget{part-your-r-tool-bag}{%
\part{Your R tool bag}\label{part-your-r-tool-bag}}

\hypertarget{joining-datasets}{%
\chapter{Joining datasets}\label{joining-datasets}}

\hypertarget{writing-functions}{%
\chapter{Writing functions}\label{writing-functions}}

\hypertarget{learning-goals-11}{%
\section*{Learning goals}\label{learning-goals-11}}
\addcontentsline{toc}{section}{Learning goals}

\begin{itemize}
\tightlist
\item
  Be able to write your own functions.
\item
  Be able to \emph{source} your own functions from separate R files.
\item
  Be able to use functions to make your work more efficient, effective, and organized.
\end{itemize}

Instructor tip!Here is some teacher content.

\hypertarget{first-steps}{%
\section*{First steps}\label{first-steps}}
\addcontentsline{toc}{section}{First steps}

You've already used dozens of functions during your learning in \texttt{R} so far. As you start applying \texttt{R} to your own projects, you will inevitably encounter a puzzle that could be solved by a custom function you write yourself. This module shows you how.

As explained in the \textbf{Calling Functions} module, most functions have three key components:

\begin{enumerate}
\def\labelenumi{(\arabic{enumi})}
\tightlist
\item
  one or more inputs,\\
\item
  a process that is applied to those inputs, and\\
\item
  an output of the result.
\end{enumerate}

When you define your own custom function, these are the three pieces you must be sure to include.

Here is a basic example:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{my\_function }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x)\{}
\NormalTok{  y }\OtherTok{\textless{}{-}} \FloatTok{1.3}\SpecialCharTok{*}\NormalTok{x }\SpecialCharTok{+} \DecValTok{10}
  \FunctionTok{return}\NormalTok{(y)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Now use your function:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{my\_function}\NormalTok{(}\AttributeTok{x=}\DecValTok{2}\NormalTok{) }\CommentTok{\# example 1}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 12.6
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{my\_function}\NormalTok{(}\AttributeTok{x=}\DecValTok{4}\NormalTok{) }\CommentTok{\# example 2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 15.2
\end{verbatim}

Let's break this down.

\begin{itemize}
\tightlist
\item
  \texttt{my\_function} is the name you are giving your function. It is the command you will use to call your function.
\item
  The \texttt{function()} command is what you use to define a function.
\item
  \texttt{x} is the variable you are using to represent your input.
\item
  \texttt{y\ \textless{}-\ 1.3x\ +\ 10} is the process that you are applying to your input.
\item
  \texttt{return(y)} is the command you use to define what the function's output will be.
\end{itemize}

Note that you are not \emph{required} to write out \texttt{x=2} in full when you are calling your function. Just providing \texttt{2} can also work:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{my\_function}\NormalTok{(}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 12.6
\end{verbatim}

\hypertarget{exercise-1-4}{%
\subsection*{Exercise 1}\label{exercise-1-4}}
\addcontentsline{toc}{subsection}{Exercise 1}

Define your own basic function and run it to make sure it works.

\hypertarget{next-steps}{%
\section*{Next steps}\label{next-steps}}
\addcontentsline{toc}{section}{Next steps}

\hypertarget{multiple-inputs}{%
\subsection*{Multiple inputs}\label{multiple-inputs}}
\addcontentsline{toc}{subsection}{Multiple inputs}

You can define a function with multiple inputs. Just separate each input with a comma.

To demonstrate this, let's modify the function above to allow you to define any linear regression you wish:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{my\_function }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x,a,b)\{}
\NormalTok{  y }\OtherTok{\textless{}{-}}\NormalTok{ a}\SpecialCharTok{*}\NormalTok{x }\SpecialCharTok{+}\NormalTok{ b}
  \FunctionTok{return}\NormalTok{(y)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Now call your function:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{my\_function}\NormalTok{(}\AttributeTok{x=}\DecValTok{2}\NormalTok{,}\AttributeTok{a=}\FloatTok{1.3}\NormalTok{,}\AttributeTok{b=}\DecValTok{10}\NormalTok{) }\CommentTok{\# example 1}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 12.6
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{my\_function}\NormalTok{(}\AttributeTok{x=}\DecValTok{4}\NormalTok{,}\AttributeTok{a=}\DecValTok{5}\NormalTok{,}\AttributeTok{b=}\DecValTok{100}\NormalTok{) }\CommentTok{\# example 2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 120
\end{verbatim}

Note that you do not need to write out the name of each input, as long as you provide inputs in the correct order.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{my\_function}\NormalTok{(}\DecValTok{2}\NormalTok{, }\FloatTok{1.3}\NormalTok{, }\DecValTok{10}\NormalTok{) }\CommentTok{\# example 1}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 12.6
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{my\_function}\NormalTok{(}\DecValTok{4}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{100}\NormalTok{) }\CommentTok{\# example 2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 120
\end{verbatim}

But note that it is usually best practice to name each input in your function call, to prevent the possibility of any confusion or mistakes. Also, when you name each input you can provide inputs in whatever order you wish:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{my\_function}\NormalTok{(}\AttributeTok{x=}\DecValTok{2}\NormalTok{, }\AttributeTok{a=}\FloatTok{1.3}\NormalTok{, }\AttributeTok{b=}\DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 12.6
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{my\_function}\NormalTok{(}\AttributeTok{a=}\FloatTok{1.3}\NormalTok{, }\AttributeTok{b=}\DecValTok{10}\NormalTok{, }\AttributeTok{x=}\DecValTok{2}\NormalTok{) }\CommentTok{\# different inout order, same output value}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 12.6
\end{verbatim}

\hypertarget{providing-defaults-for-inputs}{%
\subsection*{Providing defaults for inputs}\label{providing-defaults-for-inputs}}
\addcontentsline{toc}{subsection}{Providing defaults for inputs}

Just as \texttt{R}'s base functions include default values for some inputs (think \texttt{na.rm=FALSE} for \texttt{mean()} and \texttt{sd()}), you can define defaults in your own functions.

This version of \texttt{my\_function} includes default values for inputs \texttt{a} and \texttt{b}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{my\_function }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x,}\AttributeTok{a=}\FloatTok{1.3}\NormalTok{,}\AttributeTok{b=}\DecValTok{10}\NormalTok{)\{}
\NormalTok{  y }\OtherTok{\textless{}{-}}\NormalTok{ a}\SpecialCharTok{*}\NormalTok{x }\SpecialCharTok{+}\NormalTok{ b}
  \FunctionTok{return}\NormalTok{(y)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

When you provide default values, you no longer need to specify those inputs in your function call:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{my\_function}\NormalTok{(}\AttributeTok{x=}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 12.6
\end{verbatim}

\hypertarget{null-as-a-default}{%
\subsubsection*{\texorpdfstring{\texttt{NULL} as a default}{NULL as a default}}\label{null-as-a-default}}
\addcontentsline{toc}{subsubsection}{\texttt{NULL} as a default}

Setting the default value for an input to \texttt{NULL} can be useful in certain use cases. For example, let's say that if \texttt{b} is not defined by the user, you want its value to be set to five times the value of \texttt{x}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{my\_function }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x,}\AttributeTok{a=}\FloatTok{1.3}\NormalTok{,}\AttributeTok{b=}\ConstantTok{NULL}\NormalTok{)\{}
  
  \CommentTok{\# Handle input \textasciigrave{}b\textasciigrave{}}
  \ControlFlowTok{if}\NormalTok{(}\FunctionTok{is.null}\NormalTok{(b))\{}
\NormalTok{    b }\OtherTok{\textless{}{-}}\NormalTok{ x}\SpecialCharTok{*}\DecValTok{5}
    \FunctionTok{print}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"b was NULL! Setting its value to "}\NormalTok{, b))}
\NormalTok{  \}}
  
  \CommentTok{\# Now perform process}
\NormalTok{  y }\OtherTok{\textless{}{-}}\NormalTok{ a}\SpecialCharTok{*}\NormalTok{x }\SpecialCharTok{+}\NormalTok{ b}
  
  \FunctionTok{return}\NormalTok{(y)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

In this function, a conditional statement is used -- \texttt{if(is.null(b))\{\ ...\ \}} -- to handle the input \texttt{b} when the user does not specify a value for it. When \texttt{b} is \texttt{NULL}, the logical test \texttt{is.null(b)} will be \texttt{TRUE}, which will trigger the conditional statement and case \texttt{b} to be defined as \texttt{x*5}. Conditional statements will be convered in detail in the next modules.

Try running the function with and without providing a value for \texttt{b}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{my\_function}\NormalTok{(}\AttributeTok{x=}\DecValTok{2}\NormalTok{,}\AttributeTok{b=}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 7.6
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{my\_function}\NormalTok{(}\AttributeTok{x=}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "b was NULL! Setting its value to  10"
\end{verbatim}

\begin{verbatim}
[1] 12.6
\end{verbatim}

Conditional statements such as \texttt{if(is.null(x))\{\ ...\ \}} or \texttt{if(is.na(x))\{\ ...\ \}} will be helpful in dealing with all the possible values that a user can pass to your custom functions.

\hypertarget{complex-inputs}{%
\subsection*{Complex inputs}\label{complex-inputs}}
\addcontentsline{toc}{subsection}{Complex inputs}

You can pass vectors, dataframes, and any other data structure as inputs in your own custom functions. For example:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{my\_input }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{20}
\FunctionTok{my\_function}\NormalTok{(}\AttributeTok{x=}\NormalTok{my\_input,}\AttributeTok{a=}\FloatTok{1.2}\NormalTok{,}\AttributeTok{b=}\DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1] 11.2 12.4 13.6 14.8 16.0 17.2 18.4 19.6 20.8 22.0 23.2 24.4 25.6 26.8 28.0
[16] 29.2 30.4 31.6 32.8 34.0
\end{verbatim}

\hypertarget{complex-function-outputs}{%
\subsection*{Complex function outputs}\label{complex-function-outputs}}
\addcontentsline{toc}{subsection}{Complex function outputs}

At some point you will want multiple objects to be returned by your function. For example, perhaps you want both \texttt{y} and \texttt{b} to be returned now that you can define \texttt{b} according to the value of \texttt{x}.

Unfortunately, the \texttt{return()} command does not let you include multiple objects. \texttt{return(y,b)} will not work. To make it work, you have to place your output objects within a single object, such as a vector, dataframe, or list.

Here is a modification of \texttt{my\_function()} that allows multiple outputs:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{my\_function }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x,}\AttributeTok{a=}\FloatTok{1.3}\NormalTok{,}\AttributeTok{b=}\ConstantTok{NULL}\NormalTok{)\{}
  
  \CommentTok{\# Handle input \textasciigrave{}b\textasciigrave{}}
  \ControlFlowTok{if}\NormalTok{(}\FunctionTok{is.null}\NormalTok{(b))\{}
\NormalTok{    b }\OtherTok{\textless{}{-}}\NormalTok{ x}\SpecialCharTok{*}\DecValTok{5}
\NormalTok{  \}}
  
  \CommentTok{\# Now perform process}
\NormalTok{  y }\OtherTok{\textless{}{-}}\NormalTok{ a}\SpecialCharTok{*}\NormalTok{x }\SpecialCharTok{+}\NormalTok{ b}
  
\NormalTok{  output }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"y"}\OtherTok{=}\NormalTok{y,}\StringTok{"b"}\OtherTok{=}\NormalTok{b) }
  \FunctionTok{return}\NormalTok{(output)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Now \texttt{my\_function()} works like this:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{my\_function}\NormalTok{(}\AttributeTok{x=}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   y    b 
31.5 25.0 
\end{verbatim}

To get the value of just \texttt{y} or just \texttt{b}, you can treat the output just like any other vector:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{my\_function}\NormalTok{(}\AttributeTok{x=}\DecValTok{5}\NormalTok{)[}\DecValTok{1}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   y 
31.5 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{my\_function}\NormalTok{(}\AttributeTok{x=}\DecValTok{5}\NormalTok{)[}\DecValTok{2}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 b 
25 
\end{verbatim}

\hypertarget{adding-plots}{%
\subsection*{Adding plots}\label{adding-plots}}
\addcontentsline{toc}{subsection}{Adding plots}

Plots can be included in the function commands just as in any other context:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{my\_function }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x,}\AttributeTok{a=}\FloatTok{1.3}\NormalTok{,}\AttributeTok{b=}\DecValTok{10}\NormalTok{)\{}
\NormalTok{  y }\OtherTok{\textless{}{-}}\NormalTok{ a}\SpecialCharTok{*}\NormalTok{x }\SpecialCharTok{+}\NormalTok{ b}
  \FunctionTok{plot}\NormalTok{(y }\SpecialCharTok{\textasciitilde{}}\NormalTok{ x, }\AttributeTok{type=}\StringTok{"b"}\NormalTok{)}
  \FunctionTok{return}\NormalTok{(y)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{my\_input }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{20}
\FunctionTok{my\_function}\NormalTok{(}\AttributeTok{x=}\NormalTok{my\_input)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-193-1.pdf}

\begin{verbatim}
 [1] 11.3 12.6 13.9 15.2 16.5 17.8 19.1 20.4 21.7 23.0 24.3 25.6 26.9 28.2 29.5
[16] 30.8 32.1 33.4 34.7 36.0
\end{verbatim}

Adding plots to functions can be super useful if you want to make multiple plots with the same formatting specifications. Rather than retyping the same long plot commands multiple times, just write a single function and call the function as many times as you wish.

Let's add some fancy formatting to our plot. Note that we will modify the name of the function to make it more descriptive and helpful. The \texttt{lm} in \texttt{plot\_my\_lm} stands for \emph{linear model}, which is what is being defined with the \texttt{y=ax+b} equation.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{plot\_my\_lm }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x,}\AttributeTok{a=}\FloatTok{1.3}\NormalTok{,}\AttributeTok{b=}\DecValTok{10}\NormalTok{,}\AttributeTok{plot\_only=}\ConstantTok{TRUE}\NormalTok{)\{}
  
  \CommentTok{\# Process}
\NormalTok{  y }\OtherTok{\textless{}{-}}\NormalTok{ a}\SpecialCharTok{*}\NormalTok{x }\SpecialCharTok{+}\NormalTok{ b}
  
  \CommentTok{\# Plot}
  \FunctionTok{par}\NormalTok{(}\AttributeTok{mar=}\FunctionTok{c}\NormalTok{(}\FloatTok{4.2}\NormalTok{,}\FloatTok{4.2}\NormalTok{,}\DecValTok{3}\NormalTok{,.}\DecValTok{5}\NormalTok{)) }\CommentTok{\# set plot margins}
  \FunctionTok{plot}\NormalTok{(y }\SpecialCharTok{\textasciitilde{}}\NormalTok{ x, }\AttributeTok{type=}\StringTok{"o"}\NormalTok{,}\AttributeTok{axes=}\ConstantTok{FALSE}\NormalTok{,}\AttributeTok{ann=}\ConstantTok{FALSE}\NormalTok{,}\AttributeTok{pch=}\DecValTok{16}\NormalTok{,}\AttributeTok{col=}\StringTok{"firebrick"}\NormalTok{,}\AttributeTok{xlim=}\FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{20}\NormalTok{,}\DecValTok{20}\NormalTok{),}\AttributeTok{ylim=}\FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{20}\NormalTok{,}\DecValTok{20}\NormalTok{)) }\CommentTok{\# define basic plot}
  \FunctionTok{title}\NormalTok{(}\AttributeTok{main=}\FunctionTok{paste}\NormalTok{(}\StringTok{"y ="}\NormalTok{,a,}\StringTok{"x +"}\NormalTok{,b)) }\CommentTok{\# print a dynamic main title}
  \FunctionTok{title}\NormalTok{(}\AttributeTok{xlab=}\StringTok{"x"}\NormalTok{,}\AttributeTok{ylab=}\StringTok{"y"}\NormalTok{)  }\CommentTok{\# print axis labelse}
  \FunctionTok{axis}\NormalTok{(}\DecValTok{1}\NormalTok{) }\CommentTok{\# print the X axis}
  \FunctionTok{axis}\NormalTok{(}\DecValTok{2}\NormalTok{,}\AttributeTok{las=}\DecValTok{2}\NormalTok{) }\CommentTok{\# print the Y axis and turn its labels right{-}side{-}up}
  \FunctionTok{abline}\NormalTok{(}\AttributeTok{h=}\DecValTok{0}\NormalTok{,}\AttributeTok{v=}\DecValTok{0}\NormalTok{,}\AttributeTok{col=}\StringTok{"grey70"}\NormalTok{) }\CommentTok{\# add grey lines indicating x=0 and y=0}
  
  \CommentTok{\# Return}
  \ControlFlowTok{if}\NormalTok{(plot\_only}\SpecialCharTok{==}\ConstantTok{FALSE}\NormalTok{)\{}
    \FunctionTok{return}\NormalTok{(y)}
\NormalTok{  \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Note that we added a parameter, \texttt{plot\_only}. When it is set to \texttt{TRUE}, the function will not return any numbers.

Now let's call this fancy function a bunch of times:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{my\_input }\OtherTok{\textless{}{-}} \SpecialCharTok{{-}}\DecValTok{20}\SpecialCharTok{:}\DecValTok{20} \CommentTok{\# define a common x input value}

\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow=}\FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{,}\DecValTok{2}\NormalTok{)) }\CommentTok{\# stage a multi{-}paned plot}
\FunctionTok{plot\_my\_lm}\NormalTok{(}\AttributeTok{x=}\NormalTok{my\_input,}\AttributeTok{a=}\DecValTok{2}\NormalTok{,}\AttributeTok{b=}\DecValTok{15}\NormalTok{)}
\FunctionTok{plot\_my\_lm}\NormalTok{(}\AttributeTok{x=}\NormalTok{my\_input,}\AttributeTok{a=}\DecValTok{1}\NormalTok{,}\AttributeTok{b=}\DecValTok{10}\NormalTok{)}
\FunctionTok{plot\_my\_lm}\NormalTok{(}\AttributeTok{x=}\NormalTok{my\_input,}\AttributeTok{a=}\NormalTok{.}\DecValTok{5}\NormalTok{,}\AttributeTok{b=}\DecValTok{5}\NormalTok{)}
\FunctionTok{plot\_my\_lm}\NormalTok{(}\AttributeTok{x=}\NormalTok{my\_input,}\AttributeTok{a=}\DecValTok{0}\NormalTok{,}\AttributeTok{b=}\DecValTok{0}\NormalTok{)}
\FunctionTok{plot\_my\_lm}\NormalTok{(}\AttributeTok{x=}\NormalTok{my\_input,}\AttributeTok{a=}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}\AttributeTok{b=}\SpecialCharTok{{-}}\DecValTok{5}\NormalTok{)}
\FunctionTok{plot\_my\_lm}\NormalTok{(}\AttributeTok{x=}\NormalTok{my\_input,}\AttributeTok{a=}\SpecialCharTok{{-}}\DecValTok{2}\NormalTok{,}\AttributeTok{b=}\DecValTok{15}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-195-1.pdf}

Think about how many lines of code would have been needed to write out all of these fancy plots if you did not use a custom function! Think about how cluttered and dizzying your code would look! And think about how many opportunities for errors and inconsistencies there would have been! That is the advantage of writing your own functions: it makes your work more efficient, more organized, and less prone to errors.

Another major advantage of this approach comes into play when you decide you want to tweak the formatting of your plot. Rather than going through each \texttt{plot(...)} command and modifying the inputs in each one, when you write a custom plotting function you just have to make those changes once. Again, using a custom function saves you time and removes the possibility of inconsistencies or mistakes in the plots you are creating.

\hypertarget{exercise-2-4}{%
\subsection*{Exercise 2}\label{exercise-2-4}}
\addcontentsline{toc}{subsection}{Exercise 2}

Modify the most recent version of \texttt{plot\_my\_lm} above such that you can specify the color for the plotted line as an input in the function. Then reproduce the multi-paned plot using a different color in each plot. (Here is a good reference for \href{http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf}{color options in R}).

\hypertarget{sourcing-functions}{%
\section*{Sourcing functions}\label{sourcing-functions}}
\addcontentsline{toc}{section}{Sourcing functions}

As you advance in your coding, you will likely be writing multiple custom functions within a single \texttt{R} script. It is usually useful to group these functions into the same section of code near the top of your script.

But for even \emph{better} script organization and simplification, you should \emph{source} your functions from a separate \texttt{R} script. This means placing your function code in a separate \texttt{R} script and calling that file from the script in which you are carrying out your analyses. In addition to simplifying your analysis script, keeping your functions in a separate file allows them to be shared or sourced from any number of other scripts, which further organizes and simplifies your project's code and increases the reproducibility of your work.

Here is how sourcing functiosn can work:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Open a new \texttt{R} script. Save it as \texttt{functions.R} and save it in the same working directory as the script you are using to work through this module.
\item
  Copy and paste the \texttt{plot\_my\_lm()} function into your \texttt{functions.R} script. Save that script to ensure your code is safe.
\item
  No remove the code defining \texttt{plot\_my\_lm()} from your module \texttt{R} script.
\item
  In its place, type this command:
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{source}\NormalTok{(}\StringTok{"functions.R"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

This command tells \texttt{R} to run the code in \texttt{functions.R} and store the objects and outputs from it in its active memory. You can now call \texttt{plot\_my\_lm()} from your module script.

\hypertarget{exercise-3-4}{%
\subsection*{Exercise 3}\label{exercise-3-4}}
\addcontentsline{toc}{subsection}{Exercise 3}

Carry out the above instructions to ensure that you know how to source a function from a separate \texttt{R} script.

\hypertarget{review-assignment-baby-names-over-time}{%
\section*{Review assignment: Baby names over time}\label{review-assignment-baby-names-over-time}}
\addcontentsline{toc}{section}{Review assignment: Baby names over time}

\includegraphics{img/baby_names.png}

In this exercise, you will investigate annual trends in the prevalence of six names for babies born in the United States.

\textbf{Step 1.} Decide upon five names of interest to you, in addition to your own. Create a vector of these six names.

\textbf{Step 2.} Install and load the package \texttt{babynames}, which includes the names of each child born in the United States from 1880 to 2017, according to the Social Security Administration.

\textbf{Step 3.} This package provides the dataset in a dataframe that is also named \texttt{babynames}. Familiarize yourself with this dataset using its documentation.

\textbf{Step 4.} Before writing any functions, do some basic exploration with this dataset.

\begin{enumerate}
\def\labelenumi{(\alph{enumi})}
\tightlist
\item
  How many different names have been used since 1880?\\
\item
  What is the most common name (proportionally) ever given to female babies?
\item
  To male babies?
\item
  What was the most common name in 2017?
\end{enumerate}

\textbf{Step 5.} Write a function that takes any name and plots its proportional prevalence from 1880 to 2017. Format the plot beautifully. Provide the name as the \texttt{main} title of the plot.

\textbf{Step 6.} Include an input that allows the user to specify the y axis range. If that input is set to \texttt{NULL}, the function should just use the maximum value contained in the data itself, scaled by 1.2 to make the plot prettier. Always use \texttt{0} as the lower bound of the y axis.

\textbf{Step 7.} Create a multi-pane plot containing six subplots, one for each of your names of interest.

\hypertarget{other-resources-8}{%
\section*{Other Resources}\label{other-resources-8}}
\addcontentsline{toc}{section}{Other Resources}

\emph{NOTE: Under construction!}

\hypertarget{for-loops}{%
\chapter{\texorpdfstring{\texttt{for} loops}{for loops}}\label{for-loops}}

\hypertarget{learning-goals-12}{%
\section*{Learning goals}\label{learning-goals-12}}
\addcontentsline{toc}{section}{Learning goals}

\begin{itemize}
\tightlist
\item
  What \texttt{for} loops are, and how to use them yourself
\item
  How to use \texttt{for} loops for plots that are tricky but super cool.
\item
  How to use \texttt{for} loops to summarize subgroups in your data
\item
  How to use nested \texttt{for} loops
\end{itemize}

\hypertarget{basics}{%
\section*{Basics}\label{basics}}
\addcontentsline{toc}{section}{Basics}

A \texttt{for} loop is a super powerful coding tool. In a \texttt{for} loop, \texttt{R} loops through a chunk of code for a set number of repititions.

A super basic example:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{5}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in}\NormalTok{ x)\{}
  \FunctionTok{print}\NormalTok{(i)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1
[1] 2
[1] 3
[1] 4
[1] 5
\end{verbatim}

Here's an example of a pretty useless \texttt{for} loop:

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{)\{}
  \FunctionTok{print}\NormalTok{(}\StringTok{"I\textquotesingle{}m just repeating myself."}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "I'm just repeating myself."
[1] "I'm just repeating myself."
[1] "I'm just repeating myself."
[1] "I'm just repeating myself."
[1] "I'm just repeating myself."
\end{verbatim}

\textbf{This code is saying:}\\
- For each iteration of this loop, step to the next value in \texttt{x} (first example) or \texttt{1:5} (second example).\\
- Store that value in an object \texttt{i},\\
- and run the code inside the curly brackets.
- Repeat until the end of \texttt{x}.

\textbf{Look at the basic structure:}\\
- In the\texttt{for(\ )} parenthetical, you tell R what values to step through (\texttt{x}), and how to refer to the value in each iteration (\texttt{i}).\\
- Within the curly brackets, you place the chunk of code you want to repeat.

Another basic example, demonsrating that you can update a variable repeatedly in a loop.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{2}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{)\{}
\NormalTok{  x }\OtherTok{\textless{}{-}}\NormalTok{ x}\SpecialCharTok{*}\NormalTok{x}
  \FunctionTok{print}\NormalTok{(x)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 4
[1] 16
[1] 256
[1] 65536
[1] 4294967296
\end{verbatim}

Another silly example:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{professors }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Keri"}\NormalTok{,}\StringTok{"Deb"}\NormalTok{,}\StringTok{"Ken"}\NormalTok{) }
\ControlFlowTok{for}\NormalTok{(x }\ControlFlowTok{in}\NormalTok{ professors)\{}
  \FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(x,}\StringTok{" is pretty cool!"}\NormalTok{))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "Keri is pretty cool!"
[1] "Deb is pretty cool!"
[1] "Ken is pretty cool!"
\end{verbatim}

\hypertarget{exercise-1-5}{%
\subsection*{Exercise 1}\label{exercise-1-5}}
\addcontentsline{toc}{subsection}{Exercise 1}

Use this space to practice the basics of \texttt{for\ loop} formatting.

First, create a vector of names (add at least 3)

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Add your names to this vector}
\NormalTok{famous.names }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Lady Gaga"}\NormalTok{,}\StringTok{"David Haskell"}\NormalTok{,}\StringTok{"Tom Cruise"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Using the examples above as a guide, create a \texttt{for\ loop} that prints the same silly statement about each of these names.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Do your coding here}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in}\NormalTok{ famous.names)\{}
  \FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(i,}\StringTok{" has cooties!"}\NormalTok{))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "Lady Gaga has cooties!"
[1] "David Haskell has cooties!"
[1] "Tom Cruise has cooties!"
\end{verbatim}

\hypertarget{for-loops-in-plots}{%
\section*{\texorpdfstring{\texttt{for} loops in plots}{for loops in plots}}\label{for-loops-in-plots}}
\addcontentsline{toc}{section}{\texttt{for} loops in plots}

These silly examples above do a poor job of demonstrating how powerful a \texttt{for\ loop} can be. You can use \texttt{for} loops with data to do really cool things with relatively simple code.

Thinking in \texttt{for} loops, however, can take some getting used to. Learning how to design code with \texttt{for} loops is one of the most important milestones on your way to thinking like a data scientist.

\hypertarget{efficient-multi-panel-plots}{%
\subsection*{Efficient multi-panel plots}\label{efficient-multi-panel-plots}}
\addcontentsline{toc}{subsection}{Efficient multi-panel plots}

For example, a \texttt{for\ loop} can be a very efficient way of making multi-panel plots.

Let's use a \texttt{for\ loop} to get a quick overview of the variables included in the \texttt{airquality} dataset built into R.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{data}\NormalTok{(airquality)}
\FunctionTok{head}\NormalTok{(airquality)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  Ozone Solar.R Wind Temp Month Day
1    41     190  7.4   67     5   1
2    36     118  8.0   72     5   2
3    12     149 12.6   74     5   3
4    18     313 11.5   62     5   4
5    NA      NA 14.3   56     5   5
6    28      NA 14.9   66     5   6
\end{verbatim}

Looks like the first four columns would be interesting to plot.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow=}\FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{)) }\CommentTok{\# Setup a multi{-}panel plot \# format = c(number of rows, number of columns)}
\FunctionTok{par}\NormalTok{(}\AttributeTok{mar=}\FunctionTok{c}\NormalTok{(}\FloatTok{4.5}\NormalTok{,}\FloatTok{4.5}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{)) }\CommentTok{\# Set plot margins}

\CommentTok{\# Loop through the first four columns ...}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{4}\NormalTok{)\{}
\NormalTok{  y }\OtherTok{\textless{}{-}}\NormalTok{ airquality[,i] }\CommentTok{\# Select data in column i}
\NormalTok{  var.name }\OtherTok{\textless{}{-}} \FunctionTok{names}\NormalTok{(airquality)[i] }\CommentTok{\# Get name of that column}
  \FunctionTok{plot}\NormalTok{(y,}\AttributeTok{xlab=}\StringTok{"Day"}\NormalTok{,}\AttributeTok{ylab=}\NormalTok{var.name,}\AttributeTok{pch=}\DecValTok{16}\NormalTok{) }\CommentTok{\# Plot data}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-204-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{)) }\CommentTok{\# restore the default single{-}panel plot}
\end{Highlighting}
\end{Shaded}

\hypertarget{using-for-loops-to-plot-subgroups-of-data}{%
\subsection*{\texorpdfstring{Using \texttt{for} loops to plot subgroups of data}{Using for loops to plot subgroups of data}}\label{using-for-loops-to-plot-subgroups-of-data}}
\addcontentsline{toc}{subsection}{Using \texttt{for} loops to plot subgroups of data}

\texttt{for\ loops} are also useful for plotting data in tricky ways. Let's use a different built-in dataset, that shows the performance of various car make/models.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{data}\NormalTok{(mtcars)}
\FunctionTok{head}\NormalTok{(mtcars)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
                   mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1
\end{verbatim}

Let's say we want to see how gas mileage is affected by the number of cylinders a car has. It would be nice to create a plot that shows the raw data as well as the mean mileage for each cylinder number.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Let\textquotesingle{}s see how many different cylinder types there are in the data}
\NormalTok{ucyl }\OtherTok{\textless{}{-}} \FunctionTok{unique}\NormalTok{(mtcars}\SpecialCharTok{$}\NormalTok{cyl) ; ucyl}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 6 4 8
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Let\textquotesingle{}s make an empty plot}
\FunctionTok{plot}\NormalTok{(}\DecValTok{1}\NormalTok{,}\AttributeTok{type=}\StringTok{"n"}\NormalTok{, }\CommentTok{\# tell R not to draw anything}
     \AttributeTok{xlim=}\FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{10}\NormalTok{),}\AttributeTok{ylim=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{50}\NormalTok{),}
     \AttributeTok{xlab=}\StringTok{"Number of cylinders"}\NormalTok{,}
     \AttributeTok{ylab=}\StringTok{"Gas mileage (mpg)"}\NormalTok{)}

\CommentTok{\# Write your for loop here to add the actual data}
\NormalTok{i}\OtherTok{=}\NormalTok{ucyl[}\DecValTok{1}\NormalTok{] }\CommentTok{\# It\textquotesingle{}s always good to use a known value of i as you build up your for loop}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in}\NormalTok{ ucyl)\{}
  
  \CommentTok{\# Subset the dataframe according to number of cylinders}
\NormalTok{  cari }\OtherTok{\textless{}{-}}\NormalTok{ mtcars[mtcars}\SpecialCharTok{$}\NormalTok{cyl}\SpecialCharTok{==}\NormalTok{i,]}
  
  \CommentTok{\# Plot the raw data}
  \FunctionTok{points}\NormalTok{(}\AttributeTok{x=}\NormalTok{cari}\SpecialCharTok{$}\NormalTok{cyl,}\AttributeTok{y=}\NormalTok{cari}\SpecialCharTok{$}\NormalTok{mpg,}\AttributeTok{col=}\StringTok{"grey"}\NormalTok{)}
  
  \CommentTok{\# Superimpose the mean on top}
  \FunctionTok{points}\NormalTok{(}\AttributeTok{x=}\NormalTok{i,}\AttributeTok{y=}\FunctionTok{mean}\NormalTok{(cari}\SpecialCharTok{$}\NormalTok{mpg),}\AttributeTok{col=}\StringTok{"black"}\NormalTok{,}\AttributeTok{pch=}\StringTok{"{-}"}\NormalTok{,}\AttributeTok{cex=}\DecValTok{5}\NormalTok{,)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-206-1.pdf}

\hypertarget{exercise-3-5}{%
\subsection*{Exercise 3}\label{exercise-3-5}}
\addcontentsline{toc}{subsection}{Exercise 3}

Now try to do something similar on your own with the \texttt{airquality} dataset. Use \texttt{for\ loops} to create a plot with Month on the x axis and Temperature on the y axis. On this plot, depict all the temperatures recorded in each month in the color grey, then superimpose the mean temperature for each month.

We will provide the empty plot, you provide the \texttt{for\ loop}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(}\DecValTok{1}\NormalTok{,}\AttributeTok{type=}\StringTok{"n"}\NormalTok{,}
     \AttributeTok{xlim=}\FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{,}\DecValTok{10}\NormalTok{),}\AttributeTok{ylim=}\FunctionTok{c}\NormalTok{(}\DecValTok{40}\NormalTok{,}\DecValTok{100}\NormalTok{),}
     \AttributeTok{xlab=}\StringTok{"Month"}\NormalTok{,}
     \AttributeTok{ylab=}\StringTok{"Yemperature"}\NormalTok{)}

\CommentTok{\# Write your for loop here to add the actual data}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in}\NormalTok{ airquality}\SpecialCharTok{$}\NormalTok{Month)\{}
\NormalTok{  airi }\OtherTok{\textless{}{-}}\NormalTok{ airquality[airquality}\SpecialCharTok{$}\NormalTok{Month}\SpecialCharTok{==}\NormalTok{i,]}
  \FunctionTok{points}\NormalTok{(}\AttributeTok{x=}\NormalTok{airi}\SpecialCharTok{$}\NormalTok{Month,}\AttributeTok{y=}\NormalTok{airi}\SpecialCharTok{$}\NormalTok{Temp,}\AttributeTok{pch=}\DecValTok{1}\NormalTok{,}\AttributeTok{col=}\StringTok{"grey"}\NormalTok{)}
  \FunctionTok{points}\NormalTok{(}\AttributeTok{x=}\NormalTok{i,}\AttributeTok{y=}\FunctionTok{mean}\NormalTok{(airi}\SpecialCharTok{$}\NormalTok{Temp),}\AttributeTok{pch=}\StringTok{"{-}"}\NormalTok{,}\AttributeTok{cex=}\DecValTok{5}\NormalTok{,}\AttributeTok{col=}\StringTok{"black"}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-207-1.pdf}

\hypertarget{using-for-loops-to-layer-cyclical-or-repetitive-data}{%
\subsection*{\texorpdfstring{Using \texttt{for} loops to layer cyclical or repetitive data}{Using for loops to layer cyclical or repetitive data}}\label{using-for-loops-to-layer-cyclical-or-repetitive-data}}
\addcontentsline{toc}{subsection}{Using \texttt{for} loops to layer cyclical or repetitive data}

Here's another good example of the power of a good \texttt{for\ loop}.

First, read in some cool data (\href{https://github.com/databrew/intro-to-data-science/blob/main/data/keeling-curve.csv?raw=true}{link to dataset}).

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{kc }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"./data/keeling{-}curve.csv"}\NormalTok{) ; }\FunctionTok{head}\NormalTok{(kc)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  year month day_of_month day_of_year year_dec frac_of_year    CO2
1 1974     5           26    145.4890 1974.399       0.3986 332.95
2 1974     6            2    152.4970 1974.418       0.4178 332.35
3 1974     6            9    159.5050 1974.437       0.4370 332.20
4 1974     6           16    166.5130 1974.456       0.4562 332.37
5 1974     6           23    173.4845 1974.475       0.4753 331.73
6 1974     6           30    180.4925 1974.495       0.4945 331.68
\end{verbatim}

This is the famous Keeling Curve dataset: long-term monitoring of atmospheric CO2 measured at a volcanic observatory in Hawaii.

Try plotting the Keeling Curve:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(kc}\SpecialCharTok{$}\NormalTok{CO2 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ kc}\SpecialCharTok{$}\NormalTok{year\_dec,}\AttributeTok{type=}\StringTok{"l"}\NormalTok{,}\AttributeTok{xlab=}\StringTok{"Year"}\NormalTok{,}\AttributeTok{ylab=}\StringTok{"Atmospheric CO2"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-209-1.pdf}

There are some erroneous data points! We clearly can't have negative CO2 values. Let's remove those and try again:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{kc }\OtherTok{\textless{}{-}}\NormalTok{ kc[kc}\SpecialCharTok{$}\NormalTok{CO2 }\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{,] }
\FunctionTok{plot}\NormalTok{(kc}\SpecialCharTok{$}\NormalTok{CO2 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ kc}\SpecialCharTok{$}\NormalTok{year\_dec,}\AttributeTok{type=}\StringTok{"l"}\NormalTok{,}\AttributeTok{xlab=}\StringTok{"Year"}\NormalTok{,}\AttributeTok{ylab=}\StringTok{"Atmospheric CO2"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-210-1.pdf}

\textbf{What's the deal with those squiggles?}

They seem to happen every year, cyclically. Let's investigate!

Let's look at the data a different way: \emph{by layering years on top of one another.}

To begin, let's plot data for only a \emph{single} year:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Stage an empty plot for what you are trying to represent}
\FunctionTok{plot}\NormalTok{(}\DecValTok{1}\NormalTok{, }\CommentTok{\# plot a single point}
     \AttributeTok{type=}\StringTok{"n"}\NormalTok{,}
     \AttributeTok{xlim=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{365}\NormalTok{),}\AttributeTok{xlab=}\StringTok{"Day of year"}\NormalTok{,}
     \AttributeTok{ylim=}\FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{5}\NormalTok{,}\DecValTok{5}\NormalTok{),}\AttributeTok{ylab=}\StringTok{"CO2 anomaly"}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{h=}\DecValTok{0}\NormalTok{,}\AttributeTok{col=}\StringTok{"grey"}\NormalTok{) }\CommentTok{\# add nifty horizontal line}

\CommentTok{\# Reduce the dataset to a single year (any year)}
\NormalTok{kcy }\OtherTok{\textless{}{-}}\NormalTok{ kc[kc}\SpecialCharTok{$}\NormalTok{year}\SpecialCharTok{==}\StringTok{"1990"}\NormalTok{,] ; }\FunctionTok{head}\NormalTok{(kcy)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
    year month day_of_month day_of_year year_dec frac_of_year    CO2
816 1990     1            7      6.4970 1990.018       0.0178 353.58
817 1990     1           14     13.5050 1990.037       0.0370 353.99
818 1990     1           21     20.5130 1990.056       0.0562 353.92
819 1990     1           28     27.4845 1990.075       0.0753 354.39
820 1990     2            4     34.4925 1990.094       0.0945 355.04
821 1990     2           11     41.5005 1990.114       0.1137 355.09
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Let\textquotesingle{}s convert each CO2 reading to an \textquotesingle{}anomaly\textquotesingle{} compared to the year\textquotesingle{}s average.}
\NormalTok{CO2.mean }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(kcy}\SpecialCharTok{$}\NormalTok{CO2,}\AttributeTok{na.rm=}\ConstantTok{TRUE}\NormalTok{) ; CO2.mean  }\CommentTok{\# Take note of how useful that \textquotesingle{}na.rm=TRUE\textquotesingle{} input can be!}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 354.4538
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y }\OtherTok{\textless{}{-}}\NormalTok{ kcy}\SpecialCharTok{$}\NormalTok{CO2 }\SpecialCharTok{{-}}\NormalTok{ CO2.mean ; y }\CommentTok{\# Translate each data point to an anomaly}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1] -0.87384615 -0.46384615 -0.53384615 -0.06384615  0.58615385  0.63615385
 [7]  0.96615385  0.72615385  1.13615385  1.33615385  1.08615385  1.67615385
[13]  1.81615385  1.71615385  1.77615385  2.41615385  2.50615385  3.24615385
[19]  2.79615385  2.87615385  2.92615385  2.52615385  1.79615385  1.72615385
[25]  1.33615385  1.76615385  0.53615385 -0.16384615 -0.08384615 -0.46384615
[31] -1.28384615 -0.99384615 -1.37384615 -2.65384615 -3.29384615 -3.59384615
[37] -2.70384615 -2.99384615 -3.05384615 -2.91384615 -2.88384615 -2.72384615
[43] -2.05384615 -1.74384615 -1.30384615 -1.00384615 -0.76384615 -0.55384615
[49]  0.01615385 -0.11384615  0.37615385  0.34615385          NA
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Add points to your plot}
\FunctionTok{points}\NormalTok{(y}\SpecialCharTok{\textasciitilde{}}\NormalTok{kcy}\SpecialCharTok{$}\NormalTok{day\_of\_year,}\AttributeTok{pch=}\DecValTok{16}\NormalTok{,}\AttributeTok{col=}\FunctionTok{adjustcolor}\NormalTok{(}\StringTok{"darkblue"}\NormalTok{,}\AttributeTok{alpha.f=}\NormalTok{.}\DecValTok{3}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-211-1.pdf}

But this only shows one year of data! How can we include the seasonal squiggle from other years?

Let's use a \texttt{for\ loop}!

OK -- let's redo that graph and add a \texttt{for\ loop} into the mix:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# First, stage your empty plot:}
\FunctionTok{plot}\NormalTok{(}\DecValTok{1}\NormalTok{,}\AttributeTok{type=}\StringTok{"n"}\NormalTok{,}
     \AttributeTok{xlim=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{365}\NormalTok{),}\AttributeTok{xlab=}\StringTok{"Day of year"}\NormalTok{,}
     \AttributeTok{ylim=}\FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{5}\NormalTok{,}\DecValTok{5}\NormalTok{),}\AttributeTok{ylab=}\StringTok{"CO2 anomaly"}\NormalTok{)}

\FunctionTok{abline}\NormalTok{(}\AttributeTok{h=}\DecValTok{0}\NormalTok{,}\AttributeTok{col=}\StringTok{"grey"}\NormalTok{)}

\CommentTok{\# Now we will loop through each year of data. First, get a vector of the years included in the dataset:}
\NormalTok{years }\OtherTok{\textless{}{-}} \FunctionTok{unique}\NormalTok{(kc}\SpecialCharTok{$}\NormalTok{year) ; years}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1] 1974 1975 1976 1977 1978 1979 1980 1981 1982 1983 1984 1985 1986 1987 1988
[16] 1989 1990 1991 1992 1993 1994 1995 1996 1997 1998 1999 2000 2001 2002 2003
[31] 2004 2005 2006 2007 2008 2009 2010 2011 2012 2013 2014 2015 2016 2017 2018
[46] 2019 2020 2021 <NA>
49 Levels: } 1974 1975 1976 1977 1978 1979 1980 1981 1982 1983 1984 ... 2021
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Now build your for loop. }
\CommentTok{\# Notice that the contents of the \textasciigrave{}for loop\textasciigrave{} are exactly the same }
\CommentTok{\# as the single plot above {-}{-}  with one exception. }
\CommentTok{\# Notice the use of the symbol i}

\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in}\NormalTok{ years)\{}

  \CommentTok{\# Reduce the dataset to a single year}
\NormalTok{  kcy }\OtherTok{\textless{}{-}}\NormalTok{ kc[kc}\SpecialCharTok{$}\NormalTok{year}\SpecialCharTok{==}\NormalTok{i,] ; }\FunctionTok{head}\NormalTok{(kcy)}
  
  \CommentTok{\# Let\textquotesingle{}s convert each CO2 reading to an \textquotesingle{}anomaly\textquotesingle{} compared to the year\textquotesingle{}s average.}
\NormalTok{  CO2.mean }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(kcy}\SpecialCharTok{$}\NormalTok{CO2,}\AttributeTok{na.rm=}\ConstantTok{TRUE}\NormalTok{) ; CO2.mean }\CommentTok{\# Get average CO2 for year}

\NormalTok{  y }\OtherTok{\textless{}{-}}\NormalTok{ kcy}\SpecialCharTok{$}\NormalTok{CO2 }\SpecialCharTok{{-}}\NormalTok{ CO2.mean ; y }\CommentTok{\# Translate each data point to an anomaly}

  \CommentTok{\# Add points to your plot}
  \FunctionTok{points}\NormalTok{(y}\SpecialCharTok{\textasciitilde{}}\NormalTok{kcy}\SpecialCharTok{$}\NormalTok{day\_of\_year,}\AttributeTok{pch=}\DecValTok{16}\NormalTok{,}\AttributeTok{col=}\FunctionTok{adjustcolor}\NormalTok{(}\StringTok{"darkblue"}\NormalTok{,}\AttributeTok{alpha.f=}\NormalTok{.}\DecValTok{3}\NormalTok{))}
  
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-212-1.pdf}

Beautiful! So how do you interpret this graph? Why does the squiggle happen every year?

\hypertarget{using-for-loops-to-process-summarize-data}{%
\section*{\texorpdfstring{Using \texttt{for} loops to process \& summarize data}{Using for loops to process \& summarize data}}\label{using-for-loops-to-process-summarize-data}}
\addcontentsline{toc}{section}{Using \texttt{for} loops to process \& summarize data}

\hypertarget{using-for-loops-to-summarize-data-subgroups}{%
\subsection*{\texorpdfstring{Using \texttt{for} loops to summarize data subgroups}{Using for loops to summarize data subgroups}}\label{using-for-loops-to-summarize-data-subgroups}}
\addcontentsline{toc}{subsection}{Using \texttt{for} loops to summarize data subgroups}

This is one of the most common uses of \texttt{for} loops: you want to summarize information about subgroups in your dataset.

\hypertarget{example-use-cases}{%
\subsubsection*{Example use cases}\label{example-use-cases}}
\addcontentsline{toc}{subsubsection}{Example use cases}

\begin{itemize}
\item
  You want to summarize sample counts for each day of fieldwork.
\item
  You want to summarize details for each user in your database.
\item
  You want to summarize weather information for each month of the year.
\end{itemize}

\hypertarget{workflow}{%
\subsubsection*{Workflow}\label{workflow}}
\addcontentsline{toc}{subsubsection}{Workflow}

All of these summaries can be achieved with the same basic workflow.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Determine how to define the basic unit of summarization \emph{(e.g., each day of fieldwork, each user in your database, or each month of the year)}.
\item
  Stage an empty data object (or multiple objects) in which you will store your summary.
\item
  Build a \texttt{for} loop to iterate through for each unique subgroup value (e.g., each sampling date or each user or each month).
\item
  In each iteration of the loop, subset your data to only the subgroup value of interest.
\item
  At the end of each iteration, update your data objects with the result from that iteration.
\item
  Run your `for loop!
\item
  After the \texttt{for} loop, combine your data objects into a dataframe.
\end{enumerate}

As you are building for loops, it can be very helpful to first start thinking about what needs to happen in each iteration of the loop. So first think about what needs to happen in \emph{Step 4}. Then you go through each step of this workflow to build a loop around that core code.

\hypertarget{example}{%
\subsubsection*{Example}\label{example}}
\addcontentsline{toc}{subsubsection}{Example}

The following scenario provides a concrete example of how to do this:

\textbf{Scenario:} You participate in a survey of flightless birds in the forests of New Zealand. You conduct thirty days of fieldwork on four species of bird: the kiwi, the weka, the kakapo (\emph{the world's heaviest parrot}), and the kea (\emph{the world's only alpine parrot}).

Your data (\href{https://github.com/databrew/intro-to-data-science/blob/main/nz_birds.csv?raw=true}{link to dataset}) look like this:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"./data/nz\_birds.csv"}\NormalTok{)}
\FunctionTok{nrow}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 406
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  day species group
1   1    Kiwi     3
2   1     Kea     4
3   1  Kakapo     4
4   1    Weka     2
5   1    Kiwi     1
6   1     Kea     3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{tail}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
    day species group
401  30    Weka     3
402  30    Kiwi     3
403  30    Kiwi     3
404  30  Kakapo     3
405  30  Kakapo     1
406  30     Kea     2
\end{verbatim}

Each row contains the data for a single bird group detection.

Your supervisor has tasked you with writing a report of your findings, and she wants to see a table with the number of each species seen on each day of the fieldwork.

You can use a \texttt{for} loop to make this table.

But first think about what needs to happen in each iteration of your loop. For each date in the dataset, you want to count the number of sightings for each species.

Let's build our core code using day 10 as a practice date:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Subset to day of interest}
\NormalTok{dayi }\OtherTok{\textless{}{-}} \DecValTok{10}
\NormalTok{dfi }\OtherTok{\textless{}{-}}\NormalTok{ df[df}\SpecialCharTok{$}\NormalTok{day }\SpecialCharTok{==}\NormalTok{ dayi,]}

\CommentTok{\# Tally up counts for each species}
\NormalTok{kiwi }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(}\FunctionTok{which}\NormalTok{(dfi}\SpecialCharTok{$}\NormalTok{species}\SpecialCharTok{==}\StringTok{"Kiwi"}\NormalTok{))}
\NormalTok{weka }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(}\FunctionTok{which}\NormalTok{(dfi}\SpecialCharTok{$}\NormalTok{species}\SpecialCharTok{==}\StringTok{"Weka"}\NormalTok{))}
\NormalTok{kakapo }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(}\FunctionTok{which}\NormalTok{(dfi}\SpecialCharTok{$}\NormalTok{species}\SpecialCharTok{==}\StringTok{"Kakapo"}\NormalTok{))}
\NormalTok{kea }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(}\FunctionTok{which}\NormalTok{(dfi}\SpecialCharTok{$}\NormalTok{species}\SpecialCharTok{==}\StringTok{"Kea"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

Okay! So our \texttt{for} loop needs to contain that basic code, with some minor adjustments in order to save the results from all iterations of the loop instead of just one.

Here is the full code for this \texttt{for} loop problem:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 1: determine the unique days in the dataset:}
\NormalTok{udays }\OtherTok{\textless{}{-}} \FunctionTok{unique}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{day)}

\CommentTok{\# 2: stage empty results vectors}
\NormalTok{kiwi }\OtherTok{\textless{}{-}}\NormalTok{ weka }\OtherTok{\textless{}{-}}\NormalTok{ kakapo }\OtherTok{\textless{}{-}}\NormalTok{ kea }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{()}

\CommentTok{\# (create a variable named i to help you test your code as you build it)}
\NormalTok{i}\OtherTok{=}\DecValTok{1} 

\CommentTok{\# 3: Start for loop. Loop through each unique day}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(udays))\{}
  
  \CommentTok{\# 4. Subset to day of interest}
\NormalTok{  dayi }\OtherTok{\textless{}{-}}\NormalTok{ udays[i] }
\NormalTok{  dfi }\OtherTok{\textless{}{-}}\NormalTok{ df[df}\SpecialCharTok{$}\NormalTok{day }\SpecialCharTok{==}\NormalTok{ dayi,]}
  
  \CommentTok{\# 5. Tally up birds, add to each vector}
\NormalTok{  kiwi[i] }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(}\FunctionTok{which}\NormalTok{(dfi}\SpecialCharTok{$}\NormalTok{species}\SpecialCharTok{==}\StringTok{"Kiwi"}\NormalTok{))}
\NormalTok{  weka[i] }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(}\FunctionTok{which}\NormalTok{(dfi}\SpecialCharTok{$}\NormalTok{species}\SpecialCharTok{==}\StringTok{"Weka"}\NormalTok{))}
\NormalTok{  kakapo[i] }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(}\FunctionTok{which}\NormalTok{(dfi}\SpecialCharTok{$}\NormalTok{species}\SpecialCharTok{==}\StringTok{"Kakapo"}\NormalTok{))}
\NormalTok{  kea[i] }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(}\FunctionTok{which}\NormalTok{(dfi}\SpecialCharTok{$}\NormalTok{species}\SpecialCharTok{==}\StringTok{"Kea"}\NormalTok{))}
  
\NormalTok{\}}

\CommentTok{\# 6. Run for loop}

\CommentTok{\# 7. Combine results into a dataframe}
\NormalTok{results }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{day=}\NormalTok{udays, kiwi, weka, kakapo, kea)}

\CommentTok{\# Check it out!}
\NormalTok{results}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   day kiwi weka kakapo kea
1    1    5    6      3   3
2    2    1    3      1   2
3    3    2    4      5   3
4    4    2    3      2   0
5    5    6    6      3   2
6    6    6    2      3   6
7    7    3    1      3   7
8    8    2    6      2   2
9    9    4    1      1   1
10  10    2    0      3   3
11  11    2    2      3   5
12  12    2    3      4   4
13  13    3    3      5   1
14  14    7    3      4   6
15  15    3    4      4   5
16  16    4    2      1   4
17  17    3    4      6   2
18  18    3    4      1   1
19  19    4    6      1   6
20  20    2    6      3   1
21  21    4    3      5   6
22  22    4    2      5   5
23  23    4    6      2   4
24  24    1    2      5   2
25  25    4    6      3   1
26  26    4    2      3   5
27  27    8    5      6   7
28  28    8    1      0   2
29  29    6    1      1   3
30  30    4    2      3   4
\end{verbatim}

\hypertarget{nested-for-loops}{%
\subsection*{\texorpdfstring{Nested \texttt{for} loops}{Nested for loops}}\label{nested-for-loops}}
\addcontentsline{toc}{subsection}{Nested \texttt{for} loops}

Sometimes you need to summarize your data in such a specific way that you will need to use \emph{nested} \texttt{for} loops, i.e., one \texttt{for} loop contained within another.

For example, your supervisor for the New Zealand Flightless Birds Survey has now taken an interest in associations among the four bird species you have been monitoring. For example, are kiwis more abundant on the days when you detect a lot of kakapos?

To answer this question, your supervisor wants to see a table with each species combination (Kiwi - Kakapo, Kiwi - Weka, \ldots{} Kakapo - Kea, etc.) and the number of dates in which both species were seen more than 5 times.

You can produce this table using a nested \texttt{for} loop. Here is how it's done:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{uspp }\OtherTok{\textless{}{-}} \FunctionTok{unique}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{species) }\CommentTok{\# get set of unique species}

\NormalTok{A }\OtherTok{\textless{}{-}}\NormalTok{ B }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{() }\CommentTok{\# empty vector for names of each species in the pair}
\NormalTok{X }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{() }\CommentTok{\# empty vector for number of dates in which both species were common}

\NormalTok{i}\OtherTok{=}\DecValTok{1}\NormalTok{ ; j}\OtherTok{=}\DecValTok{2}

\CommentTok{\# For loop 1}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(uspp))\{}
\NormalTok{  spi }\OtherTok{\textless{}{-}}\NormalTok{ uspp[i] }\CommentTok{\# species i}
\NormalTok{  dfi }\OtherTok{\textless{}{-}}\NormalTok{ df[df}\SpecialCharTok{$}\NormalTok{species }\SpecialCharTok{==}\NormalTok{ spi,] }\CommentTok{\# subset df to only this species}
\NormalTok{  counti }\OtherTok{\textless{}{-}} \FunctionTok{table}\NormalTok{(dfi}\SpecialCharTok{$}\NormalTok{day) }\CommentTok{\# get number of sightings on each day}
\NormalTok{  dayi }\OtherTok{\textless{}{-}} \FunctionTok{names}\NormalTok{(counti)[}\FunctionTok{which}\NormalTok{(counti }\SpecialCharTok{\textgreater{}=} \DecValTok{5}\NormalTok{)] ; }\CommentTok{\# get the dates on which this species was seen 5+ times}
  
  \CommentTok{\# For loop 2}
  \ControlFlowTok{for}\NormalTok{(j }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(uspp))\{}
\NormalTok{    spj }\OtherTok{\textless{}{-}}\NormalTok{ uspp[j] }\CommentTok{\# species j}
\NormalTok{    dfj }\OtherTok{\textless{}{-}}\NormalTok{ df[df}\SpecialCharTok{$}\NormalTok{species }\SpecialCharTok{==}\NormalTok{ spj,] }\CommentTok{\# subset df to only this species}
\NormalTok{    countj }\OtherTok{\textless{}{-}} \FunctionTok{table}\NormalTok{(dfj}\SpecialCharTok{$}\NormalTok{day) }\CommentTok{\# get number of sightings on each day}
\NormalTok{    dayj }\OtherTok{\textless{}{-}} \FunctionTok{names}\NormalTok{(countj)[}\FunctionTok{which}\NormalTok{(countj }\SpecialCharTok{\textgreater{}=} \DecValTok{5}\NormalTok{)] ; }\CommentTok{\# get the dates on which this species was seen 5+ times}
    
\NormalTok{    dates\_ij }\OtherTok{\textless{}{-}} \FunctionTok{which}\NormalTok{(dayi  }\SpecialCharTok{\%in\%}\NormalTok{ dayj) }\CommentTok{\# get the dates on which both species were seen 5+ times}
\NormalTok{    Xij }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(dates\_ij) }\CommentTok{\# count the number of these dates}
    
    \CommentTok{\# Add results to staged objects}
\NormalTok{    X }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(X,Xij) }
\NormalTok{    A }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(A,spi)}
\NormalTok{    B }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(B,spj)}
\NormalTok{  \}}

\NormalTok{\}}

\CommentTok{\# Combine results into a dataframe}
\NormalTok{results }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(A, B, X)}

\CommentTok{\# Check it out!}
\NormalTok{results}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   A B  X
1  3 3  7
2  3 2  3
3  3 1  1
4  3 4  3
5  2 3  3
6  2 2 10
7  2 1  3
8  2 4  2
9  1 3  1
10 1 2  3
11 1 1  7
12 1 4  1
13 4 3  3
14 4 2  2
15 4 1  1
16 4 4  8
\end{verbatim}

Note that the code for adding the results to the staged objects \texttt{X}, \texttt{A}, and \texttt{B} is contained within the second for loop. This is necessary for producing our results; if we put that code in the first for loop \emph{after} the code for the nested loop, our results would not be complete.

Note that each \texttt{for} loop \emph{must} use a different variable to represent each iteration. In this example, the first loop uses \texttt{i} and the second uses \texttt{j}. If we used \texttt{i} for both loops, \texttt{R} would get very confused indeed.

Also note that we used \texttt{i} and \texttt{j} in the variables specific to each loop (e.g., \texttt{dayi} and \texttt{dayj}), as a simple way to help us keep track of what each variable is representing.

\hypertarget{exercise-2-5}{%
\subsection*{Exercise 2}\label{exercise-2-5}}
\addcontentsline{toc}{subsection}{Exercise 2}

Your supervisor is happy with your pairwise species association dataframe, and wants to use it in an analysis for a publication. However, the \texttt{R} package she wants to use requires that the data be in the format of a square \emph{matrix} with four rows -- one for each species -- and four columns. Like this:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{results\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\ConstantTok{NA}\NormalTok{, }\AttributeTok{nrow=}\DecValTok{4}\NormalTok{, }\AttributeTok{ncol=}\DecValTok{4}\NormalTok{, }\AttributeTok{dimnames=}\FunctionTok{list}\NormalTok{(uspp,uspp))}
\NormalTok{results\_matrix}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
       Kiwi Kea Kakapo Weka
Kiwi     NA  NA     NA   NA
Kea      NA  NA     NA   NA
Kakapo   NA  NA     NA   NA
Weka     NA  NA     NA   NA
\end{verbatim}

You have not yet worked with matrices in this curriculum (you will in a few modules), but for now think of them as simple dataframes with a single type of data (e.g., all numeric values, like this one). You can subset matrices just as you would a dataframe: \texttt{matrix{[}row,column{]}}.

The values in this matrix should represent the number of dates in which each species pair was seen 5 times or more. For example, \texttt{result{[}1,2{]}} would be 3, since the Kiwi and Kea were seen 5+ times on only 3 dates.

She asks you to use the dataframe you just created to create this matrix. Use a nested for loop to do it.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Stage empty results objects}
\NormalTok{results\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\AttributeTok{data=}\ConstantTok{NA}\NormalTok{, }\AttributeTok{nrow=}\DecValTok{4}\NormalTok{, }\AttributeTok{ncol=}\DecValTok{4}\NormalTok{, }\AttributeTok{dimnames=}\FunctionTok{list}\NormalTok{(uspp,uspp))}

\CommentTok{\# Get unique species}
\NormalTok{uspp }\OtherTok{\textless{}{-}} \FunctionTok{unique}\NormalTok{(}\FunctionTok{c}\NormalTok{(results}\SpecialCharTok{$}\NormalTok{A,results}\SpecialCharTok{$}\NormalTok{B))}

\CommentTok{\# Loop 1: each species (row)}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(uspp))\{}
\NormalTok{  spi }\OtherTok{\textless{}{-}}\NormalTok{ uspp[i]}
\NormalTok{  resultsi }\OtherTok{\textless{}{-}}\NormalTok{ results[results}\SpecialCharTok{$}\NormalTok{A}\SpecialCharTok{==}\NormalTok{spi,] }\CommentTok{\# subset data to rows where column A equals species i}
  
  \CommentTok{\# Loop 2: each species (column)}
  \ControlFlowTok{for}\NormalTok{(j }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(uspp))\{}
\NormalTok{    spj }\OtherTok{\textless{}{-}}\NormalTok{ uspp[j]}
\NormalTok{    resultsj }\OtherTok{\textless{}{-}}\NormalTok{ resultsi[resultsi}\SpecialCharTok{$}\NormalTok{B}\SpecialCharTok{==}\NormalTok{spj,] }\CommentTok{\# subset data from i loop where column B equals species j}
    
\NormalTok{    Xij }\OtherTok{\textless{}{-}}\NormalTok{ resultsj}\SpecialCharTok{$}\NormalTok{X      }\CommentTok{\# Find result}

\NormalTok{    results\_matrix[i,j] }\OtherTok{\textless{}{-}}\NormalTok{ Xij     }\CommentTok{\# Add result to staged object}
\NormalTok{  \}}
\NormalTok{\}}

\NormalTok{results\_matrix}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
       Kiwi Kea Kakapo Weka
Kiwi      7   3      1    3
Kea       3  10      3    2
Kakapo    1   3      7    1
Weka      3   2      1    8
\end{verbatim}

Boom!

\hypertarget{review-assignment-8}{%
\section*{Review assignment}\label{review-assignment-8}}
\addcontentsline{toc}{section}{Review assignment}

First, read in and format some other cool data (\href{https://github.com/databrew/intro-to-data-science/blob/main/data/renewable_energy.csv?raw=true}{link to dataset}). The code for doing so is provided for you here:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"./data/renewable{-}energy.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

This dataset, freely available from World Bank, shows the renewable electricity output for various countries, presented as a percentage of the nation's total electricity output. They provide this data as a time series.

\hypertarget{summarize-columns-with-a-for-loop}{%
\subsection*{\texorpdfstring{Summarize columns with a \texttt{for\ loop}}{Summarize columns with a for loop}}\label{summarize-columns-with-a-for-loop}}
\addcontentsline{toc}{subsection}{Summarize columns with a \texttt{for\ loop}}

\textbf{Task 1:} Use a \texttt{for\ loop} to find the change in renewable energy output for each nation in the dataset between 1990 and 2015. Print the difference for each nation in the console.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Write your code here}
\NormalTok{i}\OtherTok{=}\DecValTok{2}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{2}\SpecialCharTok{:}\FunctionTok{ncol}\NormalTok{(df))\{}
\NormalTok{  dfi }\OtherTok{\textless{}{-}}\NormalTok{ df[,i] ; dfi}
\NormalTok{  diffi }\OtherTok{\textless{}{-}}\NormalTok{ dfi[}\FunctionTok{length}\NormalTok{(dfi)] }\SpecialCharTok{{-}}\NormalTok{ dfi[}\DecValTok{1}\NormalTok{] ; diffi}
  \FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\FunctionTok{names}\NormalTok{(df)[i],}\StringTok{" : "}\NormalTok{,}\FunctionTok{round}\NormalTok{(diffi),}\StringTok{"\% change."}\NormalTok{))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "World : 3% change."
[1] "Australia : 4% change."
[1] "Canada : 1% change."
[1] "China : 4% change."
[1] "Denmark : 62% change."
[1] "India : -9% change."
[1] "Japan : 5% change."
[1] "New_Zealand : 0% change."
[1] "Sweden : 12% change."
[1] "Switzerland : 7% change."
[1] "United_Kingdom : 23% change."
[1] "United_States : 2% change."
\end{verbatim}

\textbf{Task 2:} Re-do this loop, but instead of printing the differences to the console, save them in a vector.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Write your code here}
\NormalTok{diffs }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{()}
\NormalTok{i}\OtherTok{=}\DecValTok{2}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{2}\SpecialCharTok{:}\FunctionTok{ncol}\NormalTok{(df))\{}
\NormalTok{  dfi }\OtherTok{\textless{}{-}}\NormalTok{ df[,i] ; dfi}
\NormalTok{  diffi }\OtherTok{\textless{}{-}}\NormalTok{ dfi[}\FunctionTok{length}\NormalTok{(dfi)] }\SpecialCharTok{{-}}\NormalTok{ dfi[}\DecValTok{1}\NormalTok{] ; diffi}
\NormalTok{  diffs }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(diffs,diffi)}
\NormalTok{\}}
\NormalTok{diffs}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1]  3.49241703  3.98181045  0.63273122  3.51887728 62.33064943 -9.14624362
 [7]  4.73004321  0.07524008 12.26263811  7.21543884 23.01128298  1.69994636
\end{verbatim}

\hypertarget{multi-pane-plots-with-for-loops}{%
\subsection*{\texorpdfstring{Multi-pane plots with \texttt{for\ loops}}{Multi-pane plots with for loops}}\label{multi-pane-plots-with-for-loops}}
\addcontentsline{toc}{subsection}{Multi-pane plots with \texttt{for\ loops}}

\hypertarget{practice-with-a-single-plot}{%
\subsubsection*{Practice with a single plot}\label{practice-with-a-single-plot}}
\addcontentsline{toc}{subsubsection}{Practice with a single plot}

\textbf{Task 3:} First, get your bearings by figuring out how to use the \texttt{df} dataset to plot the time series for the United States, for the years 1990 - 2015. Label the x axis ``Year'' and the y axis ``\% Renewable''. Include the full name of the county as the \texttt{main} title for the plot.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Write code here}
\NormalTok{dfi }\OtherTok{\textless{}{-}}\NormalTok{ df[,}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{13}\NormalTok{)] }
\FunctionTok{plot}\NormalTok{(}\AttributeTok{x=}\NormalTok{dfi[,}\DecValTok{1}\NormalTok{],}
     \AttributeTok{y=}\NormalTok{dfi[,}\DecValTok{2}\NormalTok{],}
     \AttributeTok{type=}\StringTok{"l"}\NormalTok{,}\AttributeTok{lwd=}\DecValTok{2}\NormalTok{,}
     \AttributeTok{xlim=}\FunctionTok{c}\NormalTok{(}\DecValTok{1990}\NormalTok{,}\DecValTok{2015}\NormalTok{),}\AttributeTok{ylim=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{100}\NormalTok{),}
     \AttributeTok{xlab=}\StringTok{"Year"}\NormalTok{,}\AttributeTok{ylab=}\StringTok{"\% renewable"}\NormalTok{,}
     \AttributeTok{main=}\FunctionTok{names}\NormalTok{(dfi)[}\DecValTok{2}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-223-1.pdf}

\hypertarget{now-loop-it}{%
\subsubsection*{Now loop it!}\label{now-loop-it}}
\addcontentsline{toc}{subsubsection}{Now loop it!}

\textbf{Task 4:} Use that code as the foundation for building up a \texttt{for\ loop} that displays the same time series for every country in the dataset on a multi-pane graph that with 4 rows and 3 columns.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow=}\FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{,}\DecValTok{3}\NormalTok{))}
\NormalTok{i}\OtherTok{=}\DecValTok{3}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{2}\SpecialCharTok{:}\FunctionTok{ncol}\NormalTok{(df))\{}
\NormalTok{  dfi }\OtherTok{\textless{}{-}}\NormalTok{ df[,}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,i)] ; dfi}
  \FunctionTok{plot}\NormalTok{(}\AttributeTok{x=}\NormalTok{dfi[,}\DecValTok{1}\NormalTok{],}
       \AttributeTok{y=}\NormalTok{dfi[,}\DecValTok{2}\NormalTok{],}
       \AttributeTok{type=}\StringTok{"l"}\NormalTok{,}\AttributeTok{lwd=}\DecValTok{2}\NormalTok{,}
       \AttributeTok{xlim=}\FunctionTok{c}\NormalTok{(}\DecValTok{1990}\NormalTok{,}\DecValTok{2015}\NormalTok{),}\AttributeTok{ylim=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{100}\NormalTok{),}
       \AttributeTok{xlab=}\StringTok{"Year"}\NormalTok{,}\AttributeTok{ylab=}\StringTok{"\% renewable"}\NormalTok{,}
       \AttributeTok{main=}\FunctionTok{names}\NormalTok{(dfi)[}\DecValTok{2}\NormalTok{])}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-224-1.pdf}

\hypertarget{now-loop-it-in-layers}{%
\subsubsection*{\texorpdfstring{Now loop it \emph{in layers!}}{Now loop it in layers!}}\label{now-loop-it-in-layers}}
\addcontentsline{toc}{subsubsection}{Now loop it \emph{in layers!}}

\textbf{Task 5:} Now try a different presentation. Instead of producing 12 different plots, superimpose the time series for each country on the \emph{same single plot}.

To add some flare, highlight the USA curve by coloring it red and making it thicker.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{))}
\FunctionTok{plot}\NormalTok{(}\DecValTok{1}\NormalTok{,}\AttributeTok{type=}\StringTok{"n"}\NormalTok{,}\AttributeTok{lwd=}\DecValTok{2}\NormalTok{,}
     \AttributeTok{xlim=}\FunctionTok{c}\NormalTok{(}\DecValTok{1990}\NormalTok{,}\DecValTok{2015}\NormalTok{),}\AttributeTok{ylim=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{100}\NormalTok{),}
     \AttributeTok{xlab=}\StringTok{"Year"}\NormalTok{,}\AttributeTok{ylab=}\StringTok{"\% Renewable"}\NormalTok{)}

\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{2}\SpecialCharTok{:}\FunctionTok{ncol}\NormalTok{(df))\{}
\NormalTok{  dfi }\OtherTok{\textless{}{-}}\NormalTok{ df[,}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,i)] ; dfi}
  \FunctionTok{lines}\NormalTok{(dfi[,}\DecValTok{2}\NormalTok{]}\SpecialCharTok{\textasciitilde{}}\NormalTok{dfi[,}\DecValTok{1}\NormalTok{],}\AttributeTok{lwd=}\DecValTok{2}\NormalTok{,}\AttributeTok{col=}\FunctionTok{adjustcolor}\NormalTok{(}\StringTok{"black"}\NormalTok{,}\AttributeTok{alpha.f=}\NormalTok{.}\DecValTok{4}\NormalTok{))}
\NormalTok{\}}

\FunctionTok{lines}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{United\_States}\SpecialCharTok{\textasciitilde{}}\NormalTok{df}\SpecialCharTok{$}\NormalTok{year,}\AttributeTok{lwd=}\DecValTok{4}\NormalTok{,}\AttributeTok{col=}\StringTok{"firebrick"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-225-1.pdf}

\hypertarget{conditional-statements}{%
\chapter{Conditional statements}\label{conditional-statements}}

\hypertarget{learning-goals-13}{%
\section*{Learning goals}\label{learning-goals-13}}
\addcontentsline{toc}{section}{Learning goals}

\begin{itemize}
\tightlist
\item
  Understand what conditional statements are, and why they are so awesome.
\item
  Be able to write your own conditional statements in \texttt{R}.
\end{itemize}

\hypertarget{first-steps-1}{%
\section*{First steps}\label{first-steps-1}}
\addcontentsline{toc}{section}{First steps}

An example of a conditional statement is, \emph{``If \_\_\_\_\_\_ happens, do \_\_\_\_\_. Otherwise, do \_\_\_\_\_.''}

In \texttt{R} code, conditional statements work a similar way: they let a variable's value determine which process to carry out next.

Here is a basic example:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{4}

\ControlFlowTok{if}\NormalTok{(x}\SpecialCharTok{==}\DecValTok{3}\NormalTok{)\{}
  \FunctionTok{message}\NormalTok{(}\StringTok{"x is equal to 3!"}\NormalTok{)}
\NormalTok{\}}\ControlFlowTok{else}\NormalTok{\{}
  \FunctionTok{message}\NormalTok{(}\StringTok{"x does NOT equal 3!"}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Let's break this \texttt{if} statement down.

\begin{itemize}
\tightlist
\item
  The \texttt{if} command opens up a conditional statement.
\item
  The parenthetical \texttt{(x==3)} is where the logical test happens. If the result of this test is \texttt{TRUE}, then the \texttt{if} statement will be processed; if not, the \texttt{else} statement will be run instead.
\item
  The curly brackets, \texttt{\{\ \}} serve to contain the code that will be run, depending on the outcome of the logical test.
\item
  The \texttt{else} command indicates the start of the code that will be run if the logical test's result is \texttt{FALSE}.
\end{itemize}

This code ran the logical test \texttt{x==3}, determined its outcome to be \texttt{FALSE}, and so it skipped the \texttt{if} code and ran the \texttt{else} code instead.

Here is another example of the same idea:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{4}

\ControlFlowTok{if}\NormalTok{(x}\SpecialCharTok{==}\DecValTok{3}\NormalTok{)\{}
\NormalTok{  y }\OtherTok{\textless{}{-}} \DecValTok{100}
\NormalTok{\}}\ControlFlowTok{else}\NormalTok{\{}
\NormalTok{  y }\OtherTok{\textless{}{-}} \DecValTok{0}
\NormalTok{\}}

\NormalTok{y }\CommentTok{\# see what y is}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0
\end{verbatim}

Since \texttt{x==3} returned \texttt{FALSE}, \texttt{y} was defined as \texttt{0} instead of \texttt{100}.

Note that you do not need to define an \texttt{else} statement. If you do not, \texttt{R} will simply do nothing if the logical test is \texttt{FALSE}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{4}

\ControlFlowTok{if}\NormalTok{(x}\SpecialCharTok{==}\DecValTok{3}\NormalTok{)\{}
  \FunctionTok{message}\NormalTok{(}\StringTok{"x is equal to 3!"}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\emph{(Nothing happened)}

You can also feed the \texttt{if} statement a logical object instead of a test.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{4}
\NormalTok{x\_test }\OtherTok{\textless{}{-}}\NormalTok{ x }\SpecialCharTok{==} \DecValTok{3}
\NormalTok{x\_test }\CommentTok{\# check out the value of x\_stest}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] FALSE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{if}\NormalTok{(x\_test)\{}
  \FunctionTok{message}\NormalTok{(}\StringTok{"x is equal to 3!"}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Not that, since \texttt{x\_test} is a logical value (\texttt{TRUE} or \texttt{FALSE}), you do not need to write out a logical test within the \texttt{if} parenthetical. But you are free to do so if you wish:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{4}
\NormalTok{x\_test }\OtherTok{\textless{}{-}}\NormalTok{ x }\SpecialCharTok{==} \DecValTok{3}

\ControlFlowTok{if}\NormalTok{(x\_test }\SpecialCharTok{==} \ConstantTok{FALSE}\NormalTok{)\{}
  \FunctionTok{message}\NormalTok{(}\StringTok{"x is not equal to 3!"}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

This \texttt{if} statement is saying that, if it is \texttt{TRUE} that \texttt{x\_test} is \texttt{FALSE}, print a message saying so.

\hypertarget{exercise-1-6}{%
\subsection*{Exercise 1}\label{exercise-1-6}}
\addcontentsline{toc}{subsection}{Exercise 1}

Write out your own basic \texttt{if...else} statement and ensure that it works.

\hypertarget{next-steps-1}{%
\section*{Next steps}\label{next-steps-1}}
\addcontentsline{toc}{section}{Next steps}

\hypertarget{nested-conditions}{%
\subsection*{Nested conditions}\label{nested-conditions}}
\addcontentsline{toc}{subsection}{Nested conditions}

You can nest conditional statements within others as many times as you wish:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{6}

\ControlFlowTok{if}\NormalTok{(x}\SpecialCharTok{==}\DecValTok{3}\NormalTok{)\{}
  \FunctionTok{message}\NormalTok{(}\StringTok{"x equals 3"}\NormalTok{)}
\NormalTok{\}}\ControlFlowTok{else}\NormalTok{\{}
  \ControlFlowTok{if}\NormalTok{(x }\SpecialCharTok{\textless{}} \DecValTok{3}\NormalTok{)\{}
    \FunctionTok{message}\NormalTok{(}\StringTok{"x is less than 3"}\NormalTok{)}
\NormalTok{  \}}\ControlFlowTok{else}\NormalTok{\{  }
    \FunctionTok{message}\NormalTok{(}\StringTok{"x is greater than 3"}\NormalTok{)}
\NormalTok{  \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Note that every open bracket, \texttt{\{}, needs a corresponding closing bracket ,\texttt{\}}. Most errors associated with \texttt{if} statements involve missing brackets.

\hypertarget{handling-nas-nans-infs-and-nulls}{%
\subsection*{\texorpdfstring{Handling \texttt{NA}s, \texttt{NaN}'s, \texttt{Inf}s, and \texttt{NULL}s}{Handling NAs, NaN's, Infs, and NULLs}}\label{handling-nas-nans-infs-and-nulls}}
\addcontentsline{toc}{subsection}{Handling \texttt{NA}s, \texttt{NaN}'s, \texttt{Inf}s, and \texttt{NULL}s}

\texttt{if} statements can be particularly helpful when your dataset contains missing or broken values. \texttt{R} includes base functions that help you carry out logical tests concerning missing values. These three test below can be very helpful within \texttt{if} statements.

\textbf{\texttt{is.finite()}} tests whether a numeric object is a real, finite number.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{0}
\FunctionTok{is.finite}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y }\OtherTok{\textless{}{-}} \DecValTok{10}\SpecialCharTok{/}\NormalTok{x}
\NormalTok{y}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] Inf
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{is.finite}\NormalTok{(y)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] FALSE
\end{verbatim}

Here is an \texttt{if} statement making use of \texttt{is.finite()}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{0}
\NormalTok{y }\OtherTok{\textless{}{-}} \DecValTok{10}\SpecialCharTok{/}\NormalTok{x}
\ControlFlowTok{if}\NormalTok{(}\FunctionTok{is.finite}\NormalTok{(y))\{}
  \FunctionTok{message}\NormalTok{(}\StringTok{"y is indeed a finite number!"}\NormalTok{)}
\NormalTok{\}}\ControlFlowTok{else}\NormalTok{\{}
  \FunctionTok{message}\NormalTok{(}\StringTok{"y is not a finite number!"}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\textbf{\texttt{is.na()}} tests whether a variable contains a missing or broken object.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \StringTok{"eric"}
\FunctionTok{is.na}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] FALSE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(x) }\CommentTok{\# try converting \textasciigrave{}x\textasciigrave{} to a numeric value}
\FunctionTok{is.na}\NormalTok{(y)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{is.finite}\NormalTok{(y)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] FALSE
\end{verbatim}

\texttt{NA} stands for \emph{``Not Available''}. \texttt{NaN} is also a common sign of a broken value. It stands for \emph{Not a Number}.

\textbf{\texttt{is.null()}} tests whether a variable is empty. That is, it has been initiated, but it contains no data.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{,}\DecValTok{7}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{5}\NormalTok{) }\CommentTok{\# make a vector of numbers}
\FunctionTok{is.null}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] FALSE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{() }\CommentTok{\# make an empty vector}
\FunctionTok{is.null}\NormalTok{(y)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\hypertarget{joint-conditions}{%
\subsection*{Joint conditions}\label{joint-conditions}}
\addcontentsline{toc}{subsection}{Joint conditions}

\texttt{if} statements can also accommodate joint logical tests. For example, the follow \texttt{if} statement only returns if a message if \emph{two} tests are true:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{6}
\ControlFlowTok{if}\NormalTok{(}\FunctionTok{is.finite}\NormalTok{(x) }\SpecialCharTok{\&}\NormalTok{ x}\SpecialCharTok{==}\DecValTok{6}\NormalTok{)\{}
  \FunctionTok{message}\NormalTok{(}\StringTok{"x is real and equals 6"}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

The next \texttt{if} statement returns a message if either of the logical statements are true:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{6}
\ControlFlowTok{if}\NormalTok{(x}\SpecialCharTok{==}\DecValTok{3} \SpecialCharTok{|}\NormalTok{ x}\SpecialCharTok{==}\DecValTok{6}\NormalTok{)\{}
  \FunctionTok{message}\NormalTok{(}\StringTok{"x is equal to either 3 or 6"}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\hypertarget{exercise-2-6}{%
\subsection*{Exercise 2}\label{exercise-2-6}}
\addcontentsline{toc}{subsection}{Exercise 2}

Write a nested \texttt{if} statement that produces a message reporting the hemisphere for any GPS position you provide it (a pair of latitude and longitude coordinates, in decimal degrees). The four hemisphere options are as follows:

\begin{itemize}
\tightlist
\item
  \emph{Northwest} (positive latitudes and negative longitudes, e.g., USA)\\
\item
  \emph{Northeast} (positive latitudes and longitudes, e.g., Russia)
\item
  \emph{Southwest} (negative latitudes and longitudes, e.g., Brazil)\\
\item
  \emph{Southeast} (negative latitudes and positive longitudes, e.g., New Zealand).
\end{itemize}

Include the ability to handle missing values (i.e., if an \texttt{NA} is provided, return a message saying that values are missing and the hemisphere cannot be determined.)

Provide five examples that demonstrate the functionality for all the possible message options.

\hypertarget{review-assignment-9}{%
\section*{Review assignment}\label{review-assignment-9}}
\addcontentsline{toc}{section}{Review assignment}

\textbf{Note:} This exercise will combine all the skills you've learned for \texttt{for} loops, \texttt{if} statements, \emph{and} writing functions into a real-world data science scenario. Buckle up!

You are working at the Center for Disease Control. Your supervisor has asked you to take a look at state-level data on infectious diseases within the United States in the last century. Specifically, she wants you to address the following questions and requests:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  In the last 90 years, which states have had the highest average prevalence of \textbf{measles}, \textbf{pertussis} (whooping cough), and \textbf{smallpox} in proportion to their population sizes? Which have had the lowest?
\item
  Provide beautiful plots showing trends in the prevalence of these diseases over the last century. Produce a single plot for each state, with three lines representing the time series for each disease of interest. Save each plot as a \texttt{pdf} into a folder named \texttt{state-level-summaries}. Name each \texttt{pdf} using the state's name.
\end{enumerate}

To do this work, your supervisor asks you to use the \texttt{us\_contagious\_diseases} dataset contained within the \texttt{R} package \texttt{dslabs}, which contains disease data from 1928-2011 for all states. To make sure the numbers reflect actual patterns, she asks you to only use prevalence numbers for years in which counts were made in more than 20 weeks out of the year.

\hypertarget{other-resources-9}{%
\section*{Other Resources}\label{other-resources-9}}
\addcontentsline{toc}{section}{Other Resources}

\emph{NOTE: Under construction!}

\hypertarget{working-with-text}{%
\chapter{Working with text}\label{working-with-text}}

\hypertarget{learning-goals-14}{%
\section*{Learning goals}\label{learning-goals-14}}
\addcontentsline{toc}{section}{Learning goals}

\begin{itemize}
\tightlist
\item
  Learn to apply the most common \texttt{R} tools for working with text.
\end{itemize}

\hypertarget{basics-1}{%
\section*{Basics}\label{basics-1}}
\addcontentsline{toc}{section}{Basics}

If you do not learn how to edit and transform text-based fields within datasets, you will quickly get stuck in \texttt{R}. Think of dates, GPS coordinates, user IDs, group names, plot labels, \emph{etc.} All of these forms of data can contain non-numeric text. Becoming comfortable working with text in \texttt{R} is an essential part of your \texttt{R} toolbag.

Here we will present the most common functions for working with text. Remember that \texttt{R} has a special object class for text, known to as \textbf{character} class, and that character objects are often referred to as \textbf{strings}.

Most of these functions come pre-installed in \texttt{R}. However, several of the tools we will show here (as well as many other useful tools that we will not detail here) come from the \textbf{\texttt{stringr} package}. Go ahead an install \texttt{stringr} and load it using \texttt{library()}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"stringr"}\NormalTok{)}
\FunctionTok{library}\NormalTok{(stringr)}
\end{Highlighting}
\end{Shaded}

\hypertarget{common-tools}{%
\section*{Common tools}\label{common-tools}}
\addcontentsline{toc}{section}{Common tools}

\textbf{\texttt{as.character()}}: converts a non-character object into a character string.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{)}
\FunctionTok{as.character}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "1" "2" "3"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{as.factor}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"group1"}\NormalTok{,}\StringTok{"group2"}\NormalTok{,}\StringTok{"group3"}\NormalTok{))}
\FunctionTok{as.character}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "group1" "group2" "group3"
\end{verbatim}

This can be particularly useful when trying to resolve problems caused by factors. One common issue occurs when \texttt{R} mistakes a set of numbers as a set of factors. Using \texttt{as.character()} can set things right:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{as.factor}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{18}\NormalTok{,}\DecValTok{19}\NormalTok{,}\DecValTok{20}\NormalTok{))}
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 18 19 20
Levels: 18 19 20
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# If you try to convert straight to numeric, it does not work:}
\FunctionTok{as.numeric}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1 2 3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# So convert to character first}
\FunctionTok{as.numeric}\NormalTok{(}\FunctionTok{as.character}\NormalTok{(x))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 18 19 20
\end{verbatim}

\textbf{\texttt{paste()}} and \textbf{\texttt{paste0()}} combines two ore more strings together into a single object:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{i }\OtherTok{\textless{}{-}} \DecValTok{10}
\NormalTok{n }\OtherTok{\textless{}{-}} \DecValTok{96}
\NormalTok{file\_name }\OtherTok{\textless{}{-}} \StringTok{"this\_file.csv"}

\FunctionTok{paste}\NormalTok{(i,}\StringTok{"of"}\NormalTok{,n,}\StringTok{": Processing"}\NormalTok{,file\_name,}\StringTok{". . . "}\NormalTok{) }\CommentTok{\# paste assumes each object is separated by " ".}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "10 of 96 : Processing this_file.csv . . . "
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{paste0}\NormalTok{(i,}\StringTok{"of"}\NormalTok{,n,}\StringTok{": Processing"}\NormalTok{,file\_name,}\StringTok{". . . "}\NormalTok{) }\CommentTok{\# paste0 assumes no space between objects.}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "10of96: Processingthis_file.csv. . . "
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{paste0}\NormalTok{(i,}\StringTok{" of "}\NormalTok{,n,}\StringTok{": Processing "}\NormalTok{,file\_name,}\StringTok{" . . . "}\NormalTok{) }\CommentTok{\# this paste0 version matches the initial format}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "10 of 96: Processing this_file.csv . . . "
\end{verbatim}

You can also use \texttt{paste()} to \texttt{collapse} multiple objects into a single string.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}
\FunctionTok{paste}\NormalTok{(x,}\AttributeTok{collapse=}\StringTok{"{-}"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "1-2-3-4-5-6-7-8-9-10"
\end{verbatim}

\textbf{\texttt{tolower()}} and \textbf{\texttt{toupper()}} forces all text in a string to lower case or upper case, respectively:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \StringTok{"That Tree Is Far Away."}
\FunctionTok{tolower}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "that tree is far away."
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{toupper}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "THAT TREE IS FAR AWAY."
\end{verbatim}

\textbf{\texttt{nchar()}} returns the number of characters within a string:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \StringTok{"That Tree Is Far Away."}
\FunctionTok{nchar}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 22
\end{verbatim}

\textbf{\texttt{substr()}} trims a string according to a start and end character position:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dates }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"2021{-}03{-}01"}\NormalTok{,}\StringTok{"2021{-}03{-}02"}\NormalTok{,}\StringTok{"2021{-}03{-}03"}\NormalTok{)}
\FunctionTok{substr}\NormalTok{(dates,}\DecValTok{1}\NormalTok{,}\DecValTok{4}\NormalTok{) }\CommentTok{\# years}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "2021" "2021" "2021"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{substr}\NormalTok{(dates,}\DecValTok{6}\NormalTok{,}\DecValTok{7}\NormalTok{) }\CommentTok{\# months}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "03" "03" "03"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{substr}\NormalTok{(dates,}\DecValTok{9}\NormalTok{,}\DecValTok{10}\NormalTok{) }\CommentTok{\# days}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "01" "02" "03"
\end{verbatim}

\textbf{\texttt{grep()}} returns the elements in a character vector that contain a given pattern:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{years }\OtherTok{\textless{}{-}} \DecValTok{1900}\SpecialCharTok{:}\DecValTok{1999}

\CommentTok{\# Which elements correspodn to the 1980s?}
\NormalTok{eighties }\OtherTok{\textless{}{-}} \FunctionTok{grep}\NormalTok{(}\StringTok{"198"}\NormalTok{,years)}

\NormalTok{years[eighties]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1] 1980 1981 1982 1983 1984 1985 1986 1987 1988 1989
\end{verbatim}

\textbf{\texttt{gsub()}} replaces a given pattern with another in a character vector.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dates }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"2021{-}03{-}01"}\NormalTok{,}\StringTok{"2021{-}03{-}02"}\NormalTok{,}\StringTok{"2021{-}03{-}03"}\NormalTok{)}
\FunctionTok{gsub}\NormalTok{(}\StringTok{"{-}"}\NormalTok{,}\StringTok{"/"}\NormalTok{,dates)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "2021/03/01" "2021/03/02" "2021/03/03"
\end{verbatim}

\textbf{\texttt{stringr::str\_pad()}}: standardize the lengths of strings by ``padding'' it (e.g., with zeroes) :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{days }\OtherTok{\textless{}{-}} \FunctionTok{as.character}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{15}\NormalTok{)}
\NormalTok{days}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1] "1"  "2"  "3"  "4"  "5"  "6"  "7"  "8"  "9"  "10" "11" "12" "13" "14" "15"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{stringr}\SpecialCharTok{::}\FunctionTok{str\_pad}\NormalTok{(days,}\AttributeTok{width=}\DecValTok{2}\NormalTok{,}\AttributeTok{side=}\StringTok{"left"}\NormalTok{,}\AttributeTok{pad=}\StringTok{"0"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1] "01" "02" "03" "04" "05" "06" "07" "08" "09" "10" "11" "12" "13" "14" "15"
\end{verbatim}

\textbf{\texttt{stringr::str\_split()}}: split a string into several strings at the occurrence of a specified character.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dates }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"2021{-}03{-}01"}\NormalTok{,}\StringTok{"2021{-}03{-}02"}\NormalTok{,}\StringTok{"2021{-}03{-}03"}\NormalTok{)}
\NormalTok{splits }\OtherTok{\textless{}{-}}\NormalTok{ stringr}\SpecialCharTok{::}\FunctionTok{str\_split}\NormalTok{(dates,}\StringTok{"{-}"}\NormalTok{)}
\NormalTok{splits}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[[1]]
[1] "2021" "03"   "01"  

[[2]]
[1] "2021" "03"   "02"  

[[3]]
[1] "2021" "03"   "03"  
\end{verbatim}

This function returns a \emph{list} for every element in the original vector. A common need is to retrieve one item from each of the element in this list. For example, let's say you are trying to retrieve the months of each element in the \texttt{dates} vector. The list structure makes this tricky to retrieve. Here's the way to do it by drawing upon the \texttt{apply()} family of functions:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sapply}\NormalTok{(splits, }\StringTok{"[["}\NormalTok{, }\DecValTok{2}\NormalTok{) }\CommentTok{\# Months}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "03" "03" "03"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# now get years and days}
\FunctionTok{sapply}\NormalTok{(splits, }\StringTok{"[["}\NormalTok{, }\DecValTok{1}\NormalTok{) }\CommentTok{\# years}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "2021" "2021" "2021"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sapply}\NormalTok{(splits, }\StringTok{"[["}\NormalTok{, }\DecValTok{3}\NormalTok{) }\CommentTok{\# days}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "01" "02" "03"
\end{verbatim}

\hypertarget{review-assignment-10}{%
\section*{Review assignment}\label{review-assignment-10}}
\addcontentsline{toc}{section}{Review assignment}

A. For a given dataset, print informative status update for each iteration in a \texttt{for} loop.

B. Modify the above to only print an update at every integer percentage point (i.e., at 1\% and 2\% but not at 1.233\%, etc.)

C. Your collaborator sends you a dataset containing columns for \texttt{Date}, \texttt{Latitude}, and \texttt{Longitude}. Formatting varies in these fields. Fix it. (can use hw-raw.csv file. - Eric)

\hypertarget{working-with-dates-times}{%
\chapter{Working with dates \& times}\label{working-with-dates-times}}

\hypertarget{working-with-factors}{%
\chapter{Working with factors}\label{working-with-factors}}

\hypertarget{cleaning-messy-data}{%
\chapter{Cleaning messy data}\label{cleaning-messy-data}}

\hypertarget{matrices-lists}{%
\chapter{Matrices \& lists}\label{matrices-lists}}

\hypertarget{pipes}{%
\chapter{Pipes}\label{pipes}}

\hypertarget{excel-files-googlesheets}{%
\chapter{Excel files \& GoogleSheets}\label{excel-files-googlesheets}}

\hypertarget{learning-goals-15}{%
\section*{Learning goals}\label{learning-goals-15}}
\addcontentsline{toc}{section}{Learning goals}

\hypertarget{review-exercise-3}{%
\section*{Review exercise}\label{review-exercise-3}}
\addcontentsline{toc}{section}{Review exercise}

\hypertarget{part-interactive-dashboards}{%
\part{Interactive dashboards}\label{part-interactive-dashboards}}

\hypertarget{intro-to-shiny-apps}{%
\chapter{Intro to Shiny apps}\label{intro-to-shiny-apps}}

\hypertarget{shiny-dashboards}{%
\chapter{Shiny dashboards}\label{shiny-dashboards}}

\hypertarget{data-entry-apps}{%
\chapter{Data entry apps}\label{data-entry-apps}}

\hypertarget{part-databases}{%
\part{Databases}\label{part-databases}}

\hypertarget{introduction-1}{%
\chapter{Introduction}\label{introduction-1}}

\hypertarget{what}{%
\section{What}\label{what}}

\hypertarget{why}{%
\section{Why}\label{why}}

\hypertarget{when}{%
\section{When}\label{when}}

\hypertarget{when-not}{%
\section{When not}\label{when-not}}

\hypertarget{platforms}{%
\chapter{Platforms}\label{platforms}}

\hypertarget{postgresql}{%
\section{PostgreSQL}\label{postgresql}}

\hypertarget{mysql}{%
\section{mySQL}\label{mysql}}

\hypertarget{sqlite}{%
\section{SQLite}\label{sqlite}}

\hypertarget{alternatives}{%
\chapter{Alternatives}\label{alternatives}}

\hypertarget{nosql}{%
\section{NoSQL}\label{nosql}}

\hypertarget{practices}{%
\chapter{Practices}\label{practices}}

Spinning up a local DB

\hypertarget{part-documenting-your-work}{%
\part{Documenting your work}\label{part-documenting-your-work}}

\hypertarget{r-markdown}{%
\chapter{R Markdown}\label{r-markdown}}

\hypertarget{reproducible-research}{%
\chapter{Reproducible research}\label{reproducible-research}}

\hypertarget{automated-reporting}{%
\chapter{Automated reporting}\label{automated-reporting}}

\hypertarget{formatting-standards}{%
\chapter{Formatting standards}\label{formatting-standards}}

\hypertarget{tables-1}{%
\section{Tables}\label{tables-1}}

\hypertarget{figures}{%
\section{Figures}\label{figures}}

\hypertarget{captions}{%
\section{Captions}\label{captions}}

\hypertarget{git}{%
\chapter{Git}\label{git}}

\hypertarget{part-version-control-and-teamwork}{%
\part{Version control and teamwork}\label{part-version-control-and-teamwork}}

\hypertarget{how-most-people-do-version-control}{%
\chapter*{How most people do version control}\label{how-most-people-do-version-control}}
\addcontentsline{toc}{chapter}{How most people do version control}

Perhaps the below is familiar to you\ldots{}

\includegraphics{img/version_control.png}

Or this\ldots{}

\includegraphics{img/version_control_2.png}

\hypertarget{there-is-a-better-way}{%
\chapter*{There is a better way}\label{there-is-a-better-way}}
\addcontentsline{toc}{chapter}{There is a better way}

Version control systems (VCS) are software tools meant to help programmers collaborate, maintain source code, document changes, and generally keep track of their files. Instead of reading, sit back and watch \href{https://youtu.be/9GKpbI1siow}{this video}.

Having a working knowledge of a version control system will allow you to better organize and track your own files, as well as collaborate on teams. Though there are lots of different systems out there, the most popular version control system is ``git''. Let's dive in (next chapter).

\hypertarget{what-is-git}{%
\section*{What is git?}\label{what-is-git}}
\addcontentsline{toc}{section}{What is git?}

Git is a software for ``version control'': ie, tracking changes to sets of files. It is a very commonly used tool in programming, computer science, data science, and software development in general. For anyone working in data science, knowing git is a must.

But \emph{what is it}, exactly? Git is a system for tracking, organizing, sharing, and reviewing changes to software. It's very flexible, and very powerful. And learning it can sometimes feel a bit overwhelming, because it has so many features and capabilities. But the \href{https://en.wikipedia.org/wiki/Pareto_principle}{Pareto principle} (ie, the 80/20 rule) applies here: most of what you need to know to competently handle git, you can do in very little time.

\hypertarget{why-1}{%
\section*{Why?}\label{why-1}}
\addcontentsline{toc}{section}{Why?}

Why use git? Why not just save files with meaningful names, make changes to them, overwrite the old changes, etc.? Why not just treat code the same way we treat a MS Word document, or write code collaboratively using interactive, auto-saving tools like Google Docs?

There are a number reasons:

\begin{itemize}
\tightlist
\item
  First, writing code is not like writing a paper. If you make a mistake in the introduction of a term paper, it doesn't ``break'' your conclusion. But with code, minor changes to one line of code can have a very large impact on how other parts of that code work. Therefore, tracking minor changes is essential to recovering from errors and managing complex, interdependent software components.\\
\item
  Second, collaborating on code is more complex than collaborating on a term paper. To combine (merge) one person's work with another often requires very careful review. Git optimizes for this.\\
\item
  Third, code is rarely ``done''. It's usually a work in progress. Git takes this into account, and is set up for very structured checkpoints (commits), change suggestions (pull requests), etc.
\item
  Finally, git is the ``lingua franca'' of version control. Employers often request to see a prospective employee's github profile, and expect that programmers and developers of all types (including data scientists) be proficient in git.
\end{itemize}

\hypertarget{get-ready-for-git}{%
\section*{Get ready for git}\label{get-ready-for-git}}
\addcontentsline{toc}{section}{Get ready for git}

It's time to ``git'' started. Rather than diving into too much theory, let's skip right to the practice. Like this:

\includegraphics{img/git.png}

\hypertarget{installation}{%
\section*{Installation}\label{installation}}
\addcontentsline{toc}{section}{Installation}

We'll start by installing git. Go \href{https://git-scm.com/book/en/v2/Getting-Started-Installing-Git}{here} and follow the instructions for your operating system.

Note that we'll be using the command line interface (CLI) and not a graphical user interface (GUI). Though a GUI is sometimes a bit easier, a CLI offers more flexibility and power.

\hypertarget{configuration}{%
\section*{Configuration}\label{configuration}}
\addcontentsline{toc}{section}{Configuration}

Once you've installed git, you'll likely want to configure some options and preferences. Go \href{https://git-scm.com/book/en/v2/Getting-Started-First-Time-Git-Setup}{here} and walk through the steps.

\hypertarget{github}{%
\section*{Github}\label{github}}
\addcontentsline{toc}{section}{Github}

Now you've got git. Great! Git is often used in conjunction with a third party, web-based platform. The most popular is github. Go to www.github.com and create a user account.

\hypertarget{creating-a-repository}{%
\subsection*{Creating a repository}\label{creating-a-repository}}
\addcontentsline{toc}{subsection}{Creating a repository}

Once you've created an account and logged in, let's create a repository. What is a repository? Basically, it's a project in the form of a folder. Having logged into git, click the ``plus'' icon in the upper right and then click ``New repository'' (or go directly \href{https://github.com/new}{here}).

You can fill in the ``Repository name'' field with whatever you'd like. For the following examples, we'll use the word ``testrepo''.

Fill in the ``Description'' field with the word ``My first git repository''.

Set the repo as ``Public'' (unless you plan on putting any secrets here!), and then click the ``Add a README file'' checkbox. Finally, click ``Create repository''.

Cool! You've now created your first git repository. It's public url is \url{https://github.com/}/testrepo. Others can see your code there, and you can too.

\hypertarget{cloning-a-repository}{%
\subsection*{Cloning a repository}\label{cloning-a-repository}}
\addcontentsline{toc}{subsection}{Cloning a repository}

``testrepo'' exists on the internet, but does not yet exist on your local machine. In order to get ``testrepo'' on your computer, you'll need to do something that you'll only do once: ``clone'' the repo. ``Cloning'' in git-speak means creating a copy of the repository locally.

To clone, you'll first open your terminal window and \texttt{cd} into a directory where you'd like to clone your repo. For example, if you want to put your \texttt{testrepo} directory into \texttt{\textasciitilde{}/Documents}, you'll type the below into terminal:

\begin{verbatim}
cd ~/Documents
\end{verbatim}

You can confirm that you are in \texttt{\textasciitilde{}/Documents} by typing: \texttt{pwd}. There? Good.

Now, we'll write the code to ``clone'' \texttt{testrepo}:

\begin{verbatim}
git clone https://github.com/<USERNAME>/testrepo
\end{verbatim}

Now, you've got a folder on your machine named \texttt{testrepo}. You can confirm this by writing \texttt{ls} in the terminal.
See \texttt{testrepo} there? Great!

\hypertarget{writing-some-code}{%
\subsection*{Writing some code}\label{writing-some-code}}
\addcontentsline{toc}{subsection}{Writing some code}

In your local \texttt{testrepo} folder, you have a ``cloned'' copy of the repository at \url{https://github.com/}/testrepo. As of now, it's a pretty uninteresting folder. The only thing in it is a file named \texttt{README.md}. A ``README'' file is generally an explanation of a repository's content, purpose, etc. Like all files, a README can be tracked in git.

Let's open the README file and make a change to it. We'll add the below line of ``code'':

\begin{verbatim}
This is my first git repository.
\end{verbatim}

The save and close the README file.

Now, let's ask ``git'' if it noticed if we had made any changes. Type the below into terminal:

\begin{verbatim}
git status
\end{verbatim}

If everything has gone well until now, git will reply by telling us that we've made a change to the file. We can ask git \emph{what} change we made by typing:

\begin{verbatim}
git diff README.md
\end{verbatim}

\texttt{diff} stands for ``difference'', as in "what is the difference between the code I had and the code I have. Git will spit back some color-coded lines showing the change you've made.

Satisfied with your change? Great, now it's time to confirm it by doing the following:

\begin{verbatim}
git add README.md
\end{verbatim}

This tells git that we want it to notice and track the change we made to \texttt{README.md}. Then:

\begin{verbatim}
git commit -m 'my first change'
\end{verbatim}

This tells git that we are ``committing'' our change, it marking a checkpoint (to which we can revert later). The \texttt{-m} flag is followed by a message in quotations which will help us to navigate this checkpoint in the future.

Almost there. Now that we've added and committed, we need to ``push'' our change to the remote repository (github), by running:

\begin{verbatim}
git push
\end{verbatim}

You did it! Now, if someone else wants to get your code, they can ``clone'' your repository, and they'll have the code you've ``pushed'' there.

\hypertarget{a-bit-more-practice}{%
\section*{A bit more practice}\label{a-bit-more-practice}}
\addcontentsline{toc}{section}{A bit more practice}

(Under construction)

\hypertarget{branching}{%
\section*{Branching}\label{branching}}
\addcontentsline{toc}{section}{Branching}

(Under construction)

\hypertarget{pull-requests}{%
\section*{Pull requests}\label{pull-requests}}
\addcontentsline{toc}{section}{Pull requests}

(Under construction)

\hypertarget{advanced-git}{%
\section*{Advanced git}\label{advanced-git}}
\addcontentsline{toc}{section}{Advanced git}

(Under construction)

\hypertarget{part-writing-about-data}{%
\part{Writing about data}\label{part-writing-about-data}}

\hypertarget{types-of-writing}{%
\chapter{Types of writing}\label{types-of-writing}}

\hypertarget{grant-proposals}{%
\section{Grant proposals}\label{grant-proposals}}

\hypertarget{reports-and-publications}{%
\section{Reports and publications}\label{reports-and-publications}}

\hypertarget{fundraising}{%
\section{Fundraising}\label{fundraising}}

\hypertarget{press-releases}{%
\section{Press releases}\label{press-releases}}

\hypertarget{elements-of-style}{%
\chapter{Elements of style}\label{elements-of-style}}

\hypertarget{sections-of-a-report}{%
\chapter{Sections of a report}\label{sections-of-a-report}}

\hypertarget{abstract}{%
\section{Abstract}\label{abstract}}

\hypertarget{introduction-2}{%
\section{Introduction}\label{introduction-2}}

\hypertarget{methods}{%
\section{Methods}\label{methods}}

\hypertarget{results}{%
\section{Results}\label{results}}

\hypertarget{discussion}{%
\section{Discussion}\label{discussion}}

\hypertarget{other-elements}{%
\section{Other elements}\label{other-elements}}

\hypertarget{acknowledgments}{%
\subsection{Acknowledgments}\label{acknowledgments}}

\hypertarget{literature-cited}{%
\subsection{Literature Cited}\label{literature-cited}}

\hypertarget{tables-2}{%
\subsection{Tables}\label{tables-2}}

\hypertarget{figures-1}{%
\subsection{Figures}\label{figures-1}}

\hypertarget{supplementary-materials}{%
\subsection{Supplementary Materials}\label{supplementary-materials}}

\hypertarget{part-creating-websites}{%
\part{Creating websites}\label{part-creating-websites}}

\hypertarget{part-advanced-skills}{%
\part{Advanced skills}\label{part-advanced-skills}}

\hypertarget{mapping}{%
\chapter{Mapping}\label{mapping}}

\hypertarget{geographic-computing-gis}{%
\chapter{Geographic computing \& GIS}\label{geographic-computing-gis}}

\hypertarget{statistical-modeling}{%
\chapter{Statistical modeling}\label{statistical-modeling}}

\hypertarget{apply-family}{%
\chapter{Apply family}\label{apply-family}}

\hypertarget{randomization-statistics}{%
\chapter{Randomization statistics}\label{randomization-statistics}}

\hypertarget{learning-goals-16}{%
\section*{Learning goals}\label{learning-goals-16}}
\addcontentsline{toc}{section}{Learning goals}

\begin{itemize}
\tightlist
\item
  Understand what randomization analyses are, and why they are awesome.
\item
  Use randomization to determine if an outcome is significantly unexpected.
\item
  Use randomization to compare two distributions.
\item
  Use randomization to ask whether two variables are correlated
\item
  Use randomization to determine the chances that a correlation is declining or increasing.
\end{itemize}

\hypertarget{basic-idea}{%
\section*{Basic idea}\label{basic-idea}}
\addcontentsline{toc}{section}{Basic idea}

Classic significance statistics (i.e., p-values) are based on the frequentist framework in which you \emph{estimate} the probability of an \emph{observed} outcome to what would be \emph{expected} if a null hypothesis were true. In a t-test, for example, you are asking, ``What are the chances of observing what I have if these two sample sets were not meaningfully different?''

The key word in that first sentence is \emph{estimate}. When frequentist theory was originally developed, statisticians did not have computers capable of generating vast amounts of random numbers. So they had to \emph{estimate} p-values by developing strict rules and expectations about the way data are distributed. These rules had the result of (1) placing a lot of constraints on the way statistsics could be done, (2) forcing the development of increasingly specific tests for each strange sampling scenario, (3) confusing students trying to learn statistics, and (4) requiring the use of simplistic conventions, such as the 0.05 significance threshold, in order to make statistical results somewhat intelligible.

But in the age of \texttt{R}, null distributions no longer need to be theoretical, nor do p-values need to be hypothetical. We can actually \emph{calculate} p-values based on \emph{real} null distributions, thanks to the random number generators built into coding languages such as \texttt{R}. The practice of generating real null distributions based on your own specific dataset is known as \textbf{randomization}.

In a randomization routine, you shuffle the variables in your dataset to generate a distribution of outcomes that would be possible according to a null hypothesis. Most null hypotheses reduce to an expectation of \emph{no meaningful difference} between two (or more) samples, which is to say that any differences between those samples are merely the product of random chance. Such randomly generated variability can be simulated easily in \texttt{R}.

Randomization may seem daunting at first, and it does indeed draw upon some of the higher-order skills in your \texttt{R} toolbag (such as custom functions, \texttt{for} loops, and sometimes even the \texttt{apply()} functions), but once you become oriented you will see how intuitive and simple these analyses can be.

The real advantages of randomization, however, are not for the programmer but for the reader. Randomization results are \emph{much} easier to interpret and more information-rich than frequentist p-values. The advantages are many:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Rather than trusting a black box statistical test with obscure requirements about data distributions, you are performing the test yourself and building the test using your own data. You have more control and accountability, and no more risk of choosing the wrong statistical test. Because you are using your own data to produce the null distribution, you are able to retain the quirks of your own particular dataset; the limitations and inconsistencies in your sampling will be safely propagated into the statistic and properly reflected in the ucertainty of your results.
\item
  The interpretation of your p-value will be more intuitive. Rather than saying that some result is or is not significant based upon an arbitrary threshold such as 0.05, you can speak about the \emph{chances} of meaningful results: ``There is a 89\% chance that these two sample sets are meaningfully different.'' ``There is a 92\% chance that this trend is increasing.'' These kinds of results are easier to interpret, and it avoids the need to make sense of p-values.
\item
  Finally, your statistical test returns much more than a p-value; it returns the null distribution too, which can be of enormous value in more complicated statistical analyses.
\end{enumerate}

\hypertarget{generalized-randomization-workflow}{%
\subsection*{Generalized randomization workflow}\label{generalized-randomization-workflow}}
\addcontentsline{toc}{subsection}{Generalized randomization workflow}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Define your \textbf{research question.}
\item
  Define the \textbf{null model} that you wish to compare your observations against. This involves determining which variable you will need to shuffle.
\item
  \textbf{Create a function} that calculates the value of interest.
\item
  Use that function to determine the \textbf{observed value} of interest.
\item
  Use a \texttt{for} loop to \textbf{build a null distribution} by shuffling your observations with \texttt{R}'s random number generators.
\item
  \textbf{Visualize} your results to sanity-check what you are finding.
\item
  Calculate your \textbf{p-value}, by asking what proportion of the null distribution falls below the observed value.
\end{enumerate}

The examples below will show you how to appy this generalized workflow. Note that we are purposefully applying randomization to scenarios in which classic statistical tests, such as t-tests and linear models, could also be used. We do so because those scenarios are relatively simple, they demonstrate the comparability of randomization to approaches you may already be familiar with, and they hint at the advantages of randomization over those other approaches. But the true value of randomization lies in its ability to carry out statistics when all other conventional tests fail; we hint at that value in the final use case.

\hypertarget{common-use-cases}{%
\section*{Common use cases}\label{common-use-cases}}
\addcontentsline{toc}{section}{Common use cases}

\hypertarget{is-outcome-x-significantly-unexpected}{%
\subsection*{\texorpdfstring{1. Is outcome \texttt{X} significantly unexpected?}{1. Is outcome X significantly unexpected?}}\label{is-outcome-x-significantly-unexpected}}
\addcontentsline{toc}{subsection}{1. Is outcome \texttt{X} significantly unexpected?}

To practice this use case, let's use the dataset \href{https://github.com/databrew/intro-to-data-science/blob/main/data/humpback-whales.csv?raw=true}{\texttt{humpback-whales.csv}}: 15 years of sightings of humpback whales within a fjord system in northern British Columbia, Canada (\url{www.bcwhales.org}).

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Use dataset}
\NormalTok{hw }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"./data/humpback{-}whales.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Each individual whale in this dataset was identified using unique patterns on its tail, so each whale has an ID number.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{nrow}\NormalTok{(hw)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 4436
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(hw)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  year        sit  bhvr  id
1 2004 2004070701   BNF  42
2 2004 2004071401   BNF  42
3 2004 2004071401   BNF  59
4 2004 2004080301   BNF  30
5 2004 2004080401 MI-FE 106
6 2004 2004080401 MI-FE 114
\end{verbatim}

Each row shows a whale (column \texttt{id}) identified during a single sghting (column \texttt{sit}). Some sightings were of a single solo individual, but others were of groups of two or more individuals.

Our interest here is in these whales' social behavior: do they have ``friendships'', i.e., certain individuals that they prefer to associate with over others, or are they just randomly swimming around and bumping into one another?

Let's tackle this one step at a time.

\textbf{Step 1:} Our \textbf{research question} is, \emph{Do any pairs of whales occur together an unexpectedly persistent social bonds?} Since in science we are always limited by how well we sample the population of interest, a more precise version of our research question would be this: \emph{Based on this dataset, can we conclude whether or not any pairs of whales occur together an unexpectedly large number of times?}

\textbf{Step 2:} The \textbf{null model} for this question is simple random mixing: there is no pattern to which whales occur in which group. So the variable that we will need to shuffle is the \texttt{id} column. With this approach, we be able to preserve the number of times each individual is seen and the total number of observations. So the limitations and inconsistencies in our sampling of each individual will be safely propagated into our statistics and properly reflected in the uncertainty of our results.

\textbf{Step 3:} So we need \textbf{a function} that returns the number of times two whales are associated. We will call this function \texttt{association\_tally()}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{association\_tally }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(hw,A,B)\{}
\NormalTok{  siti }\OtherTok{\textless{}{-}}\NormalTok{ hw}\SpecialCharTok{$}\NormalTok{sit[hw}\SpecialCharTok{$}\NormalTok{id}\SpecialCharTok{==}\NormalTok{A]}
\NormalTok{  sitj }\OtherTok{\textless{}{-}}\NormalTok{ hw}\SpecialCharTok{$}\NormalTok{sit[hw}\SpecialCharTok{$}\NormalTok{id}\SpecialCharTok{==}\NormalTok{B]}

\NormalTok{  common\_sits }\OtherTok{\textless{}{-}} \FunctionTok{which}\NormalTok{(siti }\SpecialCharTok{\%in\%}\NormalTok{ sitj)}
\NormalTok{  X }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(common\_sits)}

  \FunctionTok{return}\NormalTok{(X)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\textbf{Step 4:} For our \textbf{observed} association tally, we will focus in on a single pair of humpback whales: IDs 59 and 11.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{obs }\OtherTok{\textless{}{-}} \FunctionTok{association\_tally}\NormalTok{(hw,}\AttributeTok{A=}\StringTok{"59"}\NormalTok{,}\AttributeTok{B=}\StringTok{"11"}\NormalTok{)}
\NormalTok{obs}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 71
\end{verbatim}

That's alot of associations! Let's see if that observation is statistically significant:

\textbf{Step 5:} The \textbf{\texttt{for} loop} for our null distribution will look like this:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nulls }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{()}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{1000}\NormalTok{)\{}
\NormalTok{  hw\_null }\OtherTok{\textless{}{-}}\NormalTok{ hw }\CommentTok{\# save a safe copy of the data}
\NormalTok{  hw\_null}\SpecialCharTok{$}\NormalTok{id }\OtherTok{\textless{}{-}} \FunctionTok{sample}\NormalTok{(hw\_null}\SpecialCharTok{$}\NormalTok{id,}\AttributeTok{size=}\FunctionTok{nrow}\NormalTok{(hw\_null),}\AttributeTok{replace=}\ConstantTok{FALSE}\NormalTok{) }\CommentTok{\# shuffle the null variable}
\NormalTok{  nulli }\OtherTok{\textless{}{-}} \FunctionTok{association\_tally}\NormalTok{(hw\_null,}\AttributeTok{A=}\StringTok{"59"}\NormalTok{,}\AttributeTok{B=}\StringTok{"11"}\NormalTok{) }\CommentTok{\# determine null rate for this iteration}
\NormalTok{  nulls[i] }\OtherTok{\textless{}{-}}\NormalTok{ nulli }\CommentTok{\# save result}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\emph{Note!} Here we only iterate our \texttt{for} loop 1,000 times, but most published randomizations are run for 5,000 to 10,000 iterations, just to ensure that the null distribution is adequately unbiased.

\textbf{Step 6:} To \textbf{visualize these results}, use a histogram:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{par}\NormalTok{(}\AttributeTok{mar=}\FunctionTok{c}\NormalTok{(}\FloatTok{4.2}\NormalTok{,}\FloatTok{4.2}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{))}
\FunctionTok{hist}\NormalTok{(nulls,}\AttributeTok{breaks=}\FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{25}\NormalTok{,}\AttributeTok{by=}\DecValTok{1}\NormalTok{),}\AttributeTok{xlim=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,(obs}\SpecialCharTok{+}\DecValTok{10}\NormalTok{)),}\AttributeTok{main=}\ConstantTok{NULL}\NormalTok{,}\AttributeTok{xlab=}\StringTok{"Null distribution"}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v=}\NormalTok{obs,}\AttributeTok{lwd=}\DecValTok{2}\NormalTok{,}\AttributeTok{lty=}\DecValTok{3}\NormalTok{,}\AttributeTok{col=}\StringTok{"blue"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-261-1.pdf}

\textbf{Step 7:} Finally, we \textbf{calculate our p-value}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p\_value }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(}\FunctionTok{which}\NormalTok{(nulls }\SpecialCharTok{\textgreater{}=}\NormalTok{ obs)) }\SpecialCharTok{/} \FunctionTok{length}\NormalTok{(nulls)}
\NormalTok{p\_value}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0
\end{verbatim}

Let's do this again with a different humpback pair, IDs 16 and 118, who were seen together only 13 times. Is their association rate statistically significant?

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Individual IDs}
\NormalTok{A }\OtherTok{\textless{}{-}} \StringTok{"58"}
\NormalTok{B }\OtherTok{\textless{}{-}} \StringTok{"133"}

\CommentTok{\# Observed association rate}
\NormalTok{obs }\OtherTok{\textless{}{-}} \FunctionTok{association\_tally}\NormalTok{(hw,}\AttributeTok{A=}\NormalTok{A,}\AttributeTok{B=}\NormalTok{B)}
\NormalTok{obs}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 9
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Generate null model}
\NormalTok{nulls }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{()}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{1000}\NormalTok{)\{}
\NormalTok{  hw\_null }\OtherTok{\textless{}{-}}\NormalTok{ hw}
\NormalTok{  hw\_null}\SpecialCharTok{$}\NormalTok{id }\OtherTok{\textless{}{-}} \FunctionTok{sample}\NormalTok{(hw\_null}\SpecialCharTok{$}\NormalTok{id,}\AttributeTok{size=}\FunctionTok{nrow}\NormalTok{(hw\_null),}\AttributeTok{replace=}\ConstantTok{FALSE}\NormalTok{)}
\NormalTok{  nulli }\OtherTok{\textless{}{-}} \FunctionTok{association\_tally}\NormalTok{(hw\_null,}\AttributeTok{A=}\NormalTok{A,}\AttributeTok{B=}\NormalTok{B)}
\NormalTok{  nulls[i] }\OtherTok{\textless{}{-}}\NormalTok{ nulli}
\NormalTok{\}}

\CommentTok{\# Visualize}
\FunctionTok{hist}\NormalTok{(nulls,}\AttributeTok{breaks=}\FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{20}\NormalTok{,}\AttributeTok{by=}\DecValTok{1}\NormalTok{),}\AttributeTok{xlim=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,(obs}\SpecialCharTok{+}\DecValTok{7}\NormalTok{)),}\AttributeTok{main=}\ConstantTok{NULL}\NormalTok{,}\AttributeTok{xlab=}\StringTok{"Null distribution"}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v=}\NormalTok{obs,}\AttributeTok{lwd=}\DecValTok{2}\NormalTok{,}\AttributeTok{lty=}\DecValTok{3}\NormalTok{,}\AttributeTok{col=}\StringTok{"blue"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-263-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Calculate p{-}value}
\NormalTok{p\_value }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(}\FunctionTok{which}\NormalTok{(nulls }\SpecialCharTok{\textgreater{}=}\NormalTok{ obs)) }\SpecialCharTok{/} \FunctionTok{length}\NormalTok{(nulls)}
\NormalTok{p\_value}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.013
\end{verbatim}

In this case, the observed association rate is still statistically significant at the conventional 0.05 level, but there is still an off chance that this is merely the result of random mixing.

\hypertarget{are-two-sample-sets-significantly-different}{%
\subsection*{2. Are two sample sets significantly different?}\label{are-two-sample-sets-significantly-different}}
\addcontentsline{toc}{subsection}{2. Are two sample sets significantly different?}

\emph{Building off of the whale scenario:} Some of these whales have learned how to practice bubble-net feeding, a remarkable feeding strategy that requires group cooperation and special techniques for catching schooling fish such as herring. Other individuals have never been seen bubble net feeding. Are there any differences how often these two populations -- the bubble netters and the ``others'' -- use the study area?

First, let's see how many of these individuals are known to bubble net feed:

\begin{verbatim}
[1] 108
\end{verbatim}

So, out of 132 individuals, 108 are known to practice bubble netting.

Let's go through the steps:

\textbf{1. Research question:} Is there any difference in the number of years in which bubble-netters are seen compared to other whales?

\textbf{2. Null model:} In this case, the null model will be a \emph{distribution of average differences} in the number of years in which individuals from the two populations are seen. This null distribution will be centered around zero. The variable we will shuffle is which individuals are known bubble netters, keeping the size of the two populations constant in each iteration.

\textbf{3. Function:}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{annual\_difference }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(hw,bnf\_ids)\{}
  
\NormalTok{  bnf }\OtherTok{\textless{}{-}}\NormalTok{ hw[hw}\SpecialCharTok{$}\NormalTok{id }\SpecialCharTok{\%in\%}\NormalTok{ bnf\_ids,] }\CommentTok{\# Sightings of known BNFers}
\NormalTok{  other }\OtherTok{\textless{}{-}}\NormalTok{ hw[}\SpecialCharTok{!}\NormalTok{ hw}\SpecialCharTok{$}\NormalTok{id }\SpecialCharTok{\%in\%}\NormalTok{ bnf\_ids,] }\CommentTok{\# Sightings of other whales}
  
  \CommentTok{\# Get distribution of years seen for individuals within each population}
\NormalTok{  counts }\OtherTok{\textless{}{-}} \FunctionTok{table}\NormalTok{(bnf}\SpecialCharTok{$}\NormalTok{id,bnf}\SpecialCharTok{$}\NormalTok{year) }\CommentTok{\# sightings of each whale (rows) in each year (columns)}
\NormalTok{  n\_bnf }\OtherTok{\textless{}{-}} \FunctionTok{apply}\NormalTok{(counts,}\DecValTok{1}\NormalTok{,}\ControlFlowTok{function}\NormalTok{(x)\{}\FunctionTok{length}\NormalTok{(}\FunctionTok{which}\NormalTok{(x}\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{))\}) }\CommentTok{\# years seen for each individual}
  
\NormalTok{  counts }\OtherTok{\textless{}{-}} \FunctionTok{table}\NormalTok{(other}\SpecialCharTok{$}\NormalTok{id,other}\SpecialCharTok{$}\NormalTok{year) }\CommentTok{\# sightings of each whale (rows) in each year (columns)}
\NormalTok{  n\_other }\OtherTok{\textless{}{-}} \FunctionTok{apply}\NormalTok{(counts,}\DecValTok{1}\NormalTok{,}\ControlFlowTok{function}\NormalTok{(x)\{}\FunctionTok{length}\NormalTok{(}\FunctionTok{which}\NormalTok{(x}\SpecialCharTok{\textgreater{}}\DecValTok{0}\NormalTok{))\}) }\CommentTok{\# years seen for each individual}
  
  \CommentTok{\# Now get average difference between two distributions}
\NormalTok{  mean\_diff }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(n\_bnf,}\AttributeTok{na.rm=}\ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{{-}} \FunctionTok{mean}\NormalTok{(n\_other,}\AttributeTok{na.rm=}\ConstantTok{TRUE}\NormalTok{)}
  
  \FunctionTok{return}\NormalTok{(mean\_diff)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\textbf{4. Observed value:}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{obs }\OtherTok{\textless{}{-}} \FunctionTok{annual\_difference}\NormalTok{(hw,}\AttributeTok{bnf\_ids=}\NormalTok{bnf\_ids)}
\NormalTok{obs }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 2.351852
\end{verbatim}

\textbf{5. Build null distribution:}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nulls }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{()}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{1000}\NormalTok{)\{}
\NormalTok{  bnf\_null }\OtherTok{\textless{}{-}} \FunctionTok{sample}\NormalTok{(}\FunctionTok{unique}\NormalTok{(hw}\SpecialCharTok{$}\NormalTok{id),}\AttributeTok{size=}\FunctionTok{length}\NormalTok{(bnf\_ids),}\AttributeTok{replace=}\ConstantTok{FALSE}\NormalTok{)}
\NormalTok{  nulli }\OtherTok{\textless{}{-}} \FunctionTok{annual\_difference}\NormalTok{(hw, }\AttributeTok{bnf\_ids=}\NormalTok{bnf\_null)}
\NormalTok{  nulls[i] }\OtherTok{\textless{}{-}}\NormalTok{ nulli}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\textbf{6. Visualize:}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{hist}\NormalTok{(nulls,}\AttributeTok{breaks=}\FunctionTok{seq}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{5}\NormalTok{,}\DecValTok{5}\NormalTok{,}\AttributeTok{by=}\NormalTok{.}\DecValTok{1}\NormalTok{),}\AttributeTok{xlim=}\FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{5}\NormalTok{,}\DecValTok{5}\NormalTok{),}\AttributeTok{main=}\ConstantTok{NULL}\NormalTok{,}\AttributeTok{xlab=}\StringTok{"Null distribution"}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v=}\NormalTok{obs,}\AttributeTok{lwd=}\DecValTok{2}\NormalTok{,}\AttributeTok{lty=}\DecValTok{3}\NormalTok{,}\AttributeTok{col=}\StringTok{"blue"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-269-1.pdf}

\textbf{7. p-value:}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p\_value }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(}\FunctionTok{which}\NormalTok{(nulls }\SpecialCharTok{\textgreater{}=}\NormalTok{ obs)) }\SpecialCharTok{/} \FunctionTok{length}\NormalTok{(nulls)}
\NormalTok{p\_value}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.003
\end{verbatim}

So there is indeed a significant difference in the annual site fidelity in the two populations! Bubble net feeders practice higher annual return rates than other whales (p = 0.003).

\hypertarget{are-two-variables-correlated}{%
\subsection*{3. Are two variables correlated?}\label{are-two-variables-correlated}}
\addcontentsline{toc}{subsection}{3. Are two variables correlated?}

To perform a correlation analysis with randomization, let's use a classic scenario from marine conversation: We have abundance estimates for a critically endangered porpoise from four years across two decades of research. This species only has a handful of individuals left in the wild. (\href{https://github.com/databrew/intro-to-data-science/blob/main/data/porpoise-survey.csv?raw=true}{link to dataset})

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"./data/porpoise{-}survey.csv"}\NormalTok{)}
\FunctionTok{head}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  year         N
1 2000 12.547943
2 2000  5.932797
3 2000 17.291144
4 2000  2.707317
5 2000 12.279161
6 2000  8.945810
\end{verbatim}

Each row of this dataset is an abundance estimate from a survey that occurred within the vaquita's range during a certain year.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{N }\SpecialCharTok{\textasciitilde{}}\NormalTok{ df}\SpecialCharTok{$}\NormalTok{year,}\AttributeTok{ylim=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{20}\NormalTok{),}
     \AttributeTok{xlab=}\StringTok{"Year"}\NormalTok{,}
     \AttributeTok{ylab=}\StringTok{"Total Abundance"}\NormalTok{,}
     \AttributeTok{col=}\FunctionTok{adjustcolor}\NormalTok{(}\StringTok{"black"}\NormalTok{,}\AttributeTok{alpha.f=}\NormalTok{.}\DecValTok{6}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-273-1.pdf}

Performing a simple linear regression with this dataset yields the following results:

\includegraphics{figures/unnamed-chunk-274-1.pdf}

The slope appears to be negative, but the regression has a non-significant p-value (p=0.22) and a very small correlation coefficient:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(df\_lm)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Call:
lm(formula = df$N ~ df$year)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.6841 -3.3981 -0.3879  3.0338  8.6945 

Coefficients:
             Estimate Std. Error t value Pr(>|t|)
(Intercept) 173.63645  133.70824   1.299    0.198
df$year      -0.08216    0.06657  -1.234    0.221

Residual standard error: 4.221 on 82 degrees of freedom
Multiple R-squared:  0.01824,   Adjusted R-squared:  0.006268 
F-statistic: 1.523 on 1 and 82 DF,  p-value: 0.2206
\end{verbatim}

These results may compel some conservation skeptics to stop worrying about the porpoise. ``Yes, the population is small, but it appears stable, and there is no evidence that it is decreasing.'' This is a situation in which using a randomization regression analysis could give us more information and help us speak more precisely about the risks to which this population is exposed.

Let's go through the steps:

\textbf{1. Research question:} Is there a trend in porpoise abundance over time?

\textbf{2. Null model:} There is no trend; the abundance estimates might as well come from any given year and the trendline would look the same.

\textbf{3. Function:} Get the slope estimate for the time series.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_lm }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(df)\{}
\NormalTok{  lmi }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{N }\SpecialCharTok{\textasciitilde{}}\NormalTok{ df}\SpecialCharTok{$}\NormalTok{year) }
\NormalTok{  slopi }\OtherTok{\textless{}{-}} \FunctionTok{summary}\NormalTok{(lmi)}\SpecialCharTok{$}\NormalTok{coefficients[}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{]}
\NormalTok{  rsqu }\OtherTok{\textless{}{-}} \FunctionTok{summary}\NormalTok{(lmi)}\SpecialCharTok{$}\NormalTok{r.squared}
  
  \FunctionTok{return}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"slope"}\OtherTok{=}\NormalTok{slopi,}\StringTok{"r"}\OtherTok{=}\NormalTok{rsqu))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\textbf{4. Observed value:}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{obs }\OtherTok{\textless{}{-}} \FunctionTok{df\_lm}\NormalTok{(df)}
\NormalTok{obs }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
      slope           r 
-0.08216195  0.01824031 
\end{verbatim}

\textbf{5. Build null distribution:}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nulls }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{()}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{1000}\NormalTok{)\{}
\NormalTok{  df\_null }\OtherTok{\textless{}{-}}\NormalTok{ df}
\NormalTok{  df\_null}\SpecialCharTok{$}\NormalTok{year }\OtherTok{\textless{}{-}} \FunctionTok{sample}\NormalTok{(df\_null}\SpecialCharTok{$}\NormalTok{year,}\AttributeTok{size=}\FunctionTok{nrow}\NormalTok{(df\_null),}\AttributeTok{replace=}\ConstantTok{FALSE}\NormalTok{)}
\NormalTok{  nulli }\OtherTok{\textless{}{-}} \FunctionTok{df\_lm}\NormalTok{(df\_null)}
\NormalTok{  nulli }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{slope=}\NormalTok{nulli[}\DecValTok{1}\NormalTok{],}\AttributeTok{r=}\NormalTok{nulli[}\DecValTok{2}\NormalTok{])}
\NormalTok{  nulls }\OtherTok{\textless{}{-}} \FunctionTok{rbind}\NormalTok{(nulls,nulli)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\textbf{6. Visualize:}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\FunctionTok{hist}\NormalTok{(nulls}\SpecialCharTok{$}\NormalTok{slope,}\AttributeTok{breaks=}\FunctionTok{seq}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\AttributeTok{by=}\NormalTok{.}\DecValTok{01}\NormalTok{),}\AttributeTok{xlim=}\FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{.}\DecValTok{5}\NormalTok{,.}\DecValTok{5}\NormalTok{),}\AttributeTok{main=}\ConstantTok{NULL}\NormalTok{,}\AttributeTok{xlab=}\StringTok{"Null distribution"}\NormalTok{,}\AttributeTok{border=}\StringTok{"grey70"}\NormalTok{)}
\FunctionTok{text}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{.}\DecValTok{48}\NormalTok{,}\DecValTok{20}\NormalTok{,}\StringTok{"Slope }\SpecialCharTok{\textbackslash{}n}\StringTok{estimate"}\NormalTok{,}\AttributeTok{pos=}\DecValTok{4}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v=}\NormalTok{obs[}\DecValTok{1}\NormalTok{],}\AttributeTok{lwd=}\DecValTok{2}\NormalTok{,}\AttributeTok{lty=}\DecValTok{3}\NormalTok{,}\AttributeTok{col=}\StringTok{"blue"}\NormalTok{)}

\FunctionTok{hist}\NormalTok{(nulls}\SpecialCharTok{$}\NormalTok{r,}\AttributeTok{breaks=}\FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\AttributeTok{by=}\NormalTok{.}\DecValTok{001}\NormalTok{),}\AttributeTok{xlim=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,.}\DecValTok{1}\NormalTok{),}\AttributeTok{main=}\ConstantTok{NULL}\NormalTok{,}\AttributeTok{xlab=}\StringTok{"Null distribution"}\NormalTok{,}\AttributeTok{border=}\StringTok{"grey70"}\NormalTok{)}
\FunctionTok{text}\NormalTok{(.}\DecValTok{06}\NormalTok{,}\DecValTok{20}\NormalTok{,}\StringTok{"Correlation }\SpecialCharTok{\textbackslash{}n}\StringTok{coefficient"}\NormalTok{,}\AttributeTok{pos=}\DecValTok{4}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v=}\NormalTok{obs[}\DecValTok{2}\NormalTok{],}\AttributeTok{lwd=}\DecValTok{2}\NormalTok{,}\AttributeTok{lty=}\DecValTok{3}\NormalTok{,}\AttributeTok{col=}\StringTok{"blue"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-279-1.pdf}

\textbf{7. p-value:}

Significance of \textbf{slope}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p\_value }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(}\FunctionTok{which}\NormalTok{(nulls}\SpecialCharTok{$}\NormalTok{slope }\SpecialCharTok{\textgreater{}=}\NormalTok{ obs[}\DecValTok{1}\NormalTok{])) }\SpecialCharTok{/} \FunctionTok{nrow}\NormalTok{(nulls)}
\NormalTok{p\_value}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.879
\end{verbatim}

This indicates that the chance that the slope is lower than the null expectation is 87.9\%.

Significance of \textbf{correlation coefficient}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p\_value }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(}\FunctionTok{which}\NormalTok{(nulls}\SpecialCharTok{$}\NormalTok{r }\SpecialCharTok{\textgreater{}=}\NormalTok{ obs[}\DecValTok{2}\NormalTok{])) }\SpecialCharTok{/} \FunctionTok{nrow}\NormalTok{(nulls)}
\NormalTok{p\_value}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.222
\end{verbatim}

This indicates that the observed regression is better than 77.8\% of scenarios that might be expected under the null expectation.

\hypertarget{is-the-slope-of-a-regression-line-negative}{%
\subsection*{4. Is the slope of a regression line negative?}\label{is-the-slope-of-a-regression-line-negative}}
\addcontentsline{toc}{subsection}{4. Is the slope of a regression line negative?}

Sometimes we have even less data about an endagered species. Let's say we go out in 2021 for another porpoise survey and come up with these estimates from the species' range:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(truncnorm) ; }\FunctionTok{set.seed}\NormalTok{(}\DecValTok{1234}\NormalTok{)}
\NormalTok{n2021 }\OtherTok{\textless{}{-}} \FunctionTok{rtruncnorm}\NormalTok{(}\AttributeTok{n=}\DecValTok{25}\NormalTok{,}\AttributeTok{a=}\DecValTok{0}\NormalTok{,}\AttributeTok{mean=}\FloatTok{3.6}\NormalTok{,}\AttributeTok{sd=}\DecValTok{3}\NormalTok{)}
\NormalTok{n2021}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1]  4.4322877  6.8533235  4.8873741  5.1181677  1.8757801  1.9601044
 [7]  1.9066440  0.9298865  2.1684219  0.6048407  1.2712383  3.7933765
[13]  6.4784822  3.2691435  2.0669715  0.8664138  1.0884850 10.8475055
[19]  4.0022647  2.1279423  2.2783564  4.9787683  1.5188393  5.3242672
[25]  0.5290328
\end{verbatim}

We want to know what the chances are that the population has declined between 2017 and 2021.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{n2017 }\OtherTok{\textless{}{-}}\NormalTok{ df}\SpecialCharTok{$}\NormalTok{N[df}\SpecialCharTok{$}\NormalTok{year}\SpecialCharTok{==}\DecValTok{2017}\NormalTok{]}

\FunctionTok{plot}\NormalTok{(}\DecValTok{1}\NormalTok{,}\AttributeTok{type=}\StringTok{"n"}\NormalTok{,}\AttributeTok{ylim=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{15}\NormalTok{),}\AttributeTok{xlim=}\FunctionTok{c}\NormalTok{(}\DecValTok{2015}\NormalTok{,}\DecValTok{2023}\NormalTok{),}
     \AttributeTok{xlab=}\StringTok{"Year"}\NormalTok{,}
     \AttributeTok{ylab=}\StringTok{"Total Abundance"}\NormalTok{,}
     \AttributeTok{col=}\FunctionTok{adjustcolor}\NormalTok{(}\StringTok{"black"}\NormalTok{,}\AttributeTok{alpha.f=}\NormalTok{.}\DecValTok{6}\NormalTok{))}

\FunctionTok{points}\NormalTok{(n2017 }\SpecialCharTok{\textasciitilde{}} \FunctionTok{rep}\NormalTok{(}\DecValTok{2017}\NormalTok{,}\AttributeTok{times=}\FunctionTok{length}\NormalTok{(n2017)))}
\FunctionTok{points}\NormalTok{(n2021 }\SpecialCharTok{\textasciitilde{}} \FunctionTok{rep}\NormalTok{(}\DecValTok{2021}\NormalTok{,}\AttributeTok{times=}\FunctionTok{length}\NormalTok{(n2021)))}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-283-1.pdf}

If this is all we have, what can we say about the status of this endangered species? With such a low sample size and so much variability, it can be really hard to produce significant or even compelling results. \textbf{Well, what are the chances that this population is in decline?} That is a question that a simple linear model cannot tell us.

In this case, our null model will be the distribution of differences of values drawn randomly from the two years' datasets.

And in this randomization application, the workflow is a bit more simplified. We don't need a core function, and we don't even need a \texttt{for} loop.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Randomly draw from the 2017 dataset 5,000 times}
\NormalTok{r2017 }\OtherTok{\textless{}{-}} \FunctionTok{sample}\NormalTok{(n2017,}\AttributeTok{size=}\DecValTok{10000}\NormalTok{,}\AttributeTok{replace=}\ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Do the same for the 2017 dataset}
\NormalTok{r2021 }\OtherTok{\textless{}{-}} \FunctionTok{sample}\NormalTok{(n2021,}\AttributeTok{size=}\DecValTok{10000}\NormalTok{,}\AttributeTok{replace=}\ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Get the difference of these two datasets}
\NormalTok{diffs }\OtherTok{\textless{}{-}}\NormalTok{ r2021 }\SpecialCharTok{{-}}\NormalTok{ r2017}

\CommentTok{\# Visualize}
\FunctionTok{hist}\NormalTok{(diffs,}\AttributeTok{breaks=}\FunctionTok{seq}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{20}\NormalTok{,}\DecValTok{20}\NormalTok{,}\AttributeTok{by=}\DecValTok{1}\NormalTok{),}\AttributeTok{xlim=}\FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{20}\NormalTok{,}\DecValTok{20}\NormalTok{),}\AttributeTok{main=}\ConstantTok{NULL}\NormalTok{,}\AttributeTok{xlab=}\StringTok{"Null distribution"}\NormalTok{,}\AttributeTok{border=}\StringTok{"grey70"}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v=}\DecValTok{0}\NormalTok{,}\AttributeTok{lwd=}\DecValTok{2}\NormalTok{,}\AttributeTok{lty=}\DecValTok{3}\NormalTok{,}\AttributeTok{col=}\StringTok{"blue"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figures/unnamed-chunk-284-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Get p\_value}
\NormalTok{p\_value }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(}\FunctionTok{which}\NormalTok{(diffs }\SpecialCharTok{\textgreater{}=} \DecValTok{0}\NormalTok{)) }\SpecialCharTok{/} \FunctionTok{length}\NormalTok{(diffs)}

\CommentTok{\# Convert to chances of decline}
\NormalTok{chances\_of\_decline }\OtherTok{\textless{}{-}} \DecValTok{100}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ p\_value)}
\NormalTok{chances\_of\_decline}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 84.43
\end{verbatim}

The chances that this population is in decline is 84.43\%.

\hypertarget{review-assignment-11}{%
\section*{Review assignment}\label{review-assignment-11}}
\addcontentsline{toc}{section}{Review assignment}

Let's return to the humpback whale scenario

\hypertarget{a-do-bubble-net-feeders-have-stronger-social-bonds}{%
\subsection*{(a) Do bubble net feeders have stronger social bonds?}\label{a-do-bubble-net-feeders-have-stronger-social-bonds}}
\addcontentsline{toc}{subsection}{(a) Do bubble net feeders have stronger social bonds?}

Above we asked whether bubble net feeders exhibit higher year-to-year site fidelity to the study area than other individuals. What about their social bonds? Do whales known to bubble net feed tend to have more stable social associations than the others?

Make sure you are working with the correct data:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{hw }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"./data/humpback{-}whales.csv"}\NormalTok{)}

\CommentTok{\# Establish the two populations}
\NormalTok{bnf\_indices }\OtherTok{\textless{}{-}} \FunctionTok{grep}\NormalTok{(}\StringTok{"BNF"}\NormalTok{,hw}\SpecialCharTok{$}\NormalTok{bhvr) }\CommentTok{\# which detections are of BNFers}
\NormalTok{bnf\_sits }\OtherTok{\textless{}{-}}\NormalTok{ hw[bnf\_indices,] }\CommentTok{\# BNF sightings}
\NormalTok{bnf\_ids }\OtherTok{\textless{}{-}} \FunctionTok{unique}\NormalTok{(bnf\_sits}\SpecialCharTok{$}\NormalTok{id) }\CommentTok{\# BNF individuals}
\FunctionTok{length}\NormalTok{(bnf\_ids)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 108
\end{verbatim}

\textbf{Answer key:}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Internal function for determining times seen together for a single row of a dyads dataframe}
\NormalTok{social\_X }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(dyad)\{}
\NormalTok{    A }\OtherTok{\textless{}{-}}\NormalTok{ dyad[}\DecValTok{1}\NormalTok{]}
\NormalTok{    B }\OtherTok{\textless{}{-}}\NormalTok{ dyad[}\DecValTok{2}\NormalTok{]}
\NormalTok{    sitA }\OtherTok{\textless{}{-}}\NormalTok{ hw}\SpecialCharTok{$}\NormalTok{sit[hw}\SpecialCharTok{$}\NormalTok{id}\SpecialCharTok{==}\NormalTok{A]}
\NormalTok{    sitB }\OtherTok{\textless{}{-}}\NormalTok{ hw}\SpecialCharTok{$}\NormalTok{sit[hw}\SpecialCharTok{$}\NormalTok{id}\SpecialCharTok{==}\NormalTok{B]}
\NormalTok{    X }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(}\FunctionTok{which}\NormalTok{(sitA }\SpecialCharTok{\%in\%}\NormalTok{ sitB))}
    \FunctionTok{return}\NormalTok{(X)}
\NormalTok{\}}

\CommentTok{\# Core function}
\NormalTok{social\_difference }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(hw,bnf\_ids)\{}
  
\NormalTok{  bnf }\OtherTok{\textless{}{-}}\NormalTok{ hw[hw}\SpecialCharTok{$}\NormalTok{id }\SpecialCharTok{\%in\%}\NormalTok{ bnf\_ids,] }\CommentTok{\# Sightings of known BNFers}
\NormalTok{  other }\OtherTok{\textless{}{-}}\NormalTok{ hw[}\SpecialCharTok{!}\NormalTok{ hw}\SpecialCharTok{$}\NormalTok{id }\SpecialCharTok{\%in\%}\NormalTok{ bnf\_ids,] }\CommentTok{\# Sightings of other whales}
\NormalTok{  other\_ids }\OtherTok{\textless{}{-}} \FunctionTok{unique}\NormalTok{(other}\SpecialCharTok{$}\NormalTok{id)}
  
\NormalTok{  bnfs }\OtherTok{\textless{}{-}} \FunctionTok{expand.grid}\NormalTok{(bnf\_ids,bnf\_ids) }\CommentTok{\# Make a dataframe of all possible dyad combinations}
\NormalTok{  bnfs}\SpecialCharTok{$}\NormalTok{X }\OtherTok{\textless{}{-}} \FunctionTok{apply}\NormalTok{(bnfs,}\DecValTok{1}\NormalTok{,social\_X) }\CommentTok{\# Get number of times seen}
  
  \CommentTok{\# Do same for others}
\NormalTok{  others }\OtherTok{\textless{}{-}} \FunctionTok{expand.grid}\NormalTok{(other\_ids, other\_ids)}
\NormalTok{  others}\SpecialCharTok{$}\NormalTok{X }\OtherTok{\textless{}{-}} \FunctionTok{apply}\NormalTok{(others,}\DecValTok{1}\NormalTok{,social\_X) }
  
  \CommentTok{\# Now get average difference between two distributions}
\NormalTok{  mean\_diff }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(bnfs}\SpecialCharTok{$}\NormalTok{X,}\AttributeTok{na.rm=}\ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{{-}} \FunctionTok{mean}\NormalTok{(others}\SpecialCharTok{$}\NormalTok{X,}\AttributeTok{na.rm=}\ConstantTok{TRUE}\NormalTok{)}
  
  \FunctionTok{return}\NormalTok{(mean\_diff)}
\NormalTok{\}}

\CommentTok{\# Observed}
\NormalTok{obs }\OtherTok{\textless{}{-}} \FunctionTok{social\_difference}\NormalTok{(hw,bnf\_ids)}
\NormalTok{obs}

\CommentTok{\# Null distribution (only do 100 iterations for sake of time)}
\NormalTok{nulls }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{()}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{100}\NormalTok{)\{}
\NormalTok{  bnf\_null }\OtherTok{\textless{}{-}} \FunctionTok{sample}\NormalTok{(}\FunctionTok{unique}\NormalTok{(hw}\SpecialCharTok{$}\NormalTok{id),}\AttributeTok{size=}\FunctionTok{length}\NormalTok{(bnf\_ids),}\AttributeTok{replace=}\ConstantTok{FALSE}\NormalTok{)}
\NormalTok{  nulli }\OtherTok{\textless{}{-}} \FunctionTok{social\_difference}\NormalTok{(hw, }\AttributeTok{bnf\_ids=}\NormalTok{bnf\_null)}
\NormalTok{  nulls[i] }\OtherTok{\textless{}{-}}\NormalTok{ nulli}
\NormalTok{\}}

\CommentTok{\# Visualize}
\FunctionTok{par}\NormalTok{(}\AttributeTok{mar=}\FunctionTok{c}\NormalTok{(}\FloatTok{4.2}\NormalTok{,}\FloatTok{4.2}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{))}
\FunctionTok{hist}\NormalTok{(nulls,}\AttributeTok{breaks=}\FunctionTok{seq}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{6}\NormalTok{,}\DecValTok{6}\NormalTok{,}\AttributeTok{by=}\NormalTok{.}\DecValTok{1}\NormalTok{),}\AttributeTok{xlim=}\FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{3}\NormalTok{,}\DecValTok{1}\NormalTok{),}\AttributeTok{main=}\ConstantTok{NULL}\NormalTok{,}\AttributeTok{xlab=}\StringTok{"Null distribution"}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v=}\NormalTok{obs,}\AttributeTok{lwd=}\DecValTok{2}\NormalTok{,}\AttributeTok{lty=}\DecValTok{3}\NormalTok{,}\AttributeTok{col=}\StringTok{"blue"}\NormalTok{)}

\CommentTok{\# p{-}value}
\NormalTok{p\_value }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(}\FunctionTok{which}\NormalTok{(nulls }\SpecialCharTok{\textgreater{}=}\NormalTok{ obs)) }\SpecialCharTok{/} \FunctionTok{length}\NormalTok{(nulls)}
\NormalTok{p\_value}

\CommentTok{\# BNFers have much more persistent bonds than other whales (p=0.00000)}
\end{Highlighting}
\end{Shaded}

\hypertarget{b-are-bubble-net-feeders-more-closely-related-to-each-other}{%
\subsection*{(b) Are bubble net feeders more closely related to each other?}\label{b-are-bubble-net-feeders-more-closely-related-to-each-other}}
\addcontentsline{toc}{subsection}{(b) Are bubble net feeders more closely related to each other?}

In 2019, researchers took DNA samples from 36 individuals in this dataset. They collected the samples by flying drones through the whale's spouts and harvesting DNA from their \emph{snot}! \emph{GROSS!!!} But also \emph{super RAD!}

Using these genetic samples, the researchers determined the relatedness of each pair of individuals they sampled. Those results are provided in the dataset \href{https://github.com/databrew/intro-to-data-science/blob/main/data/humpback-kinship.rds?raw=true}{\texttt{humpback-kinship.rds}}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{kinship }\OtherTok{\textless{}{-}} \FunctionTok{readRDS}\NormalTok{(}\StringTok{"./data/humpback{-}kinship.rds"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

And \href{https://github.com/databrew/intro-to-data-science/blob/main/data/bnf-status.rds?raw=true}{here is a key} providing the IDs of these 36 whales and their status as a known bubble net feeder.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bnf\_status }\OtherTok{\textless{}{-}} \FunctionTok{readRDS}\NormalTok{(}\StringTok{"./data/bnf{-}status.rds"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Use these datasets within a randomization routine to determine whether known bubble netters are more closely related to each other than they are to other whales.

\textbf{Answer key:}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# How many BNFers are in this dataset?}
\NormalTok{n\_bnf }\OtherTok{\textless{}{-}} \FunctionTok{nrow}\NormalTok{(bnf\_status[bnf\_status}\SpecialCharTok{$}\NormalTok{bnf,])}
\NormalTok{n\_bnf}

\CommentTok{\# Core function}
\NormalTok{kinship\_difference }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(kinship,bnf\_status)\{}
  
\NormalTok{  bnf\_ids }\OtherTok{\textless{}{-}}\NormalTok{ bnf\_status}\SpecialCharTok{$}\NormalTok{id[bnf\_status}\SpecialCharTok{$}\NormalTok{bnf]}
\NormalTok{  other\_ids }\OtherTok{\textless{}{-}}\NormalTok{ bnf\_status}\SpecialCharTok{$}\NormalTok{id[}\SpecialCharTok{!}\NormalTok{ bnf\_status}\SpecialCharTok{$}\NormalTok{bnf]}
  
\NormalTok{  bnf\_rows }\OtherTok{\textless{}{-}} \FunctionTok{which}\NormalTok{(}\FunctionTok{row.names}\NormalTok{(kinship) }\SpecialCharTok{\%in\%}\NormalTok{ bnf\_ids)}
\NormalTok{  kin\_bnf }\OtherTok{\textless{}{-}}\NormalTok{ kinship[bnf\_rows,bnf\_rows]}
\NormalTok{  kin\_other }\OtherTok{\textless{}{-}}\NormalTok{ kinship[}\SpecialCharTok{{-}}\NormalTok{bnf\_rows, }\SpecialCharTok{{-}}\NormalTok{bnf\_rows]}
  
\NormalTok{  mean\_diff }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(}\FunctionTok{as.matrix}\NormalTok{(kin\_bnf)) }\SpecialCharTok{{-}} \FunctionTok{mean}\NormalTok{(}\FunctionTok{as.matrix}\NormalTok{(kin\_other))}
  
  \FunctionTok{return}\NormalTok{(mean\_diff)}
\NormalTok{\}}

\CommentTok{\# Observed}
\NormalTok{obs }\OtherTok{\textless{}{-}} \FunctionTok{kinship\_difference}\NormalTok{(kinship,bnf\_status)}
\NormalTok{obs}

\CommentTok{\# Null distribution }
\NormalTok{nulls }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{()}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{1000}\NormalTok{)\{}
\NormalTok{  bnf\_null }\OtherTok{\textless{}{-}}\NormalTok{ bnf\_status}
\NormalTok{  bnf\_null}\SpecialCharTok{$}\NormalTok{bnf }\OtherTok{\textless{}{-}} \FunctionTok{sample}\NormalTok{(bnf\_null}\SpecialCharTok{$}\NormalTok{bnf,}\AttributeTok{size=}\FunctionTok{nrow}\NormalTok{(bnf\_null),}\AttributeTok{replace=}\ConstantTok{FALSE}\NormalTok{)}
\NormalTok{  nulli }\OtherTok{\textless{}{-}} \FunctionTok{kinship\_difference}\NormalTok{(kinship,bnf\_null)}
\NormalTok{  nulls[i] }\OtherTok{\textless{}{-}}\NormalTok{ nulli}
\NormalTok{\}}

\CommentTok{\# Visualize}
\FunctionTok{par}\NormalTok{(}\AttributeTok{mar=}\FunctionTok{c}\NormalTok{(}\FloatTok{4.2}\NormalTok{,}\FloatTok{4.2}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{))}
\FunctionTok{hist}\NormalTok{(nulls,}\AttributeTok{breaks=}\FunctionTok{seq}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{6}\NormalTok{,}\DecValTok{6}\NormalTok{,}\AttributeTok{by=}\NormalTok{.}\DecValTok{002}\NormalTok{),}\AttributeTok{xlim=}\FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{.}\DecValTok{1}\NormalTok{,.}\DecValTok{05}\NormalTok{),}
     \AttributeTok{main=}\ConstantTok{NULL}\NormalTok{,}\AttributeTok{xlab=}\StringTok{"Null distribution"}\NormalTok{,}\AttributeTok{border=}\StringTok{"grey70"}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v=}\NormalTok{obs,}\AttributeTok{lwd=}\DecValTok{2}\NormalTok{,}\AttributeTok{lty=}\DecValTok{3}\NormalTok{,}\AttributeTok{col=}\StringTok{"blue"}\NormalTok{)}

\CommentTok{\# p{-}value}
\NormalTok{p\_value }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(}\FunctionTok{which}\NormalTok{(nulls }\SpecialCharTok{\textgreater{}=}\NormalTok{ obs)) }\SpecialCharTok{/} \FunctionTok{length}\NormalTok{(nulls)}
\NormalTok{p\_value}

\CommentTok{\# Weak evidence for relatedness being a factor in BNF network, but \textgreater{}60\% chance! }
\CommentTok{\# A bit better than coin flip. Interesting!}
\end{Highlighting}
\end{Shaded}

\hypertarget{c-do-social-bonds-relate-to-kinship}{%
\section*{(c) Do social bonds relate to kinship?}\label{c-do-social-bonds-relate-to-kinship}}
\addcontentsline{toc}{section}{(c) Do social bonds relate to kinship?}

Finally, let's ask whether the strength of social bonds is generally correlated to kinship. In other words, is this population assorting according to relatedness?

For your convenience, the social association rate for these 36 individuals has also been summarized in the dataset \href{https://github.com/databrew/intro-to-data-science/blob/main/data/humpback-sociality.rds?raw=true}{\texttt{humpback-sociality.rds}}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sociality }\OtherTok{\textless{}{-}} \FunctionTok{readRDS}\NormalTok{(}\StringTok{"./data/humpback{-}sociality.rds"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\textbf{Answer key:}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Core function}
\NormalTok{kin\_soc }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(kinship,sociality)\{}
\NormalTok{  ids }\OtherTok{\textless{}{-}} \FunctionTok{row.names}\NormalTok{(kinship) ; ids}
  
\NormalTok{  mr }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{()}
\NormalTok{  i}\OtherTok{=}\DecValTok{1}\NormalTok{ ; j}\OtherTok{=}\DecValTok{10}
  \ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(ids))\{}
\NormalTok{    idi }\OtherTok{\textless{}{-}}\NormalTok{ ids[i] ; idi}
\NormalTok{    kin\_row }\OtherTok{\textless{}{-}} \FunctionTok{which}\NormalTok{(}\FunctionTok{row.names}\NormalTok{(kinship)}\SpecialCharTok{==}\NormalTok{idi) ; kin\_row}
\NormalTok{    soc\_row }\OtherTok{\textless{}{-}} \FunctionTok{which}\NormalTok{(}\FunctionTok{row.names}\NormalTok{(sociality)}\SpecialCharTok{==}\NormalTok{idi) ; soc\_row}
        
    \ControlFlowTok{for}\NormalTok{(j }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(ids))\{}
\NormalTok{      idj }\OtherTok{\textless{}{-}}\NormalTok{ ids[j]; idj}
      
\NormalTok{      kin\_col }\OtherTok{\textless{}{-}} \FunctionTok{which}\NormalTok{(}\FunctionTok{colnames}\NormalTok{(kinship)}\SpecialCharTok{==}\NormalTok{idj) ; kin\_col}
\NormalTok{      soc\_col }\OtherTok{\textless{}{-}} \FunctionTok{which}\NormalTok{(}\FunctionTok{colnames}\NormalTok{(sociality)}\SpecialCharTok{==}\NormalTok{idj) ; soc\_col}
      
\NormalTok{      mri }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{A=}\NormalTok{idi,}\AttributeTok{B=}\NormalTok{idj,}
                        \AttributeTok{kinship=}\NormalTok{kinship[kin\_row,kin\_col],}
                        \AttributeTok{sociality=}\NormalTok{sociality[soc\_row,soc\_col])}
\NormalTok{      mri}
\NormalTok{      mr }\OtherTok{\textless{}{-}} \FunctionTok{rbind}\NormalTok{(mr,mri)}
\NormalTok{    \}}
\NormalTok{  \}}
\NormalTok{  mr}
  
  \CommentTok{\# remove navelgazers}
\NormalTok{  navels }\OtherTok{\textless{}{-}} \FunctionTok{which}\NormalTok{(mr}\SpecialCharTok{$}\NormalTok{A}\SpecialCharTok{==}\NormalTok{mr}\SpecialCharTok{$}\NormalTok{B) ; navels}
\NormalTok{  mr }\OtherTok{\textless{}{-}}\NormalTok{ mr[}\SpecialCharTok{{-}}\NormalTok{navels,]}
  
  \CommentTok{\#plot(sociality\textasciitilde{}kinship,data=mr)}
\NormalTok{  lmi }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(mr}\SpecialCharTok{$}\NormalTok{sociality }\SpecialCharTok{\textasciitilde{}}\NormalTok{ mr}\SpecialCharTok{$}\NormalTok{kinship) }
  \CommentTok{\#abline(lmi)}
\NormalTok{  slopi }\OtherTok{\textless{}{-}} \FunctionTok{summary}\NormalTok{(lmi)}\SpecialCharTok{$}\NormalTok{coefficients[}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{]}
\NormalTok{  rsqu }\OtherTok{\textless{}{-}} \FunctionTok{summary}\NormalTok{(lmi)}\SpecialCharTok{$}\NormalTok{r.squared}
  
  \FunctionTok{return}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"slope"}\OtherTok{=}\NormalTok{slopi,}\StringTok{"r"}\OtherTok{=}\NormalTok{rsqu))}
\NormalTok{\}}

\CommentTok{\# Observed}
\NormalTok{obs }\OtherTok{\textless{}{-}} \FunctionTok{kin\_soc}\NormalTok{(kinship,sociality)}
\NormalTok{obs}

\CommentTok{\# Null distribution}
\NormalTok{nulls }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{()}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{500}\NormalTok{)\{}
\NormalTok{  kin\_null }\OtherTok{\textless{}{-}}\NormalTok{ kinship}
\NormalTok{  kin\_null }\OtherTok{\textless{}{-}}\NormalTok{ kin\_null[}\FunctionTok{sample}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\FunctionTok{nrow}\NormalTok{(kin\_null),}\AttributeTok{size=}\FunctionTok{nrow}\NormalTok{(kin\_null),}\AttributeTok{replace=}\ConstantTok{FALSE}\NormalTok{),]}
  \FunctionTok{row.names}\NormalTok{(kin\_null) }\OtherTok{\textless{}{-}} \FunctionTok{row.names}\NormalTok{(kinship)}
\NormalTok{  nulli }\OtherTok{\textless{}{-}} \FunctionTok{kin\_soc}\NormalTok{(kin\_null,sociality)}
\NormalTok{  nulli }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{slope=}\NormalTok{nulli[}\DecValTok{1}\NormalTok{],}\AttributeTok{r=}\NormalTok{nulli[}\DecValTok{2}\NormalTok{])}
\NormalTok{  nulls }\OtherTok{\textless{}{-}} \FunctionTok{rbind}\NormalTok{(nulls,nulli)}
\NormalTok{\}}

\CommentTok{\# Visualize}
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\FunctionTok{hist}\NormalTok{(nulls}\SpecialCharTok{$}\NormalTok{slope,}\AttributeTok{breaks=}\FunctionTok{seq}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\AttributeTok{by=}\NormalTok{.}\DecValTok{0005}\NormalTok{),}\AttributeTok{xlim=}\FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{.}\DecValTok{02}\NormalTok{,.}\DecValTok{02}\NormalTok{),}\AttributeTok{main=}\ConstantTok{NULL}\NormalTok{,}\AttributeTok{xlab=}\StringTok{"Null distribution"}\NormalTok{,}\AttributeTok{border=}\StringTok{"grey70"}\NormalTok{)}
\FunctionTok{text}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{.}\DecValTok{48}\NormalTok{,}\DecValTok{20}\NormalTok{,}\StringTok{"Slope }\SpecialCharTok{\textbackslash{}n}\StringTok{estimate"}\NormalTok{,}\AttributeTok{pos=}\DecValTok{4}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v=}\NormalTok{obs[}\DecValTok{1}\NormalTok{],}\AttributeTok{lwd=}\DecValTok{2}\NormalTok{,}\AttributeTok{lty=}\DecValTok{3}\NormalTok{,}\AttributeTok{col=}\StringTok{"blue"}\NormalTok{)}

\FunctionTok{hist}\NormalTok{(nulls}\SpecialCharTok{$}\NormalTok{r,}\AttributeTok{breaks=}\FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\AttributeTok{by=}\NormalTok{.}\DecValTok{0001}\NormalTok{),}\AttributeTok{xlim=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,.}\DecValTok{01}\NormalTok{),}\AttributeTok{main=}\ConstantTok{NULL}\NormalTok{,}\AttributeTok{xlab=}\StringTok{"Null distribution"}\NormalTok{,}\AttributeTok{border=}\StringTok{"grey70"}\NormalTok{)}
\FunctionTok{text}\NormalTok{(.}\DecValTok{06}\NormalTok{,}\DecValTok{20}\NormalTok{,}\StringTok{"Correlation }\SpecialCharTok{\textbackslash{}n}\StringTok{coefficient"}\NormalTok{,}\AttributeTok{pos=}\DecValTok{4}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{v=}\NormalTok{obs[}\DecValTok{2}\NormalTok{],}\AttributeTok{lwd=}\DecValTok{2}\NormalTok{,}\AttributeTok{lty=}\DecValTok{3}\NormalTok{,}\AttributeTok{col=}\StringTok{"blue"}\NormalTok{)}

\CommentTok{\# P{-}value of slope}
\NormalTok{p\_value }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(}\FunctionTok{which}\NormalTok{(nulls}\SpecialCharTok{$}\NormalTok{slope }\SpecialCharTok{\textgreater{}=}\NormalTok{ obs[}\DecValTok{1}\NormalTok{])) }\SpecialCharTok{/} \FunctionTok{nrow}\NormalTok{(nulls)}
\NormalTok{p\_value}

\CommentTok{\# P{-}value of correlation coefficient}
\NormalTok{p\_value }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(}\FunctionTok{which}\NormalTok{(nulls}\SpecialCharTok{$}\NormalTok{r }\SpecialCharTok{\textgreater{}=}\NormalTok{ obs[}\DecValTok{2}\NormalTok{])) }\SpecialCharTok{/} \FunctionTok{nrow}\NormalTok{(nulls)}
\NormalTok{p\_value}

\CommentTok{\# How to interpret this correlation coefficient? }
\CommentTok{\# Could it be said that the correlation is unexpectedly POOR? }
\CommentTok{\# As in, the correlation coefficient is worse than \textgreater{} 95\% of outcomes expected under the null distribution? }
\CommentTok{\# In other words, whales of closer relatedness AVOID each other? At least a hypothesis...}
\end{Highlighting}
\end{Shaded}

\hypertarget{other-resources-10}{%
\section*{Other Resources}\label{other-resources-10}}
\addcontentsline{toc}{section}{Other Resources}

\emph{NOTE: Under construction!}

\hypertarget{iterative-simulations}{%
\chapter{Iterative simulations}\label{iterative-simulations}}

\hypertarget{image-analysis}{%
\chapter{Image analysis}\label{image-analysis}}

\hypertarget{machine-learning}{%
\chapter{Machine learning}\label{machine-learning}}

\hypertarget{template}{%
\chapter{Template}\label{template}}

\hypertarget{learning-goals-17}{%
\section*{Learning goals}\label{learning-goals-17}}
\addcontentsline{toc}{section}{Learning goals}

\begin{itemize}
\tightlist
\item
  Item 1\\
\item
  Item 2\\
\item
  Item 3
\end{itemize}

Instructor tip!Here is some teacher content.

\hypertarget{tutorial-video-1}{%
\section*{Tutorial video}\label{tutorial-video-1}}
\addcontentsline{toc}{section}{Tutorial video}

Bangarang - Crew Briefing from Luke Padgett on Vimeo.

\hypertarget{basics-2}{%
\section*{Basics}\label{basics-2}}
\addcontentsline{toc}{section}{Basics}

\hypertarget{exercise-1-7}{%
\subsection*{Exercise 1}\label{exercise-1-7}}
\addcontentsline{toc}{subsection}{Exercise 1}

\hypertarget{review-assignment-12}{%
\section*{Review assignment}\label{review-assignment-12}}
\addcontentsline{toc}{section}{Review assignment}

Introduce data

Introduce task(s)

\hypertarget{other-resources-11}{%
\section*{Other Resources}\label{other-resources-11}}
\addcontentsline{toc}{section}{Other Resources}

\url{https://desiree.rbind.io/post/2020/learnr-iframes/}

\url{https://rstudio.github.io/learnr/}

  \bibliography{book.bib,packages.bib}

\end{document}
