# Working with text {#text}

#### Learning goals {-}

* Learn to apply the most common `R` tools for working with text.


## Basics {-}

```{r,echo=TRUE,collapse=TRUE, eval = FALSE}
library(gsheet)
survey <- gsheet2tbl('https://docs.google.com/spreadsheets/d/1iVt9FX9J2iv3QFKBM7Gzb9dgva70XrW1lxMV4hpekeo/edit?resourcekey#gid=204634767')
names(survey) <- c('time', 'sex', 'age','sib', 'dad_mus', 'person_mus', 'joe_mus_is', 'eyesight', 'height', 'shoe_size', 'bday', 'money_or_love', 'rps_skill', 'num_pan', 'cats_dogs', 'first_name', 'last_name')

```

#### paste0 {-}

```{r,echo=TRUE,collapse=TRUE, eval = FALSE}

# combine first name and last name 
paste0(survey$first_name,' ', survey$last_name)
paste0(survey$first_name, ' ', survey$sex)

# Make a sentence
paste0('First name is ', survey$first_name,' and last name is  ', survey$last_name)

# combine first and last name to make new variable called full_name
survey <- survey %>% mutate(full_name = paste0(survey$first_name, '_', survey$last_name ))


```

#### tolower & toupper {-}

```{r,echo=TRUE,collapse=TRUE, eval = FALSE}

# combine first name and last name 
tolower(survey$money_or_love)
toupper(survey$money_or_love)

# overwrite money_or_love
survey <- survey %>% mutate(money_or_love = tolower(money_or_love))

```

#### nchar {-}

```{r,echo=TRUE,collapse=TRUE, eval = FALSE}
# count how many characters are in each observations in sex
nchar(survey$eyesight)

# create a boolean vector of the number of observations with 32 characters
nchar(survey$eyesight) ==42

# get number of observations with character 42
length(which(nchar(survey$eyesight) ==42))
sum(nchar(survey$eyesight) == 42)

```

##### substr {-}

```{r,echo=TRUE,collapse=TRUE, eval = FALSE}
# grab only the first letter fo sex
substr(survey$sex, start = 1, stop = 1)

# remove the "s" from cats and dogs
substr(survey$cats_dogs, start = 1, stop = 3)
```

#### gsub {-}

```{r,echo=TRUE,collapse=TRUE, eval = FALSE}

# replace "Deeply captivating" with "captivating
gsub('Deeply captivating', 'captivating', survey$joe_mus_is)

# remove long strings
gsub('(glasses or contacts, but I can get by without them)','', survey$eyesight, fixed = TRUE)

# overwrite variable
survey <- survey %>% mutate(eyesight = gsub('(glasses or contacts, but I can get by without them)','', eyesight, fixed = TRUE))

```

#### grepl {-}

```{r,echo=TRUE,collapse=TRUE, eval = FALSE}
# how many times does Brew show up in full_name
grepl('Brew', survey$full_name)

# Born in may
grepl('05', survey$bday)

# Born in 2000
grepl('2000', survey$bday)

# filter data by those born in 2000
survey %>% filter(grepl('2000', bday))

```


#### Exercise {-} 

1) Create a new variable called first_name_sex that combines the first name and the sex of each individual

2) Create a new variable called backwards_name that combines last name and first name 

3) Make the backwards_name variable capitalized

4) Replace "both" in the money_or_love variable with "Money & Love"

5) Get only the first character dad_mus variable 

6) How many total characters are in the column eyesight

7) How many characters did Joe write for the eyesight question

8) How many people in the data were born on the 4th day of the month

9) Create a new variables called month_born that has only the month of from the bday variable 

10) Do the same thing for year 

11) Filter the data set by those born and 2001 and prefer being money


## Large exercise 
```{r,echo=TRUE,collapse=TRUE, eval = FALSE}

library(dplyr)
library(readr)
shake <- read_csv('https://raw.githubusercontent.com/databrew/intro-to-data-science/main/data/Shakespeare_data.csv')

```

All good? Great. Let's go.

1. How may rows in the data?

2. Create a dataframe named `spoken`. This should be those lines which are spoken by an actor/actress (figure it out).

3. How many lines are spoken?

4. Create a column called `first_word`. This should be the first word of each spoken line.

5. What is the most common first word spoken?

6. Create a boolean column named "King". This should indicate whether or not the word "King" was spoken in any given line.

7. Improve the above by making sure that it includes both lower and uppercase variations of "king".

8. Figure out which play has the word "king" mentioned most?

9. What percentage of lines in Hamlet mention the word "king?

10. How many times does the word "woman" appear in each play?

11. How many words are there in all Shakespeare plays?

12. How many letters are there in each Shakespeare play?

13. Which character says the most words?

14. Which character says the least words?

15. What is the lines(s) of the character who says the least words?

16. Make a table of plays with one row per play and variables being: (a) number of lines, (b) number of words, (c) number of characters, (d) number of letters, (e) number of mentions of "Brew".
